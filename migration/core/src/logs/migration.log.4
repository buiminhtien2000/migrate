2024-12-27 17:55:27,184 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 17:55:27,187 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 17:55:27,189 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 17:55:27,191 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 17:55:27,193 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 17:55:33,010 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 17:55:33,016 - [WARNING] - bitrix_migration.py:BitrixMigration.run:310 - Starting migration in DEBUG MODE
2024-12-27 17:55:33,018 - [INFO] - bitrix_migration.py:BitrixMigration.run:323 - Starting deal migration...
2024-12-27 17:55:33,025 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 17:55:33,028 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:146 - Fetching records with current page 1
2024-12-27 17:55:33,031 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:192 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 17:55:33,033 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 17:55:33,039 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 17:55:33,041 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 17:55:47,525 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:245 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 17:55:47,528 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 17:55:47,534 - [DEBUG] - deal_processor.py:DealProcessor.process_items:65 - Process records using Bitrix batch API with batch import
2024-12-27 17:55:48,500 - [DEBUG] - deal_processor.py:DealProcessor.process_items:75 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 17:55:48,573 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295505464': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=92926e6700747fcb004064a00000011a4038071e9e2ea964fecebf955128e38d5e25b1&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}}
2024-12-27 17:55:49,345 - [DEBUG] - downloader.py:Downloader.download_url_batch:268 - Batch download completed. Success: 1/1
2024-12-27 17:55:49,352 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 17:55:49,356 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-27 17:55:50,323 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 17:55:55,412 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 17:58:50,159 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17883,
   "total_processed": 500,
   "estimated_time": "15h 38m 3s",
   "current_page": {
      "page": 1,
      "duration": "182.62s",
      "items_per_second": "2.74",
      "processed": 500,
      "failed": 500,
      "error_rate": "100.00%"
   }
}
2024-12-27 17:58:50,162 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 17:58:50,426 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17883,
  "processed_count": 0,
  "failed_count": 500,
  "success_rate": 0.0,
  "processing_time": "0:03:02.026184",
  "average_speed": 0.0,
  "remaining_items": 17883,
  "estimated_time": "0s",
  "status": "completed"
}
2024-12-27 17:58:50,431 - [INFO] - bitrix_migration.py:BitrixMigration.run:328 - Completed deal migration
2024-12-27 17:58:50,434 - [INFO] - bitrix_migration.py:BitrixMigration.run:333 - Starting comment migration...
2024-12-27 17:58:50,438 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 17:58:50,441 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 17:58:50,444 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 17:58:50,449 - [WARNING] - base_processor.py:CommentProcessor._get_and_validate_items:556 - No valid items found for CommentProcessor
2024-12-27 17:58:50,453 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {}
2024-12-27 17:58:50,457 - [INFO] - bitrix_migration.py:BitrixMigration.run:338 - Completed comment migration
2024-12-27 17:58:50,460 - [INFO] - bitrix_migration.py:BitrixMigration.run:333 - Starting task migration...
2024-12-27 17:58:50,467 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 17:58:50,470 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 17:58:50,473 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 17:58:50,477 - [WARNING] - base_processor.py:TaskProcessor._get_and_validate_items:556 - No valid items found for TaskProcessor
2024-12-27 17:58:50,481 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {}
2024-12-27 17:58:50,485 - [INFO] - bitrix_migration.py:BitrixMigration.run:338 - Completed task migration
2024-12-27 17:58:50,488 - [WARNING] - bitrix_migration.py:BitrixMigration.run:344 - DEBUG MODE migration completed in 0:03:17.469582
2024-12-27 17:58:50,491 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:363 - Bitrix migration cleanup completed
2024-12-27 18:00:26,617 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 18:00:27,767 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 18:00:27,984 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 18:00:29,560 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:00:29,605 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:00:29,614 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:00:29,617 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:00:29,621 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:00:30,991 - [INFO] - bitrix_migration.py:BitrixMigration.__init__:115 - {'lead': {'ID': 'ID', 'TITLE': 'TITLE', 'HONORIFIC': 'HONORIFIC', 'NAME': 'NAME', 'SECOND_NAME': 'SECOND_NAME', 'LAST_NAME': 'LAST_NAME', 'BIRTHDATE': 'BIRTHDATE', 'COMPANY_TITLE': 'COMPANY_TITLE', 'SOURCE_ID': 'SOURCE_ID', 'SOURCE_DESCRIPTION': 'SOURCE_DESCRIPTION', 'STATUS_ID': 'STATUS_ID', 'STATUS_DESCRIPTION': 'STATUS_DESCRIPTION', 'STATUS_SEMANTIC_ID': 'STATUS_SEMANTIC_ID', 'POST': 'POST', 'ADDRESS': 'ADDRESS', 'ADDRESS_2': 'ADDRESS_2', 'ADDRESS_CITY': 'ADDRESS_CITY', 'ADDRESS_POSTAL_CODE': 'ADDRESS_POSTAL_CODE', 'ADDRESS_REGION': 'ADDRESS_REGION', 'ADDRESS_PROVINCE': 'ADDRESS_PROVINCE', 'ADDRESS_COUNTRY': 'ADDRESS_COUNTRY', 'ADDRESS_COUNTRY_CODE': 'ADDRESS_COUNTRY_CODE', 'ADDRESS_LOC_ADDR_ID': 'ADDRESS_LOC_ADDR_ID', 'CURRENCY_ID': 'CURRENCY_ID', 'OPPORTUNITY': 'OPPORTUNITY', 'IS_MANUAL_OPPORTUNITY': 'IS_MANUAL_OPPORTUNITY', 'OPENED': 'OPENED', 'COMMENTS': 'COMMENTS', 'HAS_PHONE': 'HAS_PHONE', 'HAS_EMAIL': 'HAS_EMAIL', 'HAS_IMOL': 'HAS_IMOL', 'ASSIGNED_BY_ID': 'ASSIGNED_BY_ID', 'CREATED_BY_ID': 'CREATED_BY_ID', 'MODIFY_BY_ID': 'MODIFY_BY_ID', 'MOVED_BY_ID': 'MOVED_BY_ID', 'COMPANY_ID': 'COMPANY_ID', 'CONTACT_ID': 'CONTACT_ID', 'CONTACT_IDS': 'CONTACT_IDS', 'IS_RETURN_CUSTOMER': 'IS_RETURN_CUSTOMER', 'DATE_CLOSED': 'DATE_CLOSED', 'ORIGINATOR_ID': 'ORIGINATOR_ID', 'ORIGIN_ID': 'ORIGIN_ID', 'UTM_SOURCE': 'UTM_SOURCE', 'UTM_MEDIUM': 'UTM_MEDIUM', 'UTM_CAMPAIGN': 'UTM_CAMPAIGN', 'UTM_CONTENT': 'UTM_CONTENT', 'UTM_TERM': 'UTM_TERM', 'PARENT_ID_130': 'nan', 'PARENT_ID_148': 'nan', 'LAST_ACTIVITY_TIME': 'LAST_ACTIVITY_TIME', 'LAST_ACTIVITY_BY': 'LAST_ACTIVITY_BY', 'PHONE': 'PHONE', 'EMAIL': 'EMAIL', 'WEB': 'WEB', 'IM': 'IM', 'LINK': 'LINK', 'UF_CRM_1571135121': 'nan', 'UF_CRM_EQ_DISTRICT': 'nan', 'UF_CRM_1574066960181': 'nan', 'UF_CRM_1574914784': 'nan', 'UF_CRM_1576231926': 'nan', 'UF_CRM_1577688081': 'nan', 'UF_CRM_1585908093': 'nan', 'UF_CRM_1586168629': 'nan', 'UF_CRM_1628151696188': 'nan', 'UF_CRM_EQ_ROBOCALL': 'nan', 'UF_CRM_EQ_ZNS': 'nan', 'UF_CRM_EQ_LOCATION': 'nan', 'UF_CRM_EQ_COUNTRY': 'ADDRESS_COUNTRY', 'UF_CRM_EQ_PROVINCE': 'nan', 'UF_CRM_EQ_WARD': 'nan', 'UF_CRM_GG_SHEET_ROW': 'nan', 'UF_CRM_GG_SHEET_ID': 'nan', 'UF_CRM_1665393680398': 'nan', 'UF_CRM_1665483064': 'nan', 'UF_CRM_6346E507409CC': 'nan', 'UF_CRM_LEAD_1667908654397': 'nan', 'UF_CRM_636A4ED98C15A': 'nan', 'UF_CRM_LEAD_1670037817980': 'nan', 'UF_CRM_1671005830436': 'nan', 'UF_CRM_1675652098': 'nan', 'UF_CRM_1679824036591': 'nan', 'UF_CRM_1680666907536': 'nan', 'UF_CRM_1680667435542': 'nan', 'UF_CRM_1681094156188': 'nan', 'UF_CRM_1681095549529': 'nan', 'UF_CRM_1681096114587': 'nan', 'UF_CRM_1681096175459': 'nan', 'UF_CRM_1681114605512': 'nan', 'UF_CRM_1681114626348': 'nan', 'UF_CRM_1681114643594': 'nan', 'UF_CRM_LEAD_1682328963365': 'nan', 'UF_CRM_1682404360025': 'nan', 'UF_CRM_1682405511982': 'nan', 'UF_CRM_1683953147457': 'nan', 'UF_CRM_GA_CID': 'nan', 'UF_CRM_1688374605771': 'nan', 'UF_CRM_1688639167': 'nan', 'UF_CRM_1690446618': 'nan', 'UF_CRM_659FBAB72D3A2': 'nan', 'UF_CRM_1705635532': 'nan', 'UF_CRM_1706330307174': 'nan', 'UF_CRM_1709793078363': 'nan', 'UF_CRM_A_W_GROUP_ID': 'nan', 'UF_CRM_A_T_GROUP_ID': 'nan', 'UF_CRM_1712980368404': 'nan', 'UF_CRM_1712980441': 'nan', 'UF_CRM_667F7CD736EE8': 'nan', 'UF_CRM_667F7CD75E617': 'nan', 'UF_CRM_1720665250': 'nan', 'UF_CRM_1720665866634': 'nan', 'UF_CRM_1720666177117': 'nan', 'UF_CRM_1724740782': 'nan', 'UF_CRM_1725611208587': 'nan', 'UF_CRM_1727757012': 'nan', 'UF_CRM_1730713194': 'nan', 'UF_CRM_1730713195': 'nan', 'UF_CRM_1731463333': 'nan', 'UF_CRM_1734611496655': 'nan'}, 'deal': {'ID': 'ID', 'TITLE': 'TITLE', 'TYPE_ID': 'TYPE_ID', 'CATEGORY_ID': 'CATEGORY_ID', 'STAGE_ID': 'STAGE_ID', 'STAGE_SEMANTIC_ID': 'STAGE_SEMANTIC_ID', 'IS_NEW': 'IS_NEW', 'IS_RECURRING': 'IS_RECURRING', 'IS_RETURN_CUSTOMER': 'IS_RETURN_CUSTOMER', 'IS_REPEATED_APPROACH': 'IS_REPEATED_APPROACH', 'PROBABILITY': 'PROBABILITY', 'CURRENCY_ID': 'CURRENCY_ID', 'OPPORTUNITY': 'OPPORTUNITY', 'IS_MANUAL_OPPORTUNITY': 'IS_MANUAL_OPPORTUNITY', 'TAX_VALUE': 'TAX_VALUE', 'COMPANY_ID': 'COMPANY_ID', 'CONTACT_ID': 'CONTACT_ID', 'CONTACT_IDS': 'CONTACT_IDS', 'QUOTE_ID': 'QUOTE_ID', 'BEGINDATE': 'BEGINDATE', 'CLOSEDATE': 'CLOSEDATE', 'OPENED': 'OPENED', 'CLOSED': 'CLOSED', 'COMMENTS': 'COMMENTS', 'ASSIGNED_BY_ID': 'ASSIGNED_BY_ID', 'CREATED_BY_ID': 'CREATED_BY_ID', 'MODIFY_BY_ID': 'MODIFY_BY_ID', 'MOVED_BY_ID': 'MOVED_BY_ID', 'DATE_CREATE': 'UF_CRM_1735295219597', 'DATE_MODIFY': 'UF_CRM_1735295235388', 'SOURCE_ID': 'SOURCE_ID', 'SOURCE_DESCRIPTION': 'SOURCE_DESCRIPTION', 'LEAD_ID': 'LEAD_ID', 'ADDITIONAL_INFO': 'ADDITIONAL_INFO', 'LOCATION_ID': 'LOCATION_ID', 'ORIGINATOR_ID': 'ORIGINATOR_ID', 'ORIGIN_ID': 'ORIGIN_ID', 'UTM_SOURCE': 'UTM_SOURCE', 'UTM_MEDIUM': 'UTM_MEDIUM', 'UTM_CAMPAIGN': 'UTM_CAMPAIGN', 'UTM_CONTENT': 'UTM_CONTENT', 'UTM_TERM': 'UTM_TERM', 'PARENT_ID_130': 'nan', 'PARENT_ID_131': 'nan', 'PARENT_ID_132': 'nan', 'PARENT_ID_133': 'nan', 'PARENT_ID_140': 'nan', 'PARENT_ID_142': 'nan', 'PARENT_ID_145': 'nan', 'PARENT_ID_147': 'nan', 'PARENT_ID_148': 'nan', 'PARENT_ID_149': 'nan', 'PARENT_ID_159': 'nan', 'PARENT_ID_169': 'nan', 'PARENT_ID_177': 'nan', 'PARENT_ID_183': 'nan', 'PARENT_ID_185': 'nan', 'PARENT_ID_188': 'nan', 'PARENT_ID_190': 'nan', 'PARENT_ID_191': 'nan', 'PARENT_ID_1068': 'nan', 'PARENT_ID_1084': 'nan', 'PARENT_ID_1104': 'nan', 'PARENT_ID_1112': 'nan', 'PARENT_ID_1120': 'nan', 'PARENT_ID_1126': 'nan', 'PARENT_ID_1130': 'nan', 'LAST_ACTIVITY_TIME': 'LAST_ACTIVITY_TIME', 'LAST_ACTIVITY_BY': 'LAST_ACTIVITY_BY', 'UF_CRM_6551DF6620BE5': 'nan', 'UF_CRM_6551DF6655067': 'nan', 'UF_CRM_6551DF666D52A': 'nan', 'UF_CRM_1628824504680': 'nan', 'UF_CRM_1628824537109': 'nan', 'UF_CRM_1628824824373': 'nan', 'UF_CRM_1628824985423': 'nan', 'UF_CRM_1628825413905': 'nan', 'UF_CRM_1628825425637': 'nan', 'UF_CRM_1629087442': 'nan', 'UF_CRM_EQ_LOCATION': 'nan', 'UF_CRM_EQ_COUNTRY': 'nan', 'UF_CRM_EQ_PROVINCE': 'nan', 'UF_CRM_EQ_DISTRICT': 'nan', 'UF_CRM_EQ_WARD': 'nan', 'UF_CRM_1631690082': 'nan', 'UF_CRM_1632884056': 'nan', 'UF_CRM_1632884092': 'nan', 'UF_CRM_1632884198': 'nan', 'UF_CRM_1632884226': 'nan', 'UF_CRM_1632885938': 'nan', 'UF_CRM_1632885971': 'nan', 'UF_CRM_6189F369501F9': 'nan', 'UF_CRM_61CD283C52990': 'nan', 'UF_CRM_61E8C26F9C613': 'nan', 'UF_CRM_1643344309': 'nan', 'UF_CRM_1647793827835': 'nan', 'UF_CRM_1647793858380': 'nan', 'UF_CRM_1647793917690': 'nan', 'UF_CRM_1647794083867': 'nan', 'UF_CRM_1647794138278': 'nan', 'UF_CRM_1647837617': 'nan', 'UF_CRM_1647853786887': 'nan', 'UF_CRM_1647853884239': 'nan', 'UF_CRM_1647919126232': 'nan', 'UF_CRM_1647919149075': 'nan', 'UF_CRM_1647919181359': 'nan', 'UF_CRM_1647919199545': 'nan', 'UF_CRM_1647919231454': 'nan', 'UF_CRM_1647920712690': 'nan', 'UF_CRM_1647922046753': 'nan', 'UF_CRM_1648801237': 'nan', 'UF_CRM_6282077ADBFC7': 'nan', 'UF_CRM_1653540416041': 'nan', 'UF_CRM_1653540718057': 'nan', 'UF_CRM_1653967364556': 'nan', 'UF_CRM_62AD50527CAE9': 'nan', 'UF_CRM_62AD5052B2CD8': 'nan', 'UF_CRM_1655891045159': 'nan', 'UF_CRM_63048E7DA64BF': 'nan', 'UF_CRM_1661332670309': 'nan', 'UF_CRM_63199AC606E74': 'nan', 'UF_CRM_63199AC6AC6F6': 'nan', 'UF_CRM_1662744611696': 'nan', 'UF_CRM_1662744691962': 'nan', 'UF_CRM_1662744742165': 'nan', 'UF_CRM_1663643803414': 'nan', 'UF_CRM_GG_SHEET_ROW': 'nan', 'UF_CRM_GG_SHEET_ID': 'nan', 'UF_CRM_1664623405': 'nan', 'UF_CRM_1666717851423': 'nan', 'UF_CRM_1666926189386': 'nan', 'UF_CRM_1666926839': 'nan', 'UF_CRM_1667812703': 'nan', 'UF_CRM_1669390196': 'nan', 'UF_CRM_1669390223': 'nan', 'UF_CRM_1669397881': 'nan', 'UF_CRM_1669399262': 'nan', 'UF_CRM_1669428168': 'nan', 'UF_CRM_1669860665384': 'nan', 'UF_CRM_63998752031B9': 'nan', 'UF_CRM_639987527E8E8': 'nan', 'UF_CRM_1675180607896': 'nan', 'UF_CRM_1675180644660': 'nan', 'UF_CRM_1675206536': 'nan', 'UF_CRM_1675206788': 'nan', 'UF_CRM_1675241481785': 'nan', 'UF_CRM_1675852606': 'nan', 'UF_CRM_1675904463878': 'nan', 'UF_CRM_1675927630676': 'nan', 'UF_CRM_1681117931965': 'nan', 'UF_CRM_1681118203960': 'nan', 'UF_CRM_1681118217706': 'nan', 'UF_CRM_1681118447887': 'nan', 'UF_CRM_1681118572230': 'nan', 'UF_CRM_1681181839285': 'nan', 'UF_CRM_1681182074': 'nan', 'UF_CRM_1681183083': 'nan', 'UF_CRM_1681183111': 'nan', 'UF_CRM_1681184064': 'nan', 'UF_CRM_1681185362': 'nan', 'UF_CRM_1681808809432': 'nan', 'UF_CRM_1681809251411': 'nan', 'UF_CRM_64409BE8D2B32': 'nan', 'UF_CRM_64409BE90DCD0': 'nan', 'UF_CRM_1682042654564': 'nan', 'UF_CRM_1682042666278': 'nan', 'UF_CRM_1682408803805': 'nan', 'UF_CRM_1682408835357': 'nan', 'UF_CRM_1682408854386': 'nan', 'UF_CRM_1682408871985': 'nan', 'UF_CRM_DEAL_1682409847129': 'nan', 'UF_CRM_DEAL_1682409894512': 'nan', 'UF_CRM_1683510554966': 'nan', 'UF_CRM_1683884055811': 'nan', 'UF_CRM_1683886553460': 'nan', 'UF_CRM_SI_BILLING_ADDRESS': 'nan', 'UF_CRM_SI_SHIPPING_ADDRESS': 'nan', 'UF_CRM_1686105856': 'nan', 'UF_CRM_1686107252': 'nan', 'UF_CRM_SI_BRANCH_NAME': 'nan', 'UF_CRM_SI_FACEBOOK_ID': 'nan', 'UF_CRM_1686558487742': 'nan', 'UF_CRM_1686643184': 'nan', 'UF_CRM_NETSUITE_LOCATION': 'nan', 'UF_CRM_NETSUITE_ASM': 'nan', 'UF_CRM_NETSUITE_ASM_ID': 'nan', 'UF_CRM_NETSUITE_TRACKING_URL': 'nan', 'UF_CRM_NETSUITE_ORDER_TYPE': 'nan', 'UF_CRM_GA_CID': 'nan', 'UF_CRM_SI_LINKED_ITEM': 'nan', 'UF_CRM_1687339983': 'nan', 'UF_CRM_1687573520': 'nan', 'UF_CRM_1687575719814': 'nan', 'UF_CRM_1687575738913': 'nan', 'UF_CRM_1687577000221': 'nan', 'UF_CRM_1687577014143': 'nan', 'UF_CRM_1687577046': 'nan', 'UF_CRM_1687577476': 'nan', 'UF_CRM_SI_ORDER_STATUS': 'nan', 'UF_CRM_SI_DELIVERY_STATUS': 'nan', 'UF_CRM_SI_PAYMENT_METHOD': 'nan', 'UF_CRM_SI_PAYMENT_STATUS': 'nan', 'UF_CRM_1687838297': 'nan', 'UF_CRM_SI_EXTERNAL_ID': 'nan', 'UF_CRM_SI_SYSTEM': 'nan', 'UF_CRM_SI_SALE_CHANNEL': 'nan', 'UF_CRM_SI_TRANSACTIONS': 'nan', 'UF_CRM_SI_TAGS': 'nan', 'UF_CRM_SI_NOTE_ATTRIBUTES': 'nan', 'UF_CRM_SI_COD_STATUS': 'nan', 'UF_CRM_SI_TRACKING_URL': 'nan', 'UF_CRM_SI_SALESMAN': 'nan', 'UF_CRM_SI_DISCOUNT_CODES': 'nan', 'UF_CRM_SI_DELIVERY_CHARGE': 'nan', 'UF_CRM_SI_TOTAL_DISCOUNTS': 'nan', 'UF_CRM_OMICALL_TICKET_CATEGORY': 'nan', 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': 'nan', 'UF_CRM_HARAVAN_BILLING_ADDRESS': 'nan', 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': 'nan', 'UF_CRM_HARAVAN_TRANSACTIONS': 'nan', 'UF_CRM_HARAVAN_SHIPPING_LINES': 'nan', 'UF_CRM_HARAVAN_GATEWAY': 'nan', 'UF_CRM_HARAVAN_TAGS': 'nan', 'UF_CRM_HARAVAN_FINANCIAL_STATUS': 'nan', 'UF_CRM_HARAVAN_CARRIER_STATUS': 'nan', 'UF_CRM_HARAVAN_COD_STATUS': 'nan', 'UF_CRM_1690789528': 'nan', 'UF_CRM_1691633351': 'nan', 'UF_CRM_1691636227414': 'nan', 'UF_CRM_NETSUITE_ITEM_ID': 'nan', 'UF_CRM_NETSUITE_TRACKING_COMPANY': 'nan', 'UF_CRM_NETSUITE_TRACKING_NUMBER': 'nan', 'UF_CRM_NETSUITE_ORIGIN_SOURCE': 'nan', 'UF_CRM_64DD855874102': 'nan', 'UF_CRM_64DD8558967E5': 'nan', 'UF_CRM_64DD8558B08A4': 'nan', 'UF_CRM_64DD8558C9A21': 'nan', 'UF_CRM_64DD8558DE4B5': 'nan', 'UF_CRM_64DD855903254': 'nan', 'UF_CRM_64DD855924C00': 'nan', 'UF_CRM_64DD85593BF30': 'nan', 'UF_CRM_64DD85595349F': 'nan', 'UF_CRM_64DD85596AAF7': 'nan', 'UF_CRM_64DD85598406B': 'nan', 'UF_CRM_64DD855997B6A': 'nan', 'UF_CRM_64DD8559AEF54': 'nan', 'UF_CRM_64DD8559C5526': 'nan', 'UF_CRM_64DD8559DFAF8': 'nan', 'UF_CRM_64DD855A017AB': 'nan', 'UF_CRM_64DD855A17408': 'nan', 'UF_CRM_64DD855A2CF2D': 'nan', 'UF_CRM_64DD855A4729E': 'nan', 'UF_CRM_64DD855A6149F': 'nan', 'UF_CRM_64DD85620B765': 'nan', 'UF_CRM_1692610857883': 'nan', 'UF_CRM_1695864949163': 'nan', 'UF_CRM_1695865630924': 'nan', 'UF_CRM_1695876200980': 'nan', 'UF_CRM_1695960519572': 'nan', 'UF_CRM_1695962191656': 'nan', 'UF_CRM_65484D5C2FAC2': 'nan', 'UF_CRM_1701225385909': 'nan', 'UF_CRM_1701225454274': 'nan', 'UF_CRM_1701225477523': 'nan', 'UF_CRM_1701225501702': 'nan', 'UF_CRM_1702537249832': 'nan', 'UF_CRM_1702537301982': 'nan', 'UF_CRM_1703235964293': 'nan', 'UF_CRM_1703572656156': 'nan', 'UF_CRM_1704251654055': 'nan', 'UF_CRM_1704966626109': 'nan', 'UF_CRM_1708509943566': 'nan', 'UF_CRM_1708509957379': 'nan', 'UF_CRM_1708509975363': 'nan', 'UF_CRM_1708510304254': 'nan', 'UF_CRM_1709606590651': 'nan', 'UF_CRM_1709606602008': 'nan', 'UF_CRM_1709609619010': 'nan', 'UF_CRM_1709793176298': 'nan', 'UF_CRM_1709794098508': 'nan', 'UF_CRM_1709794180593': 'nan', 'UF_CRM_1709794222536': 'nan', 'UF_CRM_A_W_GROUP_ID': 'nan', 'UF_CRM_A_T_GROUP_ID': 'nan', 'UF_CRM_1711725508067': 'nan', 'UF_CRM_1713344426208': 'nan', 'UF_CRM_1713685581659': 'nan', 'UF_CRM_1713685624988': 'nan', 'UF_CRM_1715910311538': 'nan', 'UF_CRM_1715910596192': 'nan', 'UF_CRM_1717125961307': 'nan', 'UF_CRM_1717316965821': 'nan', 'UF_CRM_1719648301139': 'nan', 'UF_CRM_1720078374797': 'nan', 'UF_CRM_1720626779457': 'nan', 'UF_CRM_1720632056653': 'nan', 'UF_CRM_1720632074684': 'nan', 'UF_CRM_1720632123': 'nan', 'UF_CRM_1720656433827': 'nan', 'UF_CRM_1720666355100': 'nan', 'UF_CRM_1720666423733': 'nan', 'UF_CRM_1720666627130': 'nan', 'UF_CRM_668F4B3D3C6B6': 'nan', 'UF_CRM_668F4B3D5D0B7': 'nan', 'UF_CRM_668F4B3D7CC30': 'nan', 'UF_CRM_668F4B3D98791': 'nan', 'UF_CRM_668F4B3DB41BF': 'nan', 'UF_CRM_668F4B3DD5532': 'nan', 'UF_CRM_668F4B3EAE11F': 'nan', 'UF_CRM_668F4B3EEDE73': 'nan', 'UF_CRM_668F4B3F139B8': 'nan', 'UF_CRM_1721800235243': 'nan', 'UF_CRM_1721800266643': 'nan', 'UF_CRM_1721800746986': 'nan', 'UF_CRM_1721806669463': 'nan', 'UF_CRM_1721806730279': 'nan', 'UF_CRM_1721874947645': 'nan', 'UF_CRM_1722327555404': 'nan', 'UF_CRM_1722328083': 'nan', 'UF_CRM_1722328119': 'nan', 'UF_CRM_1722328334933': 'nan', 'UF_CRM_1722328518516': 'nan', 'UF_CRM_1722328777121': 'nan', 'UF_CRM_1722330900842': 'nan', 'UF_CRM_1722399546': 'nan', 'UF_CRM_1722518727': 'nan', 'UF_CRM_1722521515648': 'nan', 'UF_CRM_1722521548960': 'nan', 'UF_CRM_1722521586630': 'nan', 'UF_CRM_1722521713145': 'nan', 'UF_CRM_1722521757393': 'nan', 'UF_CRM_1722560851536': 'nan', 'UF_CRM_1722560871750': 'nan', 'UF_CRM_1722563550': 'nan', 'UF_CRM_1722571302165': 'nan', 'UF_CRM_1722646463263': 'nan', 'UF_CRM_1722660322': 'nan', 'UF_CRM_1724689007': 'nan', 'UF_CRM_1724689010': 'nan', 'UF_CRM_REGION': 'nan', 'UF_CRM_SUB_REGION': 'nan', 'UF_CRM_COUNTRY': 'nan', 'UF_CRM_CITY': 'nan', 'UF_CRM_66FB7B35B2068': 'nan', 'UF_CRM_66FB7B36F09DE': 'nan', 'UF_CRM_66FB7B37C82BF': 'nan', 'UF_CRM_1728871639': 'nan', 'UF_CRM_1730965350': 'nan', 'UF_CRM_1730965638260': 'nan', 'UF_CRM_1731986726194': 'nan', 'UF_CRM_1733907796620': 'nan', 'UF_CRM_1734408996684': 'nan', 'UF_CRM_1735295105441': 'UF_CRM_1735295505464', 'UF_CRM_1635406129894': 'nan', 'UF_CRM_1635406141542': 'nan', 'UF_CRM_1635406148202': 'nan', 'UF_CRM_1635406160286': 'nan', 'UF_CRM_1635406167496': 'nan', 'UF_CRM_1635406174608': 'nan', 'UF_CRM_1635406181409': 'nan', 'UF_CRM_1635406069316': 'nan', 'UF_CRM_1635406194512': 'nan', 'UF_CRM_62F4730B42764': 'nan', 'UF_CRM_1683778250611': 'nan', 'UF_CRM_1684296872513': 'nan', 'UF_CRM_1684297005099': 'nan', 'UF_CRM_FULL_ADDRESS': 'nan', 'UF_CRM_COMPANY_TITLE': 'nan', 'UF_CRM_ADDRESS_COUNTRY': 'nan', 'UF_CRM_BIRTHDATE': 'nan', 'UF_CRM_ADDRESS_REGION': 'nan', 'UF_CRM_WEB_FACEBOOK': 'nan', 'UF_CRM_IM_FACEBOOK': 'nan', 'UF_CRM_LINK_USER': 'nan', 'UF_CRM_PHONE_MOBILE': 'nan', 'UF_CRM_EMAIL_MAILING': 'nan', 'UF_CRM_IM_OTHER': 'nan', 'UF_CRM_EMAIL_OTHER': 'nan', 'UF_CRM_PHONE_OTHER': 'nan', 'UF_CRM_WEB_OTHER': 'nan', 'UF_CRM_PHONE_PAGER': 'nan', 'UF_CRM_WEB_HOME': 'nan', 'UF_CRM_POST': 'nan', 'UF_CRM_ADDRESS_PROVINCE': 'nan', 'UF_CRM_PHONE_MAILING': 'nan', 'UF_CRM_HONORIFIC': 'nan', 'UF_CRM_IM_SKYPE': 'nan', 'UF_CRM_STATUS_DESCRIPTION': 'nan', 'UF_CRM_ADDRESS': 'nan', 'UF_CRM_IM_TELEGRAM': 'nan', 'UF_CRM_WEB_TWITTER': 'nan', 'UF_CRM_WEB_VK': 'nan', 'UF_CRM_IM_VK': 'nan', 'UF_CRM_IM_VIBER': 'nan', 'UF_CRM_EMAIL_WORK': 'nan', 'UF_CRM_PHONE_WORK': 'nan', 'UF_CRM_ADDRESS_POSTAL_CODE': 'nan', 'UF_CRM_STATUS_ID': 'nan', 'UF_CRM_LEAD_1682328963365': 'nan', 'UF_CRM_1681096114587': 'nan', 'UF_CRM_1681114643594': 'nan', 'UF_CRM_LEAD_1670037817980': 'nan', 'UF_CRM_1671005830436': 'UF_CRM_1735295505464', 'UF_CRM_6346E507409CC': 'nan', 'UF_CRM_1681114626348': 'nan', 'UF_CRM_1628151696188': 'nan', 'UF_CRM_1681095549529': 'nan', 'UF_CRM_1574066960181': 'nan', 'UF_CRM_EXTERNAL_ID': 'nan', 'UF_CRM_64409BE7B07B0': 'nan', 'UF_CRM_ORDER_ID': 'nan', 'UF_CRM_ORIGIN_ID': 'nan'}, 'contact': {'ID': 'ID', 'HONORIFIC': 'HONORIFIC', 'NAME': 'NAME', 'SECOND_NAME': 'SECOND_NAME', 'LAST_NAME': 'LAST_NAME', 'PHOTO': 'PHOTO', 'BIRTHDATE': 'BIRTHDATE', 'TYPE_ID': 'TYPE_ID', 'SOURCE_ID': 'SOURCE_ID', 'SOURCE_DESCRIPTION': 'SOURCE_DESCRIPTION', 'POST': 'POST', 'ADDRESS': 'ADDRESS', 'ADDRESS_2': 'ADDRESS_2', 'ADDRESS_CITY': 'ADDRESS_CITY', 'ADDRESS_POSTAL_CODE': 'ADDRESS_POSTAL_CODE', 'ADDRESS_REGION': 'ADDRESS_REGION', 'ADDRESS_PROVINCE': 'ADDRESS_PROVINCE', 'ADDRESS_COUNTRY': 'ADDRESS_COUNTRY', 'ADDRESS_COUNTRY_CODE': 'ADDRESS_COUNTRY_CODE', 'ADDRESS_LOC_ADDR_ID': 'ADDRESS_LOC_ADDR_ID', 'COMMENTS': 'COMMENTS', 'OPENED': 'OPENED', 'EXPORT': 'EXPORT', 'HAS_PHONE': 'HAS_PHONE', 'HAS_EMAIL': 'HAS_EMAIL', 'HAS_IMOL': 'HAS_IMOL', 'ASSIGNED_BY_ID': 'ASSIGNED_BY_ID', 'CREATED_BY_ID': 'CREATED_BY_ID', 'MODIFY_BY_ID': 'MODIFY_BY_ID', 'COMPANY_ID': 'COMPANY_ID', 'COMPANY_IDS': 'COMPANY_IDS', 'LEAD_ID': 'LEAD_ID', 'ORIGINATOR_ID': 'ORIGINATOR_ID', 'ORIGIN_ID': 'ORIGIN_ID', 'ORIGIN_VERSION': 'ORIGIN_VERSION', 'FACE_ID': 'FACE_ID', 'UTM_SOURCE': 'UTM_SOURCE', 'UTM_MEDIUM': 'UTM_MEDIUM', 'UTM_CAMPAIGN': 'UTM_CAMPAIGN', 'UTM_CONTENT': 'UTM_CONTENT', 'UTM_TERM': 'UTM_TERM', 'PARENT_ID_130': 'nan', 'PARENT_ID_131': 'nan', 'PARENT_ID_132': 'nan', 'PARENT_ID_133': 'nan', 'PARENT_ID_134': 'nan', 'PARENT_ID_138': 'nan', 'PARENT_ID_142': 'nan', 'PARENT_ID_143': 'nan', 'PARENT_ID_159': 'nan', 'PARENT_ID_161': 'nan', 'PARENT_ID_166': 'nan', 'PARENT_ID_177': 'nan', 'PARENT_ID_1146': 'nan', 'LAST_ACTIVITY_TIME': 'LAST_ACTIVITY_TIME', 'LAST_ACTIVITY_BY': 'LAST_ACTIVITY_BY', 'PHONE': 'PHONE', 'EMAIL': 'EMAIL', 'WEB': 'WEB', 'IM': 'IM', 'LINK': 'LINK', 'UF_CRM_1681116156': 'nan', 'UF_CRM_5D9A204D40852': 'nan', 'UF_CRM_5DA035186103D': 'nan', 'UF_CRM_5DA5948FD4B3A': 'nan', 'UF_CRM_5DA5A35A77B53': 'nan', 'UF_CRM_5DD3D8200724B': 'nan', 'UF_CRM_1574843647': 'nan', 'UF_CRM_5DEF022EC67AA': 'nan', 'UF_CRM_5DFB8723BEBBC': 'nan', 'UF_CRM_5E0C0F3724153': 'nan', 'UF_CRM_1585107016': 'nan', 'UF_CRM_1586405505': 'nan', 'UF_CRM_1586406052': 'nan', 'UF_CRM_5E90497167970': 'nan', 'UF_CRM_5E9049717ADCF': 'nan', 'UF_CRM_1588759311': 'nan', 'UF_CRM_1589862016612': 'nan', 'UF_CRM_5EC637DF02158': 'nan', 'UF_CRM_5F4764DF2F4A6': 'nan', 'UF_CRM_5F7EE15877CD8': 'nan', 'UF_CRM_5FE5AF0D79567': 'nan', 'UF_CRM_60C02CA51A3D6': 'nan', 'UF_CRM_60EBD22B7A71C': 'nan', 'UF_CRM_1627532342': 'nan', 'UF_CRM_EQ_ROBOCALL': 'nan', 'UF_CRM_EQ_ZNS': 'nan', 'UF_CRM_EQ_LOCATION': 'nan', 'UF_CRM_EQ_COUNTRY': 'ADDRESS_COUNTRY', 'UF_CRM_EQ_PROVINCE': 'nan', 'UF_CRM_EQ_DISTRICT': 'nan', 'UF_CRM_EQ_WARD': 'nan', 'UF_CRM_1631703119': 'nan', 'UF_CRM_61A703AE30FCB': 'nan', 'UF_CRM_61A703AE5331F': 'nan', 'UF_CRM_61A703AE61942': 'nan', 'UF_CRM_61A703AE70242': 'nan', 'UF_CRM_61A703AE86B9F': 'nan', 'UF_CRM_61A703AE947AF': 'nan', 'UF_CRM_61CD283BCCE15': 'nan', 'UF_CRM_61CD283C303E4': 'nan', 'UF_CRM_MA_SO_DAI_LY': 'nan', 'UF_CRM_6220B6117D611': 'nan', 'UF_CRM_6220B6136B95E': 'nan', 'UF_CRM_1647061654382': 'nan', 'UF_CRM_1647062017': 'nan', 'UF_CRM_1648711625395': 'nan', 'UF_CRM_1648715651383': 'nan', 'UF_CRM_6282077ABA1F9': 'nan', 'UF_CRM_1657705131238': 'nan', 'UF_CRM_1659675454': 'nan', 'UF_CRM_63199AC47C26C': 'nan', 'UF_CRM_63199AC4C9747': 'nan', 'UF_CRM_63199AC5B229E': 'nan', 'UF_CRM_1663644152714': 'nan', 'UF_CRM_GG_SHEET_ROW': 'nan', 'UF_CRM_GG_SHEET_ID': 'nan', 'UF_CRM_1664351808048': 'nan', 'UF_CRM_1666251157409': 'nan', 'UF_CRM_1667621627': 'nan', 'UF_CRM_CONTACT_1667908771655': 'nan', 'UF_CRM_CONTACT_1667908946919': 'nan', 'UF_CRM_CONTACT_1669214873041': 'nan', 'UF_CRM_1669397825': 'nan', 'UF_CRM_1669862895233': 'nan', 'UF_CRM_1676533852500': 'nan', 'UF_CRM_1679106458': 'nan', 'UF_CRM_1680161056665': 'nan', 'UF_CRM_1681115678474': 'nan', 'UF_CRM_1681115708329': 'nan', 'UF_CRM_1681115946476': 'nan', 'UF_CRM_1681115955876': 'nan', 'UF_CRM_1681115969310': 'nan', 'UF_CRM_1681115984122': 'nan', 'UF_CRM_1681115992083': 'nan', 'UF_CRM_1681116625494': 'nan', 'UF_CRM_1681117372410': 'nan', 'UF_CRM_64409BE3BDDBE': 'nan', 'UF_CRM_64409BE43315B': 'nan', 'UF_CRM_64409BE46E224': 'nan', 'UF_CRM_64409BE49F649': 'nan', 'UF_CRM_64409BE4D9251': 'nan', 'UF_CRM_64409BE529E24': 'nan', 'UF_CRM_64409BE566697': 'nan', 'UF_CRM_64409BE59B3F6': 'nan', 'UF_CRM_64409BE5C5783': 'nan', 'UF_CRM_64409BE602C6E': 'nan', 'UF_CRM_64409BE62DE19': 'nan', 'UF_CRM_64409BE659CFD': 'nan', 'UF_CRM_64409BE686413': 'nan', 'UF_CRM_64409BE6B3E93': 'nan', 'UF_CRM_64409BE6D7445': 'nan', 'UF_CRM_64409BE7086FA': 'nan', 'UF_CRM_64409BE731278': 'nan', 'UF_CRM_CONTACT_1682329044479': 'nan', 'UF_CRM_CONTACT_1682329127769': 'nan', 'UF_CRM_6454CE43F02AB': 'nan', 'UF_CRM_6454CE4451D92': 'nan', 'UF_CRM_1683881122696': 'nan', 'UF_CRM_1683886595912': 'nan', 'UF_CRM_1684314583972': 'nan', 'UF_CRM_1685667984579': 'nan', 'UF_CRM_1686276946428': 'nan', 'UF_CRM_1686277013415': 'nan', 'UF_CRM_1686277033582': 'nan', 'UF_CRM_CONTACT_1686648880702': 'nan', 'UF_CRM_CONTACT_1686649356215': 'nan', 'UF_CRM_CONTACT_1686649485770': 'nan', 'UF_CRM_6495419BA4C39': 'nan', 'UF_CRM_6495419BDAA45': 'nan', 'UF_CRM_64A51CAE47CAA': 'nan', 'UF_CRM_SI_SALE_CHANNEL': 'nan', 'UF_CRM_HARAVAN_ID': 'nan', 'UF_CRM_KIOTVIET_ID': 'nan', 'UF_CRM_NETSUITE_ID': 'nan', 'UF_CRM_SAPO_ID': 'nan', 'UF_CRM_1689909548856': 'nan', 'UF_CRM_OMICALL_ID': 'nan', 'UF_CRM_1691636719137': 'nan', 'UF_CRM_DMS_ID': 'nan', 'UF_CRM_64DD855B4489A': 'nan', 'UF_CRM_1704790228763': 'nan', 'UF_CRM_1705569407574': 'nan', 'UF_CRM_1709777847562': 'nan', 'UF_CRM_1709795300586': 'nan', 'UF_CRM_1709795312687': 'nan', 'UF_CRM_1715841682089': 'nan', 'UF_CRM_66A0A5603CD2A': 'nan', 'UF_CRM_66A0A5605DB7B': 'nan', 'UF_CRM_66A0A560742E6': 'nan', 'UF_CRM_66A0A5608CBB8': 'nan', 'UF_CRM_66A0A560A1C0D': 'nan', 'UF_CRM_66A0A560BD898': 'nan', 'UF_CRM_66A0A560D57B5': 'nan', 'UF_CRM_66A0A560EB56F': 'nan', 'UF_CRM_66A0A5610E950': 'nan', 'UF_CRM_66A0A56125693': 'nan', 'UF_CRM_66A0A5614A977': 'nan', 'UF_CRM_66A0A561679BE': 'nan', 'UF_CRM_1724836214': 'nan', 'UF_CRM_1724836334233': 'nan', 'UF_CRM_1724836366112': 'nan', 'UF_CRM_1724836427764': 'nan', 'UF_CRM_1724836462947': 'nan', 'UF_CRM_1724836485868': 'nan', 'UF_CRM_1724836509364': 'nan', 'UF_CRM_1724836687130': 'nan', 'UF_CRM_1724836771345': 'nan', 'UF_CRM_1724836795407': 'nan', 'UF_CRM_1724836814400': 'nan', 'UF_CRM_62F472F88EF2C': 'nan', 'UF_CRM_62F472F8B066F': 'nan', 'UF_CRM_62F472F8C3660': 'nan', 'UF_CRM_62F472F8D4B07': 'nan', 'UF_CRM_62F472F908951': 'nan', 'UF_CRM_62F472F9B4313': 'nan', 'UF_CRM_62F472F9C6ECD': 'nan', 'UF_CRM_62F472F9DA94B': 'nan', 'UF_CRM_62F472F9EE8F1': 'nan', 'UF_CRM_62F472FA35A41': 'nan', 'UF_CRM_62F472FA498E1': 'nan', 'UF_CRM_62F472FA721D5': 'nan', 'UF_CRM_62F472FA8A3DD': 'nan', 'UF_CRM_62F472FA9F759': 'nan', 'UF_CRM_62F472FAB3773': 'nan', 'UF_CRM_62F472FAC93D1': 'nan', 'UF_CRM_62F472FAE3F4D': 'nan', 'UF_CRM_62F472FB0785B': 'nan', 'UF_CRM_62F472FB1C4E3': 'nan', 'UF_CRM_62F472FB314AA': 'nan', 'UF_CRM_62F472FC0FEC9': 'nan', 'UF_CRM_62F472FC4E643': 'nan', 'UF_CRM_62F472FC693C2': 'nan', 'UF_CRM_62F472FC7D160': 'nan', 'UF_CRM_62F472FC9480A': 'nan', 'UF_CRM_62F472FCAA5FE': 'nan', 'UF_CRM_62F472FCC0C9B': 'nan', 'UF_CRM_62F472FCD58CE': 'nan', 'UF_CRM_62F472FCEB2E8': 'nan', 'UF_CRM_62F472FD107B7': 'nan', 'UF_CRM_62F472FD82CA4': 'nan', 'UF_CRM_62F472FDA10FE': 'nan', 'UF_CRM_62F472FDB770D': 'nan', 'UF_CRM_62F472FDE6A88': 'nan', 'UF_CRM_62F472FEAEE8E': 'nan', 'UF_CRM_62F472FEC2FBE': 'nan', 'UF_CRM_62F472FED7D03': 'nan', 'UF_CRM_62F472FEEF2AA': 'nan', 'UF_CRM_62F472FF14128': 'nan', 'UF_CRM_62F472FF29D0D': 'nan', 'UF_CRM_62F472FF8966E': 'nan', 'UF_CRM_62F472FFA5E3C': 'nan', 'UF_CRM_62F472FFC18A2': 'nan', 'UF_CRM_62F472FFDA2CC': 'nan', 'UF_CRM_62F472FFF16DB': 'nan', 'UF_CRM_62F473001A49D': 'nan', 'UF_CRM_62F4730032B19': 'nan', 'UF_CRM_62F4730049B01': 'nan', 'UF_CRM_62F473006442E': 'nan', 'UF_CRM_62F473007F4DC': 'nan', 'UF_CRM_62F473009D657': 'nan', 'UF_CRM_62F47300B3911': 'nan', 'UF_CRM_62F47300D0799': 'nan', 'UF_CRM_62F47300E7A53': 'nan', 'UF_CRM_62F4730110FF7': 'nan', 'UF_CRM_62F473012C206': 'nan', 'UF_CRM_62F47301D1987': 'nan', 'UF_CRM_62F47301EC87D': 'nan', 'UF_CRM_62F4730237A0B': 'nan', 'UF_CRM_62F47302539AB': 'nan', 'UF_CRM_62F4730349DC5': 'nan', 'UF_CRM_62F473037AC19': 'nan', 'UF_CRM_62F47303A5D21': 'nan', 'UF_CRM_62F473040F742': 'nan', 'UF_CRM_62F473042A45B': 'nan', 'UF_CRM_62F473044D2A5': 'nan', 'UF_CRM_62F473046D183': 'nan', 'UF_CRM_62F4730492E6F': 'nan', 'UF_CRM_1627874799': 'nan', 'UF_CRM_5ED0B40AE8F52': 'nan'}, 'company': {'ID': 'ID', 'TITLE': 'TITLE', 'COMPANY_TYPE': 'COMPANY_TYPE', 'LOGO': 'LOGO', 'ADDRESS': 'ADDRESS', 'ADDRESS_2': 'ADDRESS_2', 'ADDRESS_CITY': 'ADDRESS_CITY', 'ADDRESS_POSTAL_CODE': 'ADDRESS_POSTAL_CODE', 'ADDRESS_REGION': 'ADDRESS_REGION', 'ADDRESS_PROVINCE': 'ADDRESS_PROVINCE', 'ADDRESS_COUNTRY': 'ADDRESS_COUNTRY', 'ADDRESS_COUNTRY_CODE': 'ADDRESS_COUNTRY_CODE', 'ADDRESS_LOC_ADDR_ID': 'ADDRESS_LOC_ADDR_ID', 'ADDRESS_LEGAL': 'ADDRESS_LEGAL', 'REG_ADDRESS': 'REG_ADDRESS', 'REG_ADDRESS_2': 'REG_ADDRESS_2', 'REG_ADDRESS_CITY': 'REG_ADDRESS_CITY', 'REG_ADDRESS_POSTAL_CODE': 'REG_ADDRESS_POSTAL_CODE', 'REG_ADDRESS_REGION': 'REG_ADDRESS_REGION', 'REG_ADDRESS_PROVINCE': 'REG_ADDRESS_PROVINCE', 'REG_ADDRESS_COUNTRY': 'REG_ADDRESS_COUNTRY', 'REG_ADDRESS_COUNTRY_CODE': 'REG_ADDRESS_COUNTRY_CODE', 'REG_ADDRESS_LOC_ADDR_ID': 'REG_ADDRESS_LOC_ADDR_ID', 'BANKING_DETAILS': 'BANKING_DETAILS', 'INDUSTRY': 'INDUSTRY', 'EMPLOYEES': 'EMPLOYEES', 'CURRENCY_ID': 'CURRENCY_ID', 'REVENUE': 'REVENUE', 'OPENED': 'OPENED', 'COMMENTS': 'COMMENTS', 'HAS_PHONE': 'HAS_PHONE', 'HAS_EMAIL': 'HAS_EMAIL', 'HAS_IMOL': 'HAS_IMOL', 'IS_MY_COMPANY': 'IS_MY_COMPANY', 'ASSIGNED_BY_ID': 'ASSIGNED_BY_ID', 'CREATED_BY_ID': 'CREATED_BY_ID', 'MODIFY_BY_ID': 'MODIFY_BY_ID', 'CONTACT_ID': 'CONTACT_ID', 'LEAD_ID': 'LEAD_ID', 'ORIGINATOR_ID': 'ORIGINATOR_ID', 'ORIGIN_ID': 'ORIGIN_ID', 'ORIGIN_VERSION': 'ORIGIN_VERSION', 'UTM_SOURCE': 'UTM_SOURCE', 'UTM_MEDIUM': 'UTM_MEDIUM', 'UTM_CAMPAIGN': 'UTM_CAMPAIGN', 'UTM_CONTENT': 'UTM_CONTENT', 'UTM_TERM': 'UTM_TERM', 'PARENT_ID_130': 'nan', 'PARENT_ID_133': 'nan', 'PARENT_ID_159': 'nan', 'LAST_ACTIVITY_TIME': 'LAST_ACTIVITY_TIME', 'LAST_ACTIVITY_BY': 'LAST_ACTIVITY_BY', 'PHONE': 'PHONE', 'EMAIL': 'EMAIL', 'WEB': 'WEB', 'IM': 'IM', 'LINK': 'LINK', 'UF_CRM_5E8166B36CD78': 'nan', 'UF_CRM_5E8166B37DEE1': 'nan', 'UF_CRM_5E8166B385429': 'nan', 'UF_CRM_5E8166B38CB22': 'nan', 'UF_CRM_5E8166B394352': 'nan', 'UF_CRM_5E8166B39DFD9': 'nan', 'UF_CRM_5E8166B3A6656': 'nan', 'UF_CRM_5E8166B3AEB9E': 'nan', 'UF_CRM_5E894E7C70C25': 'nan', 'UF_CRM_5FE5B51011078': 'nan', 'UF_CRM_5FE5B5104E5A4': 'nan', 'UF_CRM_5FE5B51064B68': 'nan', 'UF_CRM_5FE5B51070948': 'nan', 'UF_CRM_5FE5B5107B699': 'nan', 'UF_CRM_5FE5B5108620A': 'nan', 'UF_CRM_5FE5B5108F471': 'nan', 'UF_CRM_6016375168F9D': 'nan', 'UF_CRM_1618939334410': 'nan', 'UF_CRM_1618939379772': 'nan', 'UF_CRM_1618939404812': 'nan', 'UF_CRM_1618939432985': 'nan', 'UF_CRM_1621487639482': 'nan', 'UF_CRM_60EBD22B954A0': 'nan', 'UF_CRM_60EBD22BA44E7': 'nan', 'UF_CRM_60EBD22BAD3DC': 'nan', 'UF_CRM_60EBD22BB6BFE': 'nan', 'UF_CRM_60EBD22BC2674': 'nan', 'UF_CRM_60EBD22BCB041': 'nan', 'UF_CRM_EQ_ROBOCALL': 'nan', 'UF_CRM_EQ_ZNS': 'nan', 'UF_CRM_EQ_LOCATION': 'nan', 'UF_CRM_EQ_COUNTRY': 'ADDRESS_COUNTRY', 'UF_CRM_EQ_PROVINCE': 'nan', 'UF_CRM_EQ_DISTRICT': 'nan', 'UF_CRM_EQ_WARD': 'nan', 'UF_CRM_1631875997': 'nan', 'UF_CRM_1631876208': 'nan', 'UF_CRM_1631876259': 'nan', 'UF_CRM_1631876335': 'nan', 'UF_CRM_1631876438': 'nan', 'UF_CRM_1631876503': 'nan', 'UF_CRM_1631902602049': 'nan', 'UF_CRM_TAX_CODE': 'nan', 'UF_CRM_61A703AEABD44': 'nan', 'UF_CRM_61A703AEBD480': 'nan', 'UF_CRM_THONG_TIN_BO_SUNG': 'nan', 'UF_CRM_6220B61387C09': 'nan', 'UF_CRM_6220B613A012E': 'nan', 'UF_CRM_6220B613B23F4': 'nan', 'UF_CRM_6220B613C7BA8': 'nan', 'UF_CRM_6220B613D5736': 'nan', 'UF_CRM_6296E22A55E41': 'nan', 'UF_CRM_6296E22A6BC5E': 'nan', 'UF_CRM_6296E22A72C16': 'nan', 'UF_CRM_GG_SHEET_ROW': 'nan', 'UF_CRM_GG_SHEET_ID': 'nan', 'UF_CRM_6495419C03011': 'nan', 'UF_CRM_6495419C23863': 'nan', 'UF_CRM_6495419C34E98': 'nan', 'UF_CRM_6495419C4805B': 'nan', 'UF_CRM_6495419C557D4': 'nan', 'UF_CRM_6495419C62FAF': 'nan', 'UF_CRM_6495419C6FEBC': 'nan', 'UF_CRM_6495419C7EAE7': 'nan', 'UF_CRM_6495419C8EAD7': 'nan', 'UF_CRM_6495419C9FC3D': 'nan', 'UF_CRM_6495419CB104B': 'nan', 'UF_CRM_6495419CC20E3': 'nan', 'UF_CRM_6495419CD655B': 'nan', 'UF_CRM_6495419CE6060': 'nan', 'UF_CRM_6495419D00670': 'nan', 'UF_CRM_6495419D1053B': 'nan', 'UF_CRM_6495419D2072C': 'nan', 'UF_CRM_6495419D2EFF1': 'nan', 'UF_CRM_6495419D4181D': 'nan', 'UF_CRM_6495419D5496E': 'nan', 'UF_CRM_6495419D622AB': 'nan', 'UF_CRM_6495419D73184': 'nan', 'UF_CRM_64A51CAE7667C': 'nan', 'UF_CRM_SI_SALE_CHANNEL': 'nan', 'UF_CRM_64AD0DFED57B8': 'nan', 'UF_CRM_64DD855B651DE': 'nan', 'UF_CRM_66A0A56186248': 'nan', 'UF_CRM_66A0A561A1697': 'nan', 'UF_CRM_66A0A561B22F2': 'nan', 'UF_CRM_66A0A561C19EF': 'nan', 'UF_CRM_66A0A561D3FA9': 'nan', 'UF_CRM_66A0A561E40AE': 'nan', 'UF_CRM_66A0A561F3854': 'nan', 'UF_CRM_66A0A56211CB2': 'nan', 'UF_CRM_66A0A56225575': 'nan', 'UF_CRM_66A0A562367D6': 'nan', 'UF_CRM_66A0A562503C9': 'nan', 'UF_CRM_66A0A56262B5D': 'nan', 'UF_CRM_1723363570824': 'nan', 'UF_CRM_1731384848478': 'nan', 'UF_CRM_1731384874802': 'nan', 'UF_CRM_1731924403': 'nan', 'UF_CRM_FULL_ADDRESS': 'nan', 'UF_CRM_ADDRESS_2': 'nan', 'UF_CRM_BIRTHDATE': 'nan', 'UF_CRM_ADDRESS_CITY': 'nan', 'UF_CRM_1618825272599': 'nan', 'UF_CRM_COMPANY_IDS': 'nan', 'UF_CRM_COMPANY_ID': 'nan', 'UF_CRM_1618760955519': 'nan', 'UF_CRM_TYPE_ID': 'nan', 'UF_CRM_ADDRESS_COUNTRY': 'nan', 'UF_CRM_SOURCE_DESCRIPTION': 'nan', 'UF_CRM_1618486334828': 'nan', 'UF_CRM_LAST_NAME': 'nan', 'UF_CRM_SECOND_NAME': 'nan', 'UF_CRM_NAME': 'nan', 'UF_CRM_PHOTO': 'nan', 'UF_CRM_POST': 'nan', 'UF_CRM_ADDRESS_REGION': 'nan', 'UF_CRM_ADDRESS_PROVINCE': 'nan', 'UF_CRM_HONORIFIC': 'nan', 'UF_CRM_SOURCE_ID': 'nan', 'UF_CRM_1618485445634': 'nan', 'UF_CRM_EXPORT': 'nan', 'UF_CRM_ADDRESS_POSTAL_CODE': 'nan', 'UF_CRM_1618894681844': 'nan', 'UF_CRM_1618852525561': 'nan', 'UF_CRM_5FE5B510990F5': 'nan'}, 'status': {'NEW': 'NEW', '3': '3', '7': '7', '6': '6', '2': '2', 'CONVERTED': 'CONVERTED', 'JUNK': 'JUNK', 'PREPARATION': 'PREPARATION', 'PREPAYMENT_INVOICE': 'PREPAYMENT_INVOICE', 'EXECUTING': 'EXECUTING', 'FINAL_INVOICE': 'FINAL_INVOICE', 'WON': 'WON', 'LOSE': 'LOSE', 'APOLOGY': 'APOLOGY', 'ADVERTISING': 'ADVERTISING', 'WEB': 'WEB', '4': '4', '5': '5', 'RECOMMENDATION': 'RECOMMENDATION', 'EMAIL': 'EMAIL', 'CALL': 'CALL', '6|EQVN_ZALO': '6|EQVN_ZALO', '18|FACEBOOK': '18|FACEBOOK', '15|ZALOCONNECTOR': '15|ZALOCONNECTOR', '20|OPENLINE': '20|OPENLINE', '22|FACEBOOK': '22|FACEBOOK', 'WEBFORM': 'WEBFORM', '2|OPENLINE': '2|OPENLINE', '2|FACEBOOK': '2|FACEBOOK', '8': '8', 'UC_WXTS24': 'UC_WXTS24', 'UC_MSJR21': 'UC_MSJR21', 'CALLBACK': 'CALLBACK', 'RC_GENERATOR': 'RC_GENERATOR', 'STORE': 'STORE', 'OTHER': 'OTHER'}, 'pipeline': {'0': '0'}, 'user': {}, 'default': {'ASSIGNED_BY_ID': '1', 'CATEGORY_ID': '0', 'importDesc': 'CRM cũ', 'storageId': '1'}}
2024-12-27 18:00:31,002 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:00:31,006 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:00:31,009 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:00:31,012 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 18:00:31,015 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 18:00:35,034 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:00:35,037 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:363 - Bitrix migration cleanup completed
2024-12-27 18:00:35,060 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:00:35,063 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:00:40,425 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:00:40,547 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:00:42,063 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:00:42,070 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:00:42,074 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:00:42,076 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:00:42,080 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:00:43,453 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:00:43,455 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:00:43,458 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:00:43,460 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:00:43,462 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:00:48,761 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 18:00:48,766 - [WARNING] - bitrix_migration.py:BitrixMigration.run:310 - Starting migration in DEBUG MODE
2024-12-27 18:00:48,768 - [INFO] - bitrix_migration.py:BitrixMigration.run:323 - Starting deal migration...
2024-12-27 18:00:48,778 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 18:00:48,782 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:146 - Fetching records with current page 1
2024-12-27 18:00:48,784 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:192 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 18:00:48,788 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 18:00:48,792 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 18:00:48,794 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 18:01:04,884 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:245 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 18:01:04,887 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 18:01:04,894 - [DEBUG] - deal_processor.py:DealProcessor.process_items:65 - Process records using Bitrix batch API with batch import
2024-12-27 18:01:06,171 - [DEBUG] - deal_processor.py:DealProcessor.process_items:75 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 18:01:06,230 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295505464': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=92926e6700747fcb004064a00000011a4038071e9e2ea964fecebf955128e38d5e25b1&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}}
2024-12-27 18:01:06,592 - [DEBUG] - downloader.py:Downloader.download_url_batch:268 - Batch download completed. Success: 1/1
2024-12-27 18:01:06,603 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 18:01:06,615 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 18:01:06,619 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 18:01:55,550 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 18:02:03,166 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17883,
   "total_processed": 500,
   "estimated_time": "43h 50m 44s",
   "current_page": {
      "page": 1,
      "duration": "58.27s",
      "items_per_second": "8.58",
      "processed": 500,
      "failed": 56,
      "error_rate": "11.20%"
   }
}
2024-12-27 18:02:03,169 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 18:02:03,378 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17883,
  "processed_count": 444,
  "failed_count": 56,
  "success_rate": 2.48,
  "processing_time": "0:00:58.274015",
  "average_speed": 7.62,
  "remaining_items": 17439,
  "estimated_time": "36h 54m 34s",
  "status": "completed"
}
2024-12-27 18:02:03,383 - [INFO] - bitrix_migration.py:BitrixMigration.run:328 - Completed deal migration
2024-12-27 18:02:03,385 - [INFO] - bitrix_migration.py:BitrixMigration.run:333 - Starting comment migration...
2024-12-27 18:02:03,391 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 18:02:03,394 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 18:02:03,396 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 18:02:04,344 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:04,359 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:05,178 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:02:06,069 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 18:02:08,320 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:08,602 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:08,605 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "1h 20m 34s",
   "current_page": {
      "page": 1,
      "duration": "4.25s",
      "items_per_second": "11.77",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:09,610 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 18:02:09,614 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 18:02:11,939 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:11,942 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:12,632 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:12,879 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:12,885 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "5h 7m 7s",
   "current_page": {
      "page": 2,
      "duration": "0.94s",
      "items_per_second": "53.07",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:13,895 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 18:02:13,898 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 18:02:15,094 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:15,097 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:15,841 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:16,064 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:16,068 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "4h 14m 47s",
   "current_page": {
      "page": 3,
      "duration": "0.97s",
      "items_per_second": "51.50",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:17,072 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 18:02:17,075 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 18:02:17,888 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:17,890 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:18,593 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:18,861 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:18,864 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "3h 30m 54s",
   "current_page": {
      "page": 4,
      "duration": "0.97s",
      "items_per_second": "51.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:19,870 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 18:02:19,874 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 18:02:20,934 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:20,942 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:21,592 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:21,914 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:21,922 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "2h 45m 39s",
   "current_page": {
      "page": 5,
      "duration": "0.99s",
      "items_per_second": "50.74",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:22,928 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 18:02:22,936 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 18:02:24,139 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:24,144 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:25,131 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:25,377 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:25,380 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "1h 38m 9s",
   "current_page": {
      "page": 6,
      "duration": "1.24s",
      "items_per_second": "40.40",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:26,384 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 18:02:26,387 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 18:02:27,613 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:27,616 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:28,280 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:28,532 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:28,549 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "1h 25m 57s",
   "current_page": {
      "page": 7,
      "duration": "0.92s",
      "items_per_second": "54.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:29,557 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 18:02:29,562 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 18:02:30,529 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:02:30,532 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:31,325 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:02:32,269 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 18:02:35,219 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:35,532 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:35,535 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "7m 41s",
   "current_page": {
      "page": 8,
      "duration": "5.00s",
      "items_per_second": "9.99",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:36,541 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 18:02:36,544 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 18:02:37,572 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 44 items to process for CommentProcessor
2024-12-27 18:02:37,577 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:38,432 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:02:39,553 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 18:02:41,591 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:41,881 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:41,885 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "4.31s",
      "items_per_second": "10.21",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:42,890 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 18:02:42,892 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 18:02:42,897 - [WARNING] - base_processor.py:CommentProcessor._get_and_validate_items:556 - No valid items found for CommentProcessor
2024-12-27 18:02:42,902 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:37.539369",
  "average_speed": 11.83,
  "remaining_items": 0,
  "estimated_time": "5s",
  "status": "in_progress"
}
2024-12-27 18:02:42,907 - [INFO] - bitrix_migration.py:BitrixMigration.run:338 - Completed comment migration
2024-12-27 18:02:42,909 - [INFO] - bitrix_migration.py:BitrixMigration.run:333 - Starting task migration...
2024-12-27 18:02:42,913 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 18:02:42,916 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 18:02:42,919 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 18:02:43,693 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:43,698 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:43,700 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:43,703 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:44,781 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:45,012 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:45,019 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "4h 12m 29s",
   "current_page": {
      "page": 1,
      "duration": "1.32s",
      "items_per_second": "37.95",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:46,025 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 18:02:46,028 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 18:02:46,522 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:46,525 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:46,526 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:46,528 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:46,538 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:46,753 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:46,757 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "20h 36m 56s",
   "current_page": {
      "page": 2,
      "duration": "0.23s",
      "items_per_second": "215.23",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:47,762 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 18:02:47,764 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 18:02:48,540 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:48,542 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:48,544 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:48,545 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:48,549 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:48,782 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:48,784 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "16h 53m 54s",
   "current_page": {
      "page": 3,
      "duration": "0.24s",
      "items_per_second": "206.37",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:49,789 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 18:02:49,793 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 18:02:50,846 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:50,849 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:50,850 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:50,851 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:50,855 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:51,076 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:51,079 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "14h 46m 10s",
   "current_page": {
      "page": 4,
      "duration": "0.23s",
      "items_per_second": "217.40",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:52,084 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 18:02:52,087 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 18:02:52,537 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:52,539 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:52,541 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:52,547 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:53,613 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:53,828 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:53,831 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "2h 6m 49s",
   "current_page": {
      "page": 5,
      "duration": "1.29s",
      "items_per_second": "38.72",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:54,835 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 18:02:54,837 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 18:02:55,263 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:55,267 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:55,269 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:55,271 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:55,275 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:55,483 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:55,486 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "9h 6m 1s",
   "current_page": {
      "page": 6,
      "duration": "0.22s",
      "items_per_second": "226.99",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:56,492 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 18:02:56,495 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 18:02:57,074 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:02:57,077 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:02:57,078 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:02:57,081 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:02:58,762 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:02:58,969 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:02:58,973 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "42m 6s",
   "current_page": {
      "page": 7,
      "duration": "1.90s",
      "items_per_second": "26.38",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:02:59,977 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 18:02:59,981 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 18:03:00,441 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:03:00,444 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:03:00,446 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:03:00,449 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:03:01,265 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:03:01,594 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:03:01,598 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "32m 9s",
   "current_page": {
      "page": 8,
      "duration": "1.15s",
      "items_per_second": "43.35",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:03:02,604 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 18:03:02,607 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 18:03:03,061 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 44 items to process for TaskProcessor
2024-12-27 18:03:03,064 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:03:03,066 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:03:03,068 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:03:03,073 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:03:03,233 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:03:03,237 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "0.17s",
      "items_per_second": "255.38",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:03:04,243 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 18:03:04,245 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 18:03:04,252 - [WARNING] - base_processor.py:TaskProcessor._get_and_validate_items:556 - No valid items found for TaskProcessor
2024-12-27 18:03:04,266 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:19.544406",
  "average_speed": 22.72,
  "remaining_items": 0,
  "estimated_time": "11s",
  "status": "in_progress"
}
2024-12-27 18:03:04,273 - [INFO] - bitrix_migration.py:BitrixMigration.run:338 - Completed task migration
2024-12-27 18:03:04,278 - [WARNING] - bitrix_migration.py:BitrixMigration.run:344 - DEBUG MODE migration completed in 0:02:15.507460
2024-12-27 18:03:04,282 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:363 - Bitrix migration cleanup completed
2024-12-27 18:12:48,945 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:12:48,947 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:363 - Bitrix migration cleanup completed
2024-12-27 18:12:48,950 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:12:48,953 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:12:53,508 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:12:53,614 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:12:55,024 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:12:55,032 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:12:55,035 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:12:55,037 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:12:55,040 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:12:56,489 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:12:56,492 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:12:56,494 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:12:56,496 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:12:56,498 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:28:59,133 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:28:59,137 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:363 - Bitrix migration cleanup completed
2024-12-27 18:28:59,140 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:28:59,143 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:29:06,038 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:29:06,141 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:29:07,742 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:29:07,750 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:29:07,754 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:29:07,757 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:29:07,761 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:29:09,302 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:29:09,305 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:29:09,309 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:29:09,312 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:29:09,315 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:29:17,488 - [DEBUG] - bitrix_base.py:BitrixAPI.call:136 - Missing auth credentials - attempting to get new auth
2024-12-27 18:29:17,499 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 18:29:17,502 - [INFO] - bitrix_base.py:BitrixAPI.call:143 - Successfully obtained new auth credentials
2024-12-27 18:29:17,913 - [DEBUG] - bitrix_base.py:BitrixAPI.call:136 - Missing auth credentials - attempting to get new auth
2024-12-27 18:29:17,919 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 18:29:17,923 - [INFO] - bitrix_base.py:BitrixAPI.call:143 - Successfully obtained new auth credentials
2024-12-27 18:30:58,358 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:30:58,363 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 18:30:58,383 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:30:58,388 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:31:03,792 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:31:03,905 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:31:05,352 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:31:05,358 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:31:05,361 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:31:05,364 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:31:05,367 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:31:06,897 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:31:06,904 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:31:06,909 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:31:06,912 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:31:06,914 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:31:15,899 - [DEBUG] - bitrix_base.py:BitrixAPI.call:136 - Missing auth credentials - attempting to get new auth
2024-12-27 18:31:15,902 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 18:31:15,904 - [INFO] - bitrix_base.py:BitrixAPI.call:143 - Successfully obtained new auth credentials
2024-12-27 18:31:16,286 - [DEBUG] - bitrix_base.py:BitrixAPI.call:136 - Missing auth credentials - attempting to get new auth
2024-12-27 18:31:16,293 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 18:31:16,297 - [INFO] - bitrix_base.py:BitrixAPI.call:143 - Successfully obtained new auth credentials
2024-12-27 18:33:35,401 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:33:35,404 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 18:33:35,421 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:33:35,423 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:33:40,092 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:33:40,181 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:33:41,591 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:33:41,597 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:33:41,600 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:33:41,602 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:33:41,605 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:33:42,952 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:33:42,955 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:33:42,958 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:33:42,960 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:33:42,962 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:34:08,882 - [DEBUG] - bitrix_base.py:BitrixAPI.call:136 - Missing auth credentials - attempting to get new auth
2024-12-27 18:34:08,890 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 18:34:08,892 - [INFO] - bitrix_base.py:BitrixAPI.call:143 - Successfully obtained new auth credentials
2024-12-27 18:34:09,278 - [DEBUG] - bitrix_base.py:BitrixAPI.call:136 - Missing auth credentials - attempting to get new auth
2024-12-27 18:34:09,281 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 18:34:09,284 - [INFO] - bitrix_base.py:BitrixAPI.call:143 - Successfully obtained new auth credentials
2024-12-27 18:36:05,084 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 18:36:06,274 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 18:36:06,529 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 18:36:08,132 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:36:08,174 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:36:08,182 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:36:08,185 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:36:08,188 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:36:09,751 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:36:09,754 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:36:09,757 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:36:09,760 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 18:36:09,762 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 18:36:12,767 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 18:36:12,774 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 18:36:12,777 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 18:36:12,786 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 18:36:12,790 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:146 - Fetching records with current page 1
2024-12-27 18:36:12,794 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:192 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 18:36:12,797 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 18:36:12,801 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 18:36:12,804 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 18:36:28,501 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:245 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 18:36:28,504 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 18:36:28,511 - [DEBUG] - deal_processor.py:DealProcessor.process_items:65 - Process records using Bitrix batch API with batch import
2024-12-27 18:36:29,527 - [DEBUG] - deal_processor.py:DealProcessor.process_items:75 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 18:36:29,608 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=92926e6700747fcb004064a00000011a4038071e9e2ea964fecebf955128e38d5e25b1&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=92926e6700747fcb004064a00000011a4038071e9e2ea964fecebf955128e38d5e25b1&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}}
2024-12-27 18:36:30,217 - [DEBUG] - downloader.py:Downloader.download_url_batch:268 - Batch download completed. Success: 2/2
2024-12-27 18:36:30,223 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 18:36:30,228 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 18:36:30,231 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 18:37:21,049 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 18:37:28,386 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17883,
   "total_processed": 500,
   "estimated_time": "42h 44m 10s",
   "current_page": {
      "page": 1,
      "duration": "59.88s",
      "items_per_second": "8.35",
      "processed": 500,
      "failed": 56,
      "error_rate": "11.20%"
   }
}
2024-12-27 18:37:28,389 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 18:37:28,648 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17883,
  "processed_count": 444,
  "failed_count": 56,
  "success_rate": 2.48,
  "processing_time": "0:00:59.877095",
  "average_speed": 7.42,
  "remaining_items": 17439,
  "estimated_time": "35h 55m 17s",
  "status": "completed"
}
2024-12-27 18:37:28,654 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 18:37:28,656 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 18:37:28,661 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 18:37:28,664 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 18:37:28,669 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 18:37:29,295 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:29,300 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:30,119 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:37:31,009 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 18:37:33,206 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:33,399 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:33,403 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "1h 23m 19s",
   "current_page": {
      "page": 1,
      "duration": "4.10s",
      "items_per_second": "12.19",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:34,408 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 18:37:34,412 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 18:37:35,115 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:35,119 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:35,776 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:35,943 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:35,948 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "5h 48m 44s",
   "current_page": {
      "page": 2,
      "duration": "0.83s",
      "items_per_second": "60.31",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:36,953 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 18:37:36,956 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 18:37:37,576 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:37,579 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:38,220 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:38,402 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:38,407 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "4h 58m 52s",
   "current_page": {
      "page": 3,
      "duration": "0.83s",
      "items_per_second": "60.49",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:39,412 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 18:37:39,416 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 18:37:40,018 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:40,022 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:40,679 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:40,884 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:40,887 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "3h 56m 51s",
   "current_page": {
      "page": 4,
      "duration": "0.87s",
      "items_per_second": "57.74",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:41,893 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 18:37:41,896 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 18:37:42,478 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:42,481 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:43,032 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:43,264 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:43,267 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "3h 27m 17s",
   "current_page": {
      "page": 5,
      "duration": "0.79s",
      "items_per_second": "63.61",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:44,272 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 18:37:44,276 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 18:37:44,925 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:44,929 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:45,411 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:45,571 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:45,575 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "3h 6m 52s",
   "current_page": {
      "page": 6,
      "duration": "0.65s",
      "items_per_second": "77.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:46,580 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 18:37:46,585 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 18:37:47,176 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:47,179 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:47,971 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:48,150 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:48,153 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "1h 21m 9s",
   "current_page": {
      "page": 7,
      "duration": "0.97s",
      "items_per_second": "51.30",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:49,158 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 18:37:49,162 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 18:37:49,827 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:37:49,830 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:50,617 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:37:51,515 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 18:37:53,613 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:37:53,808 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:37:53,812 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "9m 34s",
   "current_page": {
      "page": 8,
      "duration": "3.98s",
      "items_per_second": "12.56",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:37:54,818 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 18:37:54,822 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 18:37:55,548 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 44 items to process for CommentProcessor
2024-12-27 18:37:55,551 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:37:56,354 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:37:57,642 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 18:38:00,587 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:00,747 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:00,750 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "5.20s",
      "items_per_second": "8.46",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:01,758 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 18:38:01,762 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 18:38:01,768 - [WARNING] - base_processor.py:CommentProcessor._get_and_validate_items:556 - No valid items found for CommentProcessor
2024-12-27 18:38:01,781 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:31.455860",
  "average_speed": 14.12,
  "remaining_items": 0,
  "estimated_time": "7s",
  "status": "in_progress"
}
2024-12-27 18:38:01,788 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 18:38:01,798 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 18:38:01,808 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 18:38:01,814 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 18:38:01,820 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 18:38:02,732 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:02,743 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:02,748 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:02,755 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:03,706 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:03,901 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:03,906 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "4h 46m 2s",
   "current_page": {
      "page": 1,
      "duration": "1.16s",
      "items_per_second": "43.06",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:04,912 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 18:38:04,916 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 18:38:05,506 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:05,509 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:05,511 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:05,514 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:05,524 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:05,740 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:05,744 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "20h 21m 19s",
   "current_page": {
      "page": 2,
      "duration": "0.24s",
      "items_per_second": "212.50",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:06,750 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 18:38:06,754 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 18:38:07,187 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:07,190 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:07,193 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:07,195 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:07,200 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:07,413 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:07,417 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "18h 3m 2s",
   "current_page": {
      "page": 3,
      "duration": "0.23s",
      "items_per_second": "220.51",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:08,422 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 18:38:08,424 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 18:38:08,870 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:08,873 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:08,875 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:08,877 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:08,881 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:09,056 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:09,060 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "18h 11m 39s",
   "current_page": {
      "page": 4,
      "duration": "0.19s",
      "items_per_second": "267.91",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:10,065 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 18:38:10,068 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 18:38:11,053 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:11,057 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:11,062 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:11,066 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:11,077 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:11,254 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:11,258 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "13h 23m 27s",
   "current_page": {
      "page": 5,
      "duration": "0.20s",
      "items_per_second": "247.97",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:12,264 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 18:38:12,268 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 18:38:12,696 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:12,700 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:12,702 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:12,704 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:12,708 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:12,877 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:12,881 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "11h 3m 42s",
   "current_page": {
      "page": 6,
      "duration": "0.18s",
      "items_per_second": "276.02",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:13,886 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 18:38:13,889 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 18:38:14,476 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:14,479 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:14,481 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:14,487 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:15,383 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:15,616 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:15,620 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "1h 9m 28s",
   "current_page": {
      "page": 7,
      "duration": "1.14s",
      "items_per_second": "43.85",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:16,625 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 18:38:16,629 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 18:38:17,072 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:38:17,075 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:17,076 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:17,080 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:17,870 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:18,049 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:18,052 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "37m 52s",
   "current_page": {
      "page": 8,
      "duration": "0.98s",
      "items_per_second": "51.16",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:19,062 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 18:38:19,066 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 18:38:19,456 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 44 items to process for TaskProcessor
2024-12-27 18:38:19,459 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:38:19,461 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:38:19,463 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:38:19,468 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:38:19,621 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:38:19,625 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "0.17s",
      "items_per_second": "265.80",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:38:20,630 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 18:38:20,634 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 18:38:20,638 - [WARNING] - base_processor.py:TaskProcessor._get_and_validate_items:556 - No valid items found for TaskProcessor
2024-12-27 18:38:20,644 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:16.890364",
  "average_speed": 26.29,
  "remaining_items": 0,
  "estimated_time": "13s",
  "status": "in_progress"
}
2024-12-27 18:38:20,649 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 18:38:20,653 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:02:07.876555
2024-12-27 18:38:20,658 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 18:44:17,375 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:44:17,378 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 18:44:17,381 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:44:17,384 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:44:21,895 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:44:21,999 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:44:23,439 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:44:23,454 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:44:23,472 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:44:23,475 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:44:23,480 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:44:24,899 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:44:24,902 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:44:24,904 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:44:24,906 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:44:24,908 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:48:29,744 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 18:48:29,747 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 18:48:29,766 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 18:48:29,769 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 18:48:35,899 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 18:48:36,013 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 18:48:37,554 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:48:37,561 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:48:37,564 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:48:37,568 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:48:37,573 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:48:39,160 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:48:39,164 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:48:39,167 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:48:39,170 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 18:48:39,173 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 18:48:48,225 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 18:48:49,401 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 18:48:49,631 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 18:48:51,193 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 18:48:51,246 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 18:48:51,256 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 18:48:51,262 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 18:48:51,264 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 18:48:52,626 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 18:48:52,629 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 18:48:52,631 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 18:48:52,634 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 18:48:52,636 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 18:50:58,835 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 18:50:58,840 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 18:50:58,842 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 18:50:58,850 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 18:50:58,853 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:146 - Fetching records with current page 1
2024-12-27 18:50:58,856 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:192 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 18:50:58,859 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 18:50:58,863 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-27 18:50:59,876 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 18:51:14,528 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:245 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 18:51:14,531 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 18:51:14,537 - [DEBUG] - deal_processor.py:DealProcessor.process_items:65 - Process records using Bitrix batch API with batch import
2024-12-27 18:51:15,535 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=b3a26e6700747fcb004064a00000011a403807584cea08a178e536662db95b2e0c7f0f&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=b3a26e6700747fcb004064a00000011a403807584cea08a178e536662db95b2e0c7f0f&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=b3a26e6700747fcb004064a00000011a403807584cea08a178e536662db95b2e0c7f0f&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 18:51:16,474 - [DEBUG] - downloader.py:Downloader.download_url_batch:268 - Batch download completed. Success: 3/3
2024-12-27 18:51:16,479 - [DEBUG] - deal_processor.py:DealProcessor.process_items:77 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 18:51:16,530 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 18:51:16,533 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-27 18:51:17,432 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 18:52:02,192 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 18:52:09,615 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17883,
   "total_processed": 500,
   "estimated_time": "46h 14m 54s",
   "current_page": {
      "page": 1,
      "duration": "55.08s",
      "items_per_second": "9.08",
      "processed": 500,
      "failed": 56,
      "error_rate": "11.20%"
   }
}
2024-12-27 18:52:09,617 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 18:52:09,846 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17883,
  "processed_count": 444,
  "failed_count": 56,
  "success_rate": 2.48,
  "processing_time": "0:00:55.078510",
  "average_speed": 8.06,
  "remaining_items": 17439,
  "estimated_time": "39h 3m 3s",
  "status": "completed"
}
2024-12-27 18:52:09,851 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 18:52:09,853 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 18:52:09,858 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 18:52:09,859 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 18:52:09,864 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 18:52:10,475 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:10,484 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:11,304 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:52:12,182 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 18:52:14,353 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:14,576 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:14,579 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "1h 23m 26s",
   "current_page": {
      "page": 1,
      "duration": "4.10s",
      "items_per_second": "12.21",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:15,583 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 18:52:15,586 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 18:52:16,147 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:16,150 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:16,770 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:16,994 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:16,998 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "5h 40m 33s",
   "current_page": {
      "page": 2,
      "duration": "0.85s",
      "items_per_second": "58.90",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:18,004 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 18:52:18,007 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 18:52:18,601 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:18,605 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:19,286 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:19,532 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:19,536 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "4h 25m 48s",
   "current_page": {
      "page": 3,
      "duration": "0.93s",
      "items_per_second": "53.75",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:20,541 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 18:52:20,543 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 18:52:21,101 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:21,104 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:21,704 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:21,876 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:21,878 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "4h 24m 18s",
   "current_page": {
      "page": 4,
      "duration": "0.78s",
      "items_per_second": "64.49",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:22,883 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 18:52:22,887 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 18:52:23,817 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:23,819 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:24,461 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:24,736 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:24,739 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "2h 57m 29s",
   "current_page": {
      "page": 5,
      "duration": "0.92s",
      "items_per_second": "54.39",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:25,745 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 18:52:25,747 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 18:52:26,308 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:26,312 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:26,967 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:27,187 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:27,190 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "2h 17m 41s",
   "current_page": {
      "page": 6,
      "duration": "0.88s",
      "items_per_second": "56.87",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:28,194 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 18:52:28,196 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 18:52:28,862 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:28,864 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:29,670 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:52:30,557 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 18:52:32,643 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:32,855 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:32,858 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "20m 23s",
   "current_page": {
      "page": 7,
      "duration": "3.99s",
      "items_per_second": "12.52",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:33,864 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 18:52:33,866 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 18:52:34,401 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 18:52:34,404 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:34,969 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:35,195 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:35,199 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "46m 31s",
   "current_page": {
      "page": 8,
      "duration": "0.79s",
      "items_per_second": "62.94",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:36,204 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 18:52:36,207 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 18:52:36,850 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 44 items to process for CommentProcessor
2024-12-27 18:52:36,853 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:37,673 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 18:52:39,231 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 18:52:42,027 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:42,181 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:42,184 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "5.33s",
      "items_per_second": "8.25",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:43,189 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 18:52:43,192 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 18:52:43,195 - [WARNING] - base_processor.py:CommentProcessor._get_and_validate_items:556 - No valid items found for CommentProcessor
2024-12-27 18:52:43,206 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:31.707922",
  "average_speed": 14.0,
  "remaining_items": 0,
  "estimated_time": "7s",
  "status": "in_progress"
}
2024-12-27 18:52:43,215 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 18:52:43,218 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 18:52:43,224 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 18:52:43,226 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 18:52:43,230 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 18:52:44,436 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:44,442 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:44,443 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:44,449 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:45,281 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:45,504 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:45,507 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "5h 11m 27s",
   "current_page": {
      "page": 1,
      "duration": "1.07s",
      "items_per_second": "46.93",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:46,513 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 18:52:46,515 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 18:52:46,957 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:46,960 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:46,962 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:46,964 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:46,972 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:47,167 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:47,171 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "22h 38m 41s",
   "current_page": {
      "page": 2,
      "duration": "0.21s",
      "items_per_second": "236.46",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:48,176 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 18:52:48,180 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 18:52:48,590 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:48,592 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:48,594 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:48,595 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:48,601 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:48,800 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:48,804 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "19h 27m 56s",
   "current_page": {
      "page": 3,
      "duration": "0.21s",
      "items_per_second": "237.84",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:49,808 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 18:52:49,812 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 18:52:50,253 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:50,256 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:50,257 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:50,258 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:50,264 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:50,466 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:50,469 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "15h 54m 25s",
   "current_page": {
      "page": 4,
      "duration": "0.21s",
      "items_per_second": "234.18",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:51,475 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 18:52:51,477 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 18:52:51,888 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:51,890 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:51,892 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:51,893 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:51,896 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:52,121 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:52,125 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "11h 32m 36s",
   "current_page": {
      "page": 5,
      "duration": "0.23s",
      "items_per_second": "213.69",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:53,130 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 18:52:53,133 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 18:52:53,532 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:53,535 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:53,536 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:53,540 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:54,354 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:54,543 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:54,545 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "1h 59m 51s",
   "current_page": {
      "page": 6,
      "duration": "1.01s",
      "items_per_second": "49.44",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:55,551 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 18:52:55,554 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 18:52:55,983 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:55,987 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:55,989 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:55,996 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:56,829 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:57,049 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:57,054 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "1h 14m 15s",
   "current_page": {
      "page": 7,
      "duration": "1.07s",
      "items_per_second": "46.90",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:52:58,059 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 18:52:58,061 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 18:52:58,478 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 18:52:58,481 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:52:58,483 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:52:58,487 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:52:59,275 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:52:59,478 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:52:59,481 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "36m 58s",
   "current_page": {
      "page": 8,
      "duration": "1.00s",
      "items_per_second": "49.92",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:53:00,486 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 18:53:00,489 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 18:53:00,877 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 44 items to process for TaskProcessor
2024-12-27 18:53:00,880 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 18:53:00,883 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 18:53:00,885 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 18:53:00,890 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 18:53:01,084 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 18:53:01,088 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "0.21s",
      "items_per_second": "212.11",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 18:53:02,093 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 18:53:02,098 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 18:53:02,106 - [WARNING] - base_processor.py:TaskProcessor._get_and_validate_items:556 - No valid items found for TaskProcessor
2024-12-27 18:53:02,121 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:16.651369",
  "average_speed": 26.66,
  "remaining_items": 0,
  "estimated_time": "13s",
  "status": "in_progress"
}
2024-12-27 18:53:02,131 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 18:53:02,144 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:02:03.300148
2024-12-27 18:53:02,150 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:10:06,765 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:10:07,939 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:10:08,160 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:10:09,806 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:10:09,848 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:10:09,856 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:10:09,859 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:10:09,861 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:10:12,047 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:10:12,050 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:10:12,053 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:10:12,056 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:10:12,058 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:10:14,981 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:10:14,984 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:10:15,003 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:10:15,006 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:10:20,205 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:10:20,322 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:10:21,821 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:10:21,827 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:10:21,831 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:10:21,834 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:10:21,837 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:10:23,378 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:10:23,381 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:10:23,390 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:10:23,393 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:10:23,395 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:11:15,000 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:11:15,005 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:11:15,008 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:11:15,018 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:11:15,021 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:237 - Fetching records with current page 1
2024-12-27 20:11:15,023 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:283 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:11:15,026 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:11:15,029 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-27 20:11:15,932 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:11:36,827 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:336 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:11:36,830 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:11:36,837 - [DEBUG] - deal_processor.py:DealProcessor.process_items:69 - Process records using Bitrix batch API with batch import
2024-12-27 20:11:37,941 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:11:39,052 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:11:39,056 - [DEBUG] - deal_processor.py:DealProcessor.process_items:81 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:11:39,113 - [ERROR] - deal_processor.py:DealProcessor.process_items:91 - Transform data failed: 'BitrixAPI' object has no attribute 'entityTypeId'
2024-12-27 20:14:25,803 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "16h 42m 53s",
   "current_page": {
      "page": 1,
      "duration": "168.96s",
      "items_per_second": "2.96",
      "processed": 500,
      "failed": 500,
      "error_rate": "100.00%"
   }
}
2024-12-27 20:14:25,809 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:14:26,221 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 0,
  "failed_count": 500,
  "success_rate": 0.0,
  "processing_time": "0:02:48.431908",
  "average_speed": 0.0,
  "remaining_items": 17895,
  "estimated_time": "0s",
  "status": "completed"
}
2024-12-27 20:14:26,226 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:14:26,228 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:14:26,233 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:14:26,236 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:14:26,239 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:14:26,242 - [WARNING] - base_processor.py:CommentProcessor._get_and_validate_items:556 - No valid items found for CommentProcessor
2024-12-27 20:14:26,246 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {}
2024-12-27 20:14:26,249 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 20:14:26,252 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 20:14:26,258 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:14:26,260 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 20:14:26,262 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:14:26,267 - [WARNING] - base_processor.py:TaskProcessor._get_and_validate_items:556 - No valid items found for TaskProcessor
2024-12-27 20:14:26,272 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {}
2024-12-27 20:14:26,275 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 20:14:26,278 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:03:11.270493
2024-12-27 20:14:26,281 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:19:13,389 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:19:13,392 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:19:13,415 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:19:13,418 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:19:19,187 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:19:19,308 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:19:20,795 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:19:20,804 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:19:20,807 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:19:20,810 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:19:20,814 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:19:22,960 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:19:22,964 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:19:22,967 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:19:22,970 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:19:22,973 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:19:26,022 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:19:27,246 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:19:27,463 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:19:29,054 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:19:29,101 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:19:29,110 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:19:29,113 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:19:29,116 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:19:30,556 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:19:30,559 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:19:30,561 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:19:30,564 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:19:30,566 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:19:34,045 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:19:34,052 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:19:34,055 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:19:34,065 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:19:34,068 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:238 - Fetching records with current page 1
2024-12-27 20:19:34,072 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:284 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:19:34,076 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:19:34,080 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 20:19:34,083 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:19:56,139 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:337 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:19:56,142 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:19:56,149 - [DEBUG] - deal_processor.py:DealProcessor.process_items:69 - Process records using Bitrix batch API with batch import
2024-12-27 20:19:57,218 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:19:58,213 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:19:58,219 - [DEBUG] - deal_processor.py:DealProcessor.process_items:81 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:19:58,294 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:19:58,298 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-27 20:19:59,256 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:21:06,478 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 20:21:14,800 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "33h 7m 59s",
   "current_page": {
      "page": 1,
      "duration": "78.65s",
      "items_per_second": "6.36",
      "processed": 500,
      "failed": 56,
      "error_rate": "11.20%"
   }
}
2024-12-27 20:21:14,803 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:21:15,086 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 444,
  "failed_count": 56,
  "success_rate": 2.48,
  "processing_time": "0:01:18.652611",
  "average_speed": 5.65,
  "remaining_items": 17451,
  "estimated_time": "27h 21m 55s",
  "status": "completed"
}
2024-12-27 20:21:15,093 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:21:15,095 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:21:15,102 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:21:15,105 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:21:15,111 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:21:16,540 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:16,548 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:17,480 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:21:18,333 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:21:20,727 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:21,038 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:21,042 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "1h 16m 20s",
   "current_page": {
      "page": 1,
      "duration": "4.49s",
      "items_per_second": "11.13",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:22,049 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 20:21:22,058 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:21:23,170 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:23,173 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:23,996 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:24,295 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:24,302 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "4h 16m 52s",
   "current_page": {
      "page": 2,
      "duration": "1.13s",
      "items_per_second": "44.30",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:25,308 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 20:21:25,311 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:21:25,925 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:25,928 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:27,101 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:27,342 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:27,346 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "2h 55m 11s",
   "current_page": {
      "page": 3,
      "duration": "1.42s",
      "items_per_second": "35.25",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:28,352 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 20:21:28,355 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:21:29,099 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:29,102 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:30,078 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:30,326 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:30,329 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "2h 47m 41s",
   "current_page": {
      "page": 4,
      "duration": "1.23s",
      "items_per_second": "40.73",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:31,335 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 20:21:31,340 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:21:32,019 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:32,024 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:32,743 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:33,006 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:33,009 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "2h 45m 17s",
   "current_page": {
      "page": 5,
      "duration": "0.99s",
      "items_per_second": "50.62",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:34,014 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 20:21:34,018 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:21:34,633 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:34,638 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:35,120 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:35,472 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:35,477 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "2h 24m",
   "current_page": {
      "page": 6,
      "duration": "0.84s",
      "items_per_second": "59.50",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:36,482 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 20:21:36,485 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:21:37,208 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:37,211 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:38,238 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:38,443 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:38,446 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "1h 4m 10s",
   "current_page": {
      "page": 7,
      "duration": "1.24s",
      "items_per_second": "40.46",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:39,451 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 20:21:39,453 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:21:40,089 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:21:40,092 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:41,106 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:21:42,050 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:21:44,773 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:45,129 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:45,133 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "7m 38s",
   "current_page": {
      "page": 8,
      "duration": "5.04s",
      "items_per_second": "9.92",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:46,138 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 20:21:46,141 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:21:46,961 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 44 items to process for CommentProcessor
2024-12-27 20:21:46,964 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:47,775 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:21:48,933 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:21:52,302 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:52,513 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:52,517 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "5.55s",
      "items_per_second": "7.92",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:53,521 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 20:21:53,526 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:21:53,530 - [WARNING] - base_processor.py:CommentProcessor._get_and_validate_items:556 - No valid items found for CommentProcessor
2024-12-27 20:21:53,536 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:35.976231",
  "average_speed": 12.34,
  "remaining_items": 0,
  "estimated_time": "6s",
  "status": "in_progress"
}
2024-12-27 20:21:53,544 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 20:21:53,546 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 20:21:53,550 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:21:53,553 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 20:21:53,556 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:21:54,271 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:21:54,276 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:54,277 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:21:54,280 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:21:55,242 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:55,609 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:55,615 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 50,
   "estimated_time": "4h 8m 36s",
   "current_page": {
      "page": 1,
      "duration": "1.34s",
      "items_per_second": "37.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:56,621 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 20:21:56,623 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:21:57,064 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:21:57,068 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:57,069 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:21:57,070 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:21:57,078 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:57,306 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:57,310 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 100,
   "estimated_time": "19h 43m 16s",
   "current_page": {
      "page": 2,
      "duration": "0.24s",
      "items_per_second": "205.87",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:21:58,315 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 20:21:58,318 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:21:58,823 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:21:58,826 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:21:58,828 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:21:58,830 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:21:58,834 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:21:59,118 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:21:59,121 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 150,
   "estimated_time": "13h 50m 27s",
   "current_page": {
      "page": 3,
      "duration": "0.30s",
      "items_per_second": "168.97",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:00,128 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 20:22:00,131 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:22:00,586 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:22:00,589 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:22:00,590 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:22:00,592 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:22:00,595 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:22:00,795 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:22:00,800 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 200,
   "estimated_time": "16h 7m 55s",
   "current_page": {
      "page": 4,
      "duration": "0.21s",
      "items_per_second": "237.49",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:01,805 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 20:22:01,809 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:22:02,939 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:22:02,943 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:22:02,945 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:22:02,947 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:22:02,952 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:22:03,179 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:22:03,183 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 250,
   "estimated_time": "11h 14m 8s",
   "current_page": {
      "page": 5,
      "duration": "0.24s",
      "items_per_second": "207.98",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:04,190 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 20:22:04,193 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:22:05,245 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:22:05,250 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:22:05,252 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:22:05,253 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:22:05,260 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:22:05,528 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:22:05,531 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 300,
   "estimated_time": "7h 4m 53s",
   "current_page": {
      "page": 6,
      "duration": "0.28s",
      "items_per_second": "176.48",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:06,536 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 20:22:06,539 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:22:07,741 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:22:07,744 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:22:07,745 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:22:07,750 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:22:09,169 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:22:09,634 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:22:09,646 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 350,
   "estimated_time": "42m 3s",
   "current_page": {
      "page": 7,
      "duration": "1.90s",
      "items_per_second": "26.35",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:10,662 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 20:22:10,667 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:22:11,262 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:22:11,273 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:22:11,275 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:22:11,280 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:22:12,091 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:22:12,348 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:22:12,353 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 400,
   "estimated_time": "34m 16s",
   "current_page": {
      "page": 8,
      "duration": "1.08s",
      "items_per_second": "46.25",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:13,357 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 20:22:13,360 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:22:14,338 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 44 items to process for TaskProcessor
2024-12-27 20:22:14,342 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:22:14,343 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:22:14,345 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:22:14,349 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:22:14,529 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:22:14,532 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 444,
   "total_processed": 444,
   "estimated_time": "0s",
   "current_page": {
      "page": 9,
      "duration": "0.19s",
      "items_per_second": "230.68",
      "processed": 44,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:22:15,539 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 20:22:15,542 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:22:15,545 - [WARNING] - base_processor.py:TaskProcessor._get_and_validate_items:556 - No valid items found for TaskProcessor
2024-12-27 20:22:15,551 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 444,
  "processed_count": 444,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:20.260581",
  "average_speed": 21.91,
  "remaining_items": 0,
  "estimated_time": "10s",
  "status": "in_progress"
}
2024-12-27 20:22:15,557 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 20:22:15,559 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:02:41.505407
2024-12-27 20:22:15,562 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:24:54,998 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:24:55,002 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:24:55,025 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:24:55,027 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:25:00,062 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:25:00,175 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:25:02,146 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:25:02,166 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:25:02,174 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:25:02,179 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:25:02,200 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:25:04,328 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:25:04,331 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:25:04,334 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:25:04,337 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:25:04,341 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:25:20,058 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:25:21,241 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:25:21,488 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:25:23,045 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:25:23,089 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:25:23,095 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:25:23,098 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:25:23,101 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:25:24,530 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:25:24,533 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:25:24,536 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:25:24,539 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:25:24,542 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:29:51,596 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:29:51,600 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:29:51,623 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:29:51,626 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:29:57,083 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:29:57,199 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:29:58,757 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:29:58,764 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:29:58,769 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:29:58,772 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:29:58,777 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:30:00,274 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:30:00,277 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:30:00,281 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:30:00,284 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:30:00,287 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:30:10,492 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:30:11,687 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:30:11,918 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:30:13,533 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:30:13,579 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:30:13,587 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:30:13,591 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:30:13,595 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:30:15,226 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:30:15,229 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:30:15,233 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:30:15,235 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:30:15,238 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:30:20,872 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:30:20,878 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:30:20,882 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:30:20,892 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:30:20,896 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:238 - Fetching records with current page 1
2024-12-27 20:30:20,900 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:284 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:30:20,904 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:30:20,910 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 20:30:20,913 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:30:42,589 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:337 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:30:42,593 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:30:42,600 - [DEBUG] - deal_processor.py:DealProcessor.process_items:74 - Process records using Bitrix batch API with batch import
2024-12-27 20:30:43,693 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:30:44,265 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:30:44,271 - [DEBUG] - deal_processor.py:DealProcessor.process_items:86 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:30:44,348 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:30:44,352 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 20:30:44,355 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:32:03,037 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 20:32:07,163 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "30h 59m 13s",
   "current_page": {
      "page": 1,
      "duration": "84.56s",
      "items_per_second": "5.91",
      "processed": 500,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:07,167 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:32:07,452 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 2.79,
  "processing_time": "0:01:24.560762",
  "average_speed": 5.91,
  "remaining_items": 17395,
  "estimated_time": "28h 34m 17s",
  "status": "completed"
}
2024-12-27 20:32:07,473 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:32:07,476 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:32:07,483 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:32:07,488 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:32:07,491 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:32:08,226 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:08,231 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:09,055 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:32:10,461 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:32:13,102 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:13,306 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:13,309 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "1h 17m 35s",
   "current_page": {
      "page": 1,
      "duration": "5.08s",
      "items_per_second": "9.85",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:14,313 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 20:32:14,316 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:32:15,107 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:15,110 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:16,167 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:16,386 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:16,390 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "4h 23m 41s",
   "current_page": {
      "page": 2,
      "duration": "1.28s",
      "items_per_second": "39.05",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:17,395 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 20:32:17,398 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:32:18,006 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:18,009 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:18,780 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:19,080 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:19,083 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "4h 34m 27s",
   "current_page": {
      "page": 3,
      "duration": "1.07s",
      "items_per_second": "46.55",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:20,088 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 20:32:20,090 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:32:20,674 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:20,679 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:21,520 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:21,772 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:21,775 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "3h 50m 17s",
   "current_page": {
      "page": 4,
      "duration": "1.10s",
      "items_per_second": "45.56",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:22,780 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 20:32:22,783 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:32:23,567 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:23,571 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:24,383 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:32:25,361 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:32:27,788 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:28,011 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:28,016 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "48m 56s",
   "current_page": {
      "page": 5,
      "duration": "4.45s",
      "items_per_second": "11.24",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:29,023 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 20:32:29,027 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:32:29,610 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:29,613 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:30,367 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:30,580 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:30,583 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "2h 53m 19s",
   "current_page": {
      "page": 6,
      "duration": "0.97s",
      "items_per_second": "51.50",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:31,588 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 20:32:31,590 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:32:32,236 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:32,239 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:33,038 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:32:39,063 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 7/7
2024-12-27 20:32:49,010 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:49,249 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:49,254 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "8m 35s",
   "current_page": {
      "page": 7,
      "duration": "17.01s",
      "items_per_second": "2.94",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:50,260 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 20:32:50,262 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:32:51,041 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:51,043 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:51,965 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:32:52,541 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 1/1
2024-12-27 20:32:54,301 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:32:54,520 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:32:54,523 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "24m 46s",
   "current_page": {
      "page": 8,
      "duration": "3.48s",
      "items_per_second": "14.37",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:32:55,527 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 20:32:55,529 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:32:56,197 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:32:56,201 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:32:56,970 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:32:57,490 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 1/1
2024-12-27 20:33:00,035 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:00,237 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:00,241 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "10m 43s",
   "current_page": {
      "page": 9,
      "duration": "4.04s",
      "items_per_second": "12.37",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:01,247 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 20:33:01,249 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:33:02,063 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:33:02,069 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:02,840 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:33:05,633 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 6/6
2024-12-27 20:33:11,833 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:12,074 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:12,077 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "10.01s",
      "items_per_second": "5.00",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:12,079 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:33:12,086 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:01:03.843886",
  "average_speed": 7.83,
  "remaining_items": 0,
  "estimated_time": "3s",
  "status": "in_progress"
}
2024-12-27 20:33:12,090 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 20:33:12,093 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 20:33:12,097 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:33:12,100 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 20:33:12,103 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:33:12,597 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:12,603 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:12,604 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:12,606 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:13,483 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:13,716 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:13,720 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "5h 39m 42s",
   "current_page": {
      "page": 1,
      "duration": "1.12s",
      "items_per_second": "44.79",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:14,725 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 20:33:14,728 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:33:15,160 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:15,163 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:15,166 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:15,168 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:15,181 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:15,452 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:15,458 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "18h 53m 37s",
   "current_page": {
      "page": 2,
      "duration": "0.29s",
      "items_per_second": "169.53",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:16,463 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 20:33:16,465 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:33:16,931 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:16,934 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:16,935 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:16,936 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:16,940 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:17,133 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:17,136 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "24h 1m 46s",
   "current_page": {
      "page": 3,
      "duration": "0.20s",
      "items_per_second": "246.64",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:18,140 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 20:33:18,143 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:33:18,577 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:18,581 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:18,583 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:18,586 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:18,590 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:18,839 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:18,843 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "15h 52m 14s",
   "current_page": {
      "page": 4,
      "duration": "0.26s",
      "items_per_second": "189.93",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:19,849 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 20:33:19,852 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:33:20,316 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:20,326 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:20,328 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:20,336 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:21,403 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:21,679 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:21,682 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "2h 34m 57s",
   "current_page": {
      "page": 5,
      "duration": "1.36s",
      "items_per_second": "36.69",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:22,687 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 20:33:22,689 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:33:23,119 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:23,122 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:23,124 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:23,125 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:23,129 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:23,352 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:23,355 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "11h 57m 20s",
   "current_page": {
      "page": 6,
      "duration": "0.23s",
      "items_per_second": "214.57",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:24,360 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 20:33:24,362 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:33:24,793 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:24,797 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:24,799 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:24,801 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:25,610 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:25,824 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:25,829 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "2h 2m 29s",
   "current_page": {
      "page": 7,
      "duration": "1.03s",
      "items_per_second": "48.50",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:26,836 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 20:33:26,839 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:33:27,300 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:27,303 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:27,305 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:27,309 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:28,434 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:28,675 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:28,679 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "1h 1m 24s",
   "current_page": {
      "page": 8,
      "duration": "1.38s",
      "items_per_second": "36.35",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:29,685 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 20:33:29,692 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:33:30,394 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:30,399 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:30,401 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:30,411 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:35,859 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:36,107 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:36,111 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "7m 42s",
   "current_page": {
      "page": 9,
      "duration": "5.71s",
      "items_per_second": "8.75",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:37,116 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 20:33:37,118 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:33:37,643 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:33:37,649 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:33:37,652 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:33:37,662 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:33:39,636 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:33:39,920 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:33:39,924 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "2.28s",
      "items_per_second": "21.95",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:33:39,932 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:33:39,954 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:27.317210",
  "average_speed": 18.3,
  "remaining_items": 0,
  "estimated_time": "9s",
  "status": "in_progress"
}
2024-12-27 20:33:39,960 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 20:33:39,962 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:03:19.080850
2024-12-27 20:33:39,966 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:34:16,312 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:34:16,314 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:34:16,341 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:34:16,343 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:34:21,838 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:34:21,960 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:34:23,425 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:34:23,432 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:34:23,436 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:34:23,444 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:34:23,448 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:34:24,836 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:34:24,839 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:34:24,841 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:34:24,843 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:34:24,845 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:36:00,297 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:36:00,301 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:36:00,333 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:36:00,341 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:36:07,275 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:36:07,399 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:36:08,937 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:36:08,944 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:36:08,948 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:36:08,951 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:36:08,955 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:36:10,530 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:36:10,534 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:36:10,537 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:36:10,540 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:36:10,543 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:36:12,197 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:36:13,351 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:36:13,604 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:36:15,172 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:36:15,217 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:36:15,224 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:36:15,227 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:36:15,230 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:36:16,677 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:36:16,680 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:36:16,684 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:36:16,687 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:36:16,689 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:36:51,536 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:36:51,543 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:36:51,547 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:36:51,565 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:36:51,570 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:238 - Fetching records with current page 1
2024-12-27 20:36:51,577 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:284 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:36:51,590 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:36:51,608 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 20:36:51,611 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:37:10,368 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:337 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:37:10,371 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:37:10,378 - [DEBUG] - deal_processor.py:DealProcessor.process_items:74 - Process records using Bitrix batch API with batch import
2024-12-27 20:37:11,278 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:37:11,617 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:37:11,628 - [DEBUG] - deal_processor.py:DealProcessor.process_items:86 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:37:11,703 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:37:11,708 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 20:37:11,712 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:38:17,632 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 20:38:20,835 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "36h 42m 20s",
   "current_page": {
      "page": 1,
      "duration": "70.46s",
      "items_per_second": "7.10",
      "processed": 500,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:20,838 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:38:21,117 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 2.79,
  "processing_time": "0:01:10.458718",
  "average_speed": 7.1,
  "remaining_items": 17395,
  "estimated_time": "34h 17m 24s",
  "status": "completed"
}
2024-12-27 20:38:21,123 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:38:21,126 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:38:21,131 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:38:21,134 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:38:21,137 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:38:21,726 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:21,732 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:22,613 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:38:23,505 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:38:25,639 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:25,828 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:25,832 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "1h 35m 12s",
   "current_page": {
      "page": 1,
      "duration": "4.10s",
      "items_per_second": "12.19",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:26,838 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 20:38:26,842 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:38:27,447 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:27,453 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:28,295 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:28,524 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:28,529 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "5h 12m 25s",
   "current_page": {
      "page": 2,
      "duration": "1.08s",
      "items_per_second": "46.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:29,535 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 20:38:29,539 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:38:30,099 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:30,103 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:30,962 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:31,198 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:31,202 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "4h 28m 23s",
   "current_page": {
      "page": 3,
      "duration": "1.10s",
      "items_per_second": "45.51",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:32,207 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 20:38:32,211 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:38:32,874 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:32,878 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:33,676 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:33,925 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:33,929 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "4h 0m 10s",
   "current_page": {
      "page": 4,
      "duration": "1.05s",
      "items_per_second": "47.53",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:34,936 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 20:38:34,939 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:38:35,530 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:35,534 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:36,342 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:36,544 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:36,547 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "3h 27m 32s",
   "current_page": {
      "page": 5,
      "duration": "1.01s",
      "items_per_second": "49.31",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:37,553 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 20:38:37,556 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:38:38,131 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:38,134 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:38,943 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:38:40,635 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-27 20:38:43,768 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:43,976 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:43,980 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "30m 10s",
   "current_page": {
      "page": 6,
      "duration": "5.85s",
      "items_per_second": "8.55",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:38:44,986 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 20:38:44,989 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:38:45,531 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:38:45,534 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:38:46,506 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:38:50,517 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:38:59,179 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:38:59,382 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:38:59,386 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "10m 16s",
   "current_page": {
      "page": 7,
      "duration": "13.85s",
      "items_per_second": "3.61",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:00,391 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 20:39:00,395 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:39:01,074 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:39:01,077 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:01,902 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:39:03,073 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:39:06,700 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:06,941 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:06,946 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "15m 2s",
   "current_page": {
      "page": 8,
      "duration": "5.87s",
      "items_per_second": "8.52",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:07,953 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 20:39:07,956 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:39:09,189 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:39:09,194 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:09,990 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:39:10,826 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:39:13,493 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:13,761 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:13,765 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "9m 31s",
   "current_page": {
      "page": 9,
      "duration": "4.57s",
      "items_per_second": "10.93",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:14,770 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 20:39:14,774 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:39:15,428 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:39:15,432 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:16,222 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:39:18,629 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-27 20:39:24,048 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:24,272 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:24,275 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "8.84s",
      "items_per_second": "5.65",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:24,278 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:39:24,284 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:01:02.541183",
  "average_speed": 7.99,
  "remaining_items": 0,
  "estimated_time": "3s",
  "status": "in_progress"
}
2024-12-27 20:39:24,289 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 20:39:24,292 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 20:39:24,296 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:39:24,299 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 20:39:24,302 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:39:24,727 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:24,734 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:24,736 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:24,741 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:26,037 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:26,244 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:26,248 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "4h 11m 31s",
   "current_page": {
      "page": 1,
      "duration": "1.51s",
      "items_per_second": "33.04",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:27,255 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 20:39:27,258 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:39:27,919 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:27,923 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:27,924 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:27,926 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:27,937 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:28,159 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:28,164 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "23h 5m 6s",
   "current_page": {
      "page": 2,
      "duration": "0.24s",
      "items_per_second": "207.25",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:29,170 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 20:39:29,173 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:39:29,701 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:29,704 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:29,706 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:29,708 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:29,713 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:29,980 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:29,983 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "17h 27m 27s",
   "current_page": {
      "page": 3,
      "duration": "0.28s",
      "items_per_second": "179.05",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:30,988 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 20:39:30,991 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:39:31,450 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:31,453 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:31,455 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:31,457 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:31,462 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:31,628 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:31,631 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "23h 23m 24s",
   "current_page": {
      "page": 4,
      "duration": "0.18s",
      "items_per_second": "280.15",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:32,636 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 20:39:32,640 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:39:33,109 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:33,114 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:33,120 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:33,121 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:33,126 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:33,371 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:33,376 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "13h 16m 25s",
   "current_page": {
      "page": 5,
      "duration": "0.26s",
      "items_per_second": "190.63",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:34,381 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 20:39:34,384 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:39:34,816 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:34,819 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:34,820 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:34,822 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:34,825 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:35,025 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:35,029 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "13h 18m 13s",
   "current_page": {
      "page": 6,
      "duration": "0.21s",
      "items_per_second": "238.94",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:36,035 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 20:39:36,038 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:39:36,469 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:36,475 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:36,477 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:36,483 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:37,542 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:37,731 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:37,735 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "1h 40m 17s",
   "current_page": {
      "page": 7,
      "duration": "1.26s",
      "items_per_second": "39.62",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:38,742 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 20:39:38,744 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:39:39,228 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:39,237 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:39,238 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:39,253 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:40,650 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:40,816 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:40,819 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "53m 18s",
   "current_page": {
      "page": 8,
      "duration": "1.59s",
      "items_per_second": "31.49",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:41,824 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 20:39:41,828 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:39:42,517 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:42,520 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:42,522 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:42,532 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:47,168 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:47,361 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:47,363 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "9m 1s",
   "current_page": {
      "page": 9,
      "duration": "4.84s",
      "items_per_second": "10.32",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:48,367 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 20:39:48,370 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:39:48,894 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:39:48,897 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:39:48,899 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:39:48,906 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:39:50,683 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:39:50,937 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:39:50,941 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "2.04s",
      "items_per_second": "24.47",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:39:50,945 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:39:50,951 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:26.204294",
  "average_speed": 19.08,
  "remaining_items": 0,
  "estimated_time": "9s",
  "status": "in_progress"
}
2024-12-27 20:39:50,956 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 20:39:50,960 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:02:59.412803
2024-12-27 20:39:50,964 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:44:03,740 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:44:03,743 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:44:03,764 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:44:03,767 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:44:10,690 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:44:10,812 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:44:12,399 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:44:12,406 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:44:12,410 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:44:12,412 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:44:12,415 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:44:13,853 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:44:13,857 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:44:13,859 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:44:13,861 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:44:13,863 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:44:15,584 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:44:16,739 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:44:16,962 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:44:18,468 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:44:18,528 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:44:18,535 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:44:18,538 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:44:18,540 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:44:19,985 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:44:19,990 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:44:20,015 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:44:20,027 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:44:20,038 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:44:32,780 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:44:32,786 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:44:32,789 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:44:32,797 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:44:32,800 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:238 - Fetching records with current page 1
2024-12-27 20:44:32,803 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:284 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:44:32,806 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:44:32,810 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 20:44:32,812 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:44:51,334 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:337 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:44:51,337 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:44:51,344 - [DEBUG] - deal_processor.py:DealProcessor.process_items:74 - Process records using Bitrix batch API with batch import
2024-12-27 20:44:52,615 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:44:53,354 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:44:53,362 - [DEBUG] - deal_processor.py:DealProcessor.process_items:86 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:44:53,430 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:44:53,434 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 20:44:53,437 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:46:06,866 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 20:46:10,749 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "32h 50m 31s",
   "current_page": {
      "page": 1,
      "duration": "79.40s",
      "items_per_second": "6.30",
      "processed": 500,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:10,752 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:46:11,012 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 2.79,
  "processing_time": "0:01:19.406413",
  "average_speed": 6.3,
  "remaining_items": 17395,
  "estimated_time": "30h 25m 34s",
  "status": "completed"
}
2024-12-27 20:46:11,017 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:46:11,020 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:46:11,024 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:46:11,026 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:46:11,030 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:46:11,692 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:11,700 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:12,493 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:46:13,388 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:46:16,295 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:16,500 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:16,504 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "1h 21m 48s",
   "current_page": {
      "page": 1,
      "duration": "4.80s",
      "items_per_second": "10.41",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:17,510 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 20:46:17,513 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:46:18,103 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:18,107 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:18,903 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:19,098 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:19,103 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "5h 38m 5s",
   "current_page": {
      "page": 2,
      "duration": "1.00s",
      "items_per_second": "50.21",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:20,109 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 20:46:20,114 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:46:20,715 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:20,719 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:21,800 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:21,974 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:21,978 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "3h 54m 35s",
   "current_page": {
      "page": 3,
      "duration": "1.26s",
      "items_per_second": "39.71",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:22,985 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 20:46:22,990 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:46:23,604 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:23,607 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:24,570 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:24,771 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:24,775 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "3h 36m 35s",
   "current_page": {
      "page": 4,
      "duration": "1.17s",
      "items_per_second": "42.82",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:25,784 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 20:46:25,788 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:46:26,573 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:26,576 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:27,224 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:27,423 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:27,427 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "4h 7m 6s",
   "current_page": {
      "page": 5,
      "duration": "0.85s",
      "items_per_second": "58.81",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:28,432 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 20:46:28,436 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:46:29,087 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:29,091 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:29,899 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:46:32,161 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-27 20:46:34,641 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:34,835 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:34,839 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "30m 39s",
   "current_page": {
      "page": 6,
      "duration": "5.75s",
      "items_per_second": "8.70",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:35,845 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 20:46:35,849 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:46:36,461 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:36,466 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:37,251 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:46:41,955 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:46:50,111 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:50,355 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:50,359 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "10m 14s",
   "current_page": {
      "page": 7,
      "duration": "13.89s",
      "items_per_second": "3.60",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:51,365 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 20:46:51,368 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:46:51,971 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:51,974 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:52,762 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:46:53,640 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:46:56,826 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:46:57,056 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:46:57,069 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "17m 11s",
   "current_page": {
      "page": 8,
      "duration": "5.09s",
      "items_per_second": "9.82",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:46:58,081 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 20:46:58,084 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:46:58,720 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:46:58,724 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:46:59,565 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:47:00,569 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:47:03,548 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:03,766 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:03,770 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "8m 40s",
   "current_page": {
      "page": 9,
      "duration": "5.05s",
      "items_per_second": "9.91",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:04,776 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 20:47:04,779 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:47:05,422 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:47:05,426 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:06,222 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:47:08,417 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-27 20:47:13,729 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:13,943 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:13,950 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "8.52s",
      "items_per_second": "5.87",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:13,955 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:47:13,962 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:01:02.244952",
  "average_speed": 8.03,
  "remaining_items": 0,
  "estimated_time": "4s",
  "status": "in_progress"
}
2024-12-27 20:47:13,968 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 20:47:13,971 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 20:47:13,976 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:47:13,980 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 20:47:13,984 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:47:14,420 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:14,426 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:14,428 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:14,431 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:15,369 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:15,583 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:15,586 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "5h 26m 45s",
   "current_page": {
      "page": 1,
      "duration": "1.16s",
      "items_per_second": "43.07",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:16,592 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 20:47:16,601 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:47:17,055 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:17,058 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:17,060 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:17,062 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:17,070 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:17,252 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:17,256 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "28h 5m 26s",
   "current_page": {
      "page": 2,
      "duration": "0.20s",
      "items_per_second": "252.29",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:18,261 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 20:47:18,264 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:47:18,699 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:18,702 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:18,704 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:18,706 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:18,711 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:18,942 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:18,950 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "19h 59m 43s",
   "current_page": {
      "page": 3,
      "duration": "0.24s",
      "items_per_second": "205.15",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:19,957 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 20:47:19,961 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:47:20,422 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:20,425 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:20,427 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:20,429 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:20,434 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:20,652 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:20,656 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "18h 5m 34s",
   "current_page": {
      "page": 4,
      "duration": "0.23s",
      "items_per_second": "216.59",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:21,662 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 20:47:21,665 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:47:22,216 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:22,219 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:22,221 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:22,223 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:22,227 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:22,400 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:22,404 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "18h 52m 33s",
   "current_page": {
      "page": 5,
      "duration": "0.18s",
      "items_per_second": "271.29",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:23,411 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 20:47:23,418 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:47:23,848 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:23,851 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:23,853 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:23,855 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:23,860 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:24,085 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:24,089 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "11h 43m 5s",
   "current_page": {
      "page": 6,
      "duration": "0.24s",
      "items_per_second": "210.41",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:25,096 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 20:47:25,101 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:47:25,597 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:25,604 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:25,607 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:25,616 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:26,553 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:26,744 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:26,748 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "1h 50m 12s",
   "current_page": {
      "page": 7,
      "duration": "1.15s",
      "items_per_second": "43.59",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:27,752 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 20:47:27,756 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:47:28,237 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:28,240 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:28,242 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:28,248 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:29,637 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:29,821 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:29,825 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "53m 23s",
   "current_page": {
      "page": 8,
      "duration": "1.59s",
      "items_per_second": "31.54",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:30,831 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 20:47:30,837 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:47:31,304 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:31,308 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:31,312 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:31,327 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:35,528 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:35,726 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:35,729 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "9m 50s",
   "current_page": {
      "page": 9,
      "duration": "4.42s",
      "items_per_second": "11.31",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:36,735 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 20:47:36,741 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:47:37,263 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:47:37,267 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:47:37,270 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:47:37,277 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:47:38,911 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:47:39,107 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:47:39,111 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "1.84s",
      "items_per_second": "27.12",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:47:39,115 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:47:39,121 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:24.682203",
  "average_speed": 20.26,
  "remaining_items": 0,
  "estimated_time": "10s",
  "status": "in_progress"
}
2024-12-27 20:47:39,127 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 20:47:39,130 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:03:06.340937
2024-12-27 20:47:39,134 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:49:48,204 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:49:49,388 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:49:49,620 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:49:51,188 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:49:51,240 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:49:51,249 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:49:51,252 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:49:51,255 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:49:52,644 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:49:52,647 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:49:52,651 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:49:52,654 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:49:52,657 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:49:55,470 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:49:55,473 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:49:55,500 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:49:55,503 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:50:00,831 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:50:00,947 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:50:03,195 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:50:03,210 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:50:03,215 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:50:03,218 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:50:03,223 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:50:04,873 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:50:04,877 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:50:04,880 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:50:04,883 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:50:04,886 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:50:13,228 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:50:13,236 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:50:13,239 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:50:13,254 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:50:13,263 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:238 - Fetching records with current page 1
2024-12-27 20:50:13,270 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:284 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:50:13,275 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:50:13,280 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 20:50:13,284 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:50:30,570 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:337 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:50:30,573 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:50:30,581 - [DEBUG] - deal_processor.py:DealProcessor.process_items:74 - Process records using Bitrix batch API with batch import
2024-12-27 20:50:31,675 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:50:32,246 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:50:32,254 - [DEBUG] - deal_processor.py:DealProcessor.process_items:86 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:50:32,351 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:50:32,358 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 20:50:32,361 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:51:47,208 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 20:51:50,574 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "32h 37m 3s",
   "current_page": {
      "page": 1,
      "duration": "79.99s",
      "items_per_second": "6.25",
      "processed": 500,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:51:50,577 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:51:50,838 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 2.79,
  "processing_time": "0:01:19.995819",
  "average_speed": 6.25,
  "remaining_items": 17395,
  "estimated_time": "30h 12m 7s",
  "status": "completed"
}
2024-12-27 20:51:50,843 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:51:50,845 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:51:50,851 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:51:50,854 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:51:50,856 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:51:51,537 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:51:51,545 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:51:52,364 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:51:53,516 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:51:55,469 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:51:55,690 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:51:55,693 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "1h 34m 5s",
   "current_page": {
      "page": 1,
      "duration": "4.15s",
      "items_per_second": "12.05",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:51:56,697 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 20:51:56,700 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:51:57,303 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:51:57,307 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:51:58,058 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:51:58,290 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:51:58,295 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "5h 40m 40s",
   "current_page": {
      "page": 2,
      "duration": "0.99s",
      "items_per_second": "50.60",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:51:59,299 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 20:51:59,303 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:51:59,905 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:51:59,908 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:01,717 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:01,972 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:01,977 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "2h 23m 56s",
   "current_page": {
      "page": 3,
      "duration": "2.07s",
      "items_per_second": "24.18",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:02,984 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 20:52:02,998 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:52:03,699 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:03,705 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:04,553 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:52:05,137 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 1/1
2024-12-27 20:52:06,521 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:06,809 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:06,818 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "1h 22m 51s",
   "current_page": {
      "page": 4,
      "duration": "3.11s",
      "items_per_second": "16.07",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:07,828 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 20:52:07,834 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:52:08,455 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:08,467 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:09,256 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:52:10,787 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 4/4
2024-12-27 20:52:13,031 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:13,292 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:13,295 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "45m 9s",
   "current_page": {
      "page": 5,
      "duration": "4.84s",
      "items_per_second": "10.34",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:14,300 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 20:52:14,303 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:52:15,116 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:15,118 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:15,688 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:15,967 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:15,970 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "3h 17m 22s",
   "current_page": {
      "page": 6,
      "duration": "0.85s",
      "items_per_second": "58.71",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:16,976 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 20:52:16,979 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:52:17,563 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:17,567 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:18,415 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:52:23,593 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:52:31,941 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:32,182 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:32,185 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "9m 48s",
   "current_page": {
      "page": 7,
      "duration": "14.62s",
      "items_per_second": "3.42",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:33,190 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 20:52:33,192 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:52:33,788 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:33,791 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:34,570 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:52:35,154 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 1/1
2024-12-27 20:52:36,839 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:37,025 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:37,028 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "26m 34s",
   "current_page": {
      "page": 8,
      "duration": "3.24s",
      "items_per_second": "15.44",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:38,033 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 20:52:38,038 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:52:38,653 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:38,657 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:39,430 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:52:40,994 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:52:44,567 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:52:44,830 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:52:44,835 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "7m 9s",
   "current_page": {
      "page": 9,
      "duration": "6.18s",
      "items_per_second": "8.09",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:52:45,847 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 20:52:45,852 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:52:46,477 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:52:46,479 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:52:47,406 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:52:52,843 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:52:52,954 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:52:54,357 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:52:54,365 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:52:54,368 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:52:54,370 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:52:54,373 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:52:55,796 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:52:55,799 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:52:55,801 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:52:55,803 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:52:55,805 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:53:33,848 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-27 20:53:33,850 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-27 20:53:33,867 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-27 20:53:33,870 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-27 20:53:39,467 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-27 20:53:39,580 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-27 20:53:41,133 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:53:41,141 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:53:41,144 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:53:41,146 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:53:41,150 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:53:42,631 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:53:42,634 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:53:42,636 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:53:42,638 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-27 20:53:42,641 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-27 20:53:43,695 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:53:44,868 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:53:45,083 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:53:46,704 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:53:46,750 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:53:46,759 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:53:46,761 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:53:46,763 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:53:48,094 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:53:48,098 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:53:48,101 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:53:48,106 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:53:48,112 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:53:54,792 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-27 20:53:55,933 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-27 20:53:56,141 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-27 20:53:57,585 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-27 20:53:57,628 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-27 20:53:57,633 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-27 20:53:57,635 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-27 20:53:57,639 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-27 20:53:59,035 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-27 20:53:59,040 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-27 20:53:59,042 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-27 20:53:59,044 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-27 20:53:59,046 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-27 20:54:03,025 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-27 20:54:03,042 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-27 20:54:03,044 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-27 20:54:03,052 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-27 20:54:03,058 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:238 - Fetching records with current page 1
2024-12-27 20:54:03,060 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:284 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-27 20:54:03,064 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:54:03,070 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-27 20:54:03,073 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:54:19,778 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:337 - Find out: 500 - next: True - offset_target: 17850
2024-12-27 20:54:19,781 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-27 20:54:19,787 - [DEBUG] - deal_processor.py:DealProcessor.process_items:74 - Process records using Bitrix batch API with batch import
2024-12-27 20:54:21,124 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=83b56e6700747fcb004064a00000011a403807c1428aa4ea72cbd4719667e95429b805&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-27 20:54:21,663 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-27 20:54:21,667 - [DEBUG] - deal_processor.py:DealProcessor.process_items:86 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-27 20:54:21,749 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-27 20:54:21,760 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-27 20:54:21,764 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-27 20:55:31,368 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-27 20:55:34,506 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "34h 45m 4s",
   "current_page": {
      "page": 1,
      "duration": "74.72s",
      "items_per_second": "6.69",
      "processed": 500,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:34,509 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:55:34,800 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 2.79,
  "processing_time": "0:01:14.717449",
  "average_speed": 6.69,
  "remaining_items": 17395,
  "estimated_time": "32h 20m 8s",
  "status": "completed"
}
2024-12-27 20:55:34,806 - [INFO] - bitrix_migration.py:BitrixMigration.run:344 - Completed deal migration
2024-12-27 20:55:34,809 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting comment migration...
2024-12-27 20:55:34,814 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:55:34,817 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-27 20:55:34,821 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:55:36,007 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:55:36,014 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:55:36,832 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:55:38,349 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:55:41,048 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:55:41,301 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:55:41,307 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "1h 14m 36s",
   "current_page": {
      "page": 1,
      "duration": "5.29s",
      "items_per_second": "9.45",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:42,313 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-27 20:55:42,316 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:55:42,860 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:55:42,863 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:55:43,827 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:55:44,030 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:55:44,035 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "4h 47m 58s",
   "current_page": {
      "page": 2,
      "duration": "1.17s",
      "items_per_second": "42.69",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:45,041 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-27 20:55:45,050 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:55:45,657 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:55:45,660 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:55:46,541 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:55:46,743 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:55:46,746 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "4h 31m 24s",
   "current_page": {
      "page": 3,
      "duration": "1.09s",
      "items_per_second": "46.03",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:47,753 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-27 20:55:47,756 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:55:48,481 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:55:48,485 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:55:49,361 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:55:49,571 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:55:49,575 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "3h 51m 51s",
   "current_page": {
      "page": 4,
      "duration": "1.09s",
      "items_per_second": "45.87",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:50,580 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-27 20:55:50,584 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:55:51,133 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:55:51,136 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:55:51,949 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:55:52,128 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:55:52,132 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "3h 31m 17s",
   "current_page": {
      "page": 5,
      "duration": "1.00s",
      "items_per_second": "50.21",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:53,137 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-27 20:55:53,141 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:55:53,688 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:55:53,691 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:55:54,488 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:55:55,991 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-27 20:55:58,666 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:55:58,880 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:55:58,884 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "33m 46s",
   "current_page": {
      "page": 6,
      "duration": "5.19s",
      "items_per_second": "9.63",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:55:59,890 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-27 20:55:59,894 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:56:00,517 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:56:00,520 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:01,294 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:56:06,095 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-27 20:56:16,179 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:16,402 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:16,406 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "9m 7s",
   "current_page": {
      "page": 7,
      "duration": "15.89s",
      "items_per_second": "3.15",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:17,413 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-27 20:56:17,416 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:56:18,259 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:56:18,263 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:19,057 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:56:19,981 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:56:22,919 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:23,142 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:23,145 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "17m 54s",
   "current_page": {
      "page": 8,
      "duration": "4.88s",
      "items_per_second": "10.24",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:24,152 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-27 20:56:24,156 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:56:24,730 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:56:24,734 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:25,522 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:56:26,326 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-27 20:56:28,998 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:29,187 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:29,190 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "9m 45s",
   "current_page": {
      "page": 9,
      "duration": "4.46s",
      "items_per_second": "11.22",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:30,197 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-27 20:56:30,202 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:56:30,779 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-27 20:56:30,782 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:31,575 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-27 20:56:33,666 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-27 20:56:38,711 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:38,970 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:38,976 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "8.19s",
      "items_per_second": "6.10",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:38,981 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:56:38,987 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:01:02.947781",
  "average_speed": 7.94,
  "remaining_items": 0,
  "estimated_time": "3s",
  "status": "in_progress"
}
2024-12-27 20:56:38,994 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed comment migration
2024-12-27 20:56:38,997 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Starting task migration...
2024-12-27 20:56:39,001 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-27 20:56:39,004 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-27 20:56:39,008 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-27 20:56:39,478 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:39,484 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:39,486 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:39,493 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:40,343 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:40,548 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:40,552 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "5h 55m",
   "current_page": {
      "page": 1,
      "duration": "1.07s",
      "items_per_second": "46.83",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:41,556 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-27 20:56:41,565 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-27 20:56:42,066 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:42,069 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:42,071 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:42,073 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:42,081 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:42,253 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:42,258 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "29h 25m 20s",
   "current_page": {
      "page": 2,
      "duration": "0.19s",
      "items_per_second": "264.27",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:43,264 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-27 20:56:43,269 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-27 20:56:43,689 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:43,693 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:43,694 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:43,696 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:43,701 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:43,902 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:43,906 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "22h 52m",
   "current_page": {
      "page": 3,
      "duration": "0.21s",
      "items_per_second": "234.68",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:44,912 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-27 20:56:44,916 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-27 20:56:45,355 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:45,358 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:45,360 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:45,361 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:45,366 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:45,563 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:45,572 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "19h 55m 39s",
   "current_page": {
      "page": 4,
      "duration": "0.21s",
      "items_per_second": "238.61",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:46,580 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-27 20:56:46,584 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-27 20:56:46,976 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:46,979 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:46,981 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:46,983 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:46,987 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:47,217 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:47,220 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "14h 26m 34s",
   "current_page": {
      "page": 5,
      "duration": "0.24s",
      "items_per_second": "207.46",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:48,226 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-27 20:56:48,229 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-27 20:56:48,647 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:48,652 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:48,654 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:48,656 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:48,662 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:48,866 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:48,870 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "12h 41m 27s",
   "current_page": {
      "page": 6,
      "duration": "0.22s",
      "items_per_second": "227.92",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:49,877 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-27 20:56:49,880 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-27 20:56:50,293 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:50,296 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:50,299 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:50,304 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:51,141 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:51,346 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:51,353 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "1h 59m 47s",
   "current_page": {
      "page": 7,
      "duration": "1.05s",
      "items_per_second": "47.42",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:52,365 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-27 20:56:52,368 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-27 20:56:52,908 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:52,912 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:52,913 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:52,919 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:54,255 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:54,457 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:54,461 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "54m 36s",
   "current_page": {
      "page": 8,
      "duration": "1.55s",
      "items_per_second": "32.26",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:56:55,466 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-27 20:56:55,470 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-27 20:56:55,966 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:56:55,971 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:56:55,973 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:56:55,984 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:56:59,748 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:56:59,928 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:56:59,932 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "10m 56s",
   "current_page": {
      "page": 9,
      "duration": "3.96s",
      "items_per_second": "12.62",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:57:00,936 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-27 20:57:00,938 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-27 20:57:01,406 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-27 20:57:01,409 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-27 20:57:01,411 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-27 20:57:01,418 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-27 20:57:04,252 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-27 20:57:04,483 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-27 20:57:04,492 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "3.08s",
      "items_per_second": "16.24",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-27 20:57:04,495 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-27 20:57:04,504 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:25.000322",
  "average_speed": 20.0,
  "remaining_items": 0,
  "estimated_time": "9s",
  "status": "in_progress"
}
2024-12-27 20:57:04,509 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Completed task migration
2024-12-27 20:57:04,513 - [WARNING] - bitrix_migration.py:BitrixMigration.run:360 - DEBUG MODE migration completed in 0:03:01.467473
2024-12-27 20:57:04,516 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-28 10:55:14,771 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 10:55:14,775 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:379 - Bitrix migration cleanup completed
2024-12-28 10:55:14,778 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 10:55:14,781 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 10:55:20,767 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 10:55:20,897 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 10:55:22,417 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 10:55:22,425 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 10:55:22,429 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 10:55:22,432 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 10:55:22,436 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 10:55:23,927 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 10:55:23,930 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 10:55:23,933 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 10:55:23,936 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 10:55:23,939 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 10:58:41,758 - [INFO] - manager.py:reset_state:123 - Job manager state reset successfully
2024-12-28 10:58:42,977 - [INFO] - database.py:Database.drop_database:167 - Successfully dropped database: migration_mOA2NMN
2024-12-28 10:58:43,220 - [INFO] - database.py:Database.create_database:34 - Database migration_mOA2NMN created successfully
2024-12-28 10:58:44,773 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 10:58:44,837 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 10:58:44,848 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 10:58:44,851 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 10:58:44,853 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 10:58:46,368 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 10:58:46,371 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 10:58:46,375 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 10:58:46,378 - [INFO] - bitrix.py:reset_app:58 - Services reinitialized successfully
2024-12-28 10:58:46,381 - [INFO] - bitrix.py:reset_app:66 - Application reset completed successfully
2024-12-28 10:59:39,093 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 10:59:39,104 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 10:59:39,121 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 10:59:39,137 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': True, 'data': {}}
2024-12-28 10:59:39,141 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:252 - Fetching records with current page 1
2024-12-28 10:59:39,145 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:298 - current_page: 1 - offset: 0 | pages: 10 size: 50
2024-12-28 10:59:39,149 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 10:59:39,158 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-28 10:59:40,086 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 10:59:54,951 - [DEBUG] - bitrix_api.py:BitrixAPI.get_batch_list:351 - Find out: 500 - next: True - offset_target: 17850
2024-12-28 10:59:54,954 - [INFO] - base_processor.py:DealProcessor._get_and_validate_items:559 - Found 500 items to process for DealProcessor
2024-12-28 10:59:54,961 - [DEBUG] - deal_processor.py:DealProcessor.process_items:72 - Process records using Bitrix batch API with batch import
2024-12-28 10:59:55,945 - [DEBUG] - downloader.py:Downloader.download_url_batch:159 - Starting batch download: {'0': {'UF_CRM_1735295485572': 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=bb856f6700747fcb004064a00000011a4038078805da01fe3c36fdb29874aa047e52f6&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'UF_CRM_1735295505464': ['https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=bb856f6700747fcb004064a00000011a4038078805da01fe3c36fdb29874aa047e52f6&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'https://eqvn.bitrix24.com/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=bb856f6700747fcb004064a00000011a4038078805da01fe3c36fdb29874aa047e52f6&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594']}}
2024-12-28 10:59:56,714 - [DEBUG] - downloader.py:Downloader.download_url_batch:292 - Batch download completed. Success: 3/3
2024-12-28 10:59:56,719 - [DEBUG] - deal_processor.py:DealProcessor.process_items:84 - record[0]: {'ID': '10', 'TITLE': 'Bé nam', 'TYPE_ID': 'SALE', 'STAGE_ID': 'UC_QU5HAP', 'PROBABILITY': '70', 'CURRENCY_ID': 'USD', 'OPPORTUNITY': '439000.00', 'IS_MANUAL_OPPORTUNITY': 'N', 'TAX_VALUE': '0.00', 'LEAD_ID': '24', 'COMPANY_ID': '0', 'CONTACT_ID': None, 'QUOTE_ID': None, 'BEGINDATE': '2019-10-07T03:00:00+03:00', 'CLOSEDATE': '2022-04-13T03:00:00+03:00', 'ASSIGNED_BY_ID': '282', 'CREATED_BY_ID': '1', 'MODIFY_BY_ID': '282', 'DATE_CREATE': '2019-10-07T07:16:22+03:00', 'DATE_MODIFY': '2024-12-27T13:25:19+03:00', 'OPENED': 'Y', 'CLOSED': 'N', 'COMMENTS': 'Đơn hàng tự động tạo từ đơn Shopee 230628J9WS0FR5, người mua benam1234', 'ADDITIONAL_INFO': None, 'LOCATION_ID': None, 'CATEGORY_ID': '0', 'STAGE_SEMANTIC_ID': 'P', 'IS_NEW': 'N', 'IS_RECURRING': 'N', 'IS_RETURN_CUSTOMER': 'N', 'IS_REPEATED_APPROACH': 'N', 'SOURCE_ID': 'WEB', 'SOURCE_DESCRIPTION': 'Elmich Việt Nam Chính Hãng(shopee)', 'ORIGINATOR_ID': None, 'ORIGIN_ID': None, 'MOVED_BY_ID': '282', 'MOVED_TIME': '2021-09-01T11:30:44+03:00', 'LAST_ACTIVITY_TIME': '2019-10-07T07:16:22+03:00', 'UTM_SOURCE': None, 'UTM_MEDIUM': None, 'UTM_CAMPAIGN': None, 'UTM_CONTENT': None, 'UTM_TERM': None, 'PARENT_ID_130': None, 'PARENT_ID_131': None, 'PARENT_ID_132': None, 'PARENT_ID_133': None, 'PARENT_ID_140': None, 'PARENT_ID_142': None, 'PARENT_ID_145': None, 'PARENT_ID_147': None, 'PARENT_ID_148': None, 'PARENT_ID_149': None, 'PARENT_ID_159': None, 'PARENT_ID_169': None, 'PARENT_ID_177': None, 'PARENT_ID_183': None, 'PARENT_ID_185': None, 'PARENT_ID_188': None, 'PARENT_ID_190': None, 'PARENT_ID_191': None, 'PARENT_ID_1068': None, 'PARENT_ID_1084': None, 'PARENT_ID_1104': None, 'PARENT_ID_1112': None, 'PARENT_ID_1120': None, 'PARENT_ID_1126': None, 'PARENT_ID_1130': None, 'LAST_ACTIVITY_BY': '1', 'UF_CRM_6551DF6620BE5': False, 'UF_CRM_6551DF6655067': None, 'UF_CRM_6551DF666D52A': None, 'UF_CRM_1628824504680': '', 'UF_CRM_1628824537109': '', 'UF_CRM_1628824824373': None, 'UF_CRM_1628824985423': None, 'UF_CRM_1628825413905': '', 'UF_CRM_1628825425637': None, 'UF_CRM_1629087442': '', 'UF_CRM_EQ_LOCATION': None, 'UF_CRM_EQ_COUNTRY': None, 'UF_CRM_EQ_PROVINCE': None, 'UF_CRM_EQ_DISTRICT': None, 'UF_CRM_EQ_WARD': None, 'UF_CRM_1631690082': None, 'UF_CRM_1632884056': '', 'UF_CRM_1632884092': None, 'UF_CRM_1632884198': '', 'UF_CRM_1632884226': None, 'UF_CRM_1632885938': None, 'UF_CRM_1632885971': None, 'UF_CRM_6189F369501F9': False, 'UF_CRM_61CD283C52990': None, 'UF_CRM_61E8C26F9C613': None, 'UF_CRM_1643344309': None, 'UF_CRM_1647793827835': None, 'UF_CRM_1647793858380': '', 'UF_CRM_1647793917690': '', 'UF_CRM_1647794083867': None, 'UF_CRM_1647794138278': None, 'UF_CRM_1647837617': False, 'UF_CRM_1647853786887': None, 'UF_CRM_1647853884239': None, 'UF_CRM_1647919126232': None, 'UF_CRM_1647919149075': None, 'UF_CRM_1647919181359': None, 'UF_CRM_1647919199545': None, 'UF_CRM_1647919231454': None, 'UF_CRM_1647920712690': None, 'UF_CRM_1647922046753': None, 'UF_CRM_1648801237': None, 'UF_CRM_6282077ADBFC7': None, 'UF_CRM_1653540416041': None, 'UF_CRM_1653540718057': '', 'UF_CRM_1653967364556': None, 'UF_CRM_62AD50527CAE9': None, 'UF_CRM_62AD5052B2CD8': None, 'UF_CRM_1655891045159': None, 'UF_CRM_63048E7DA64BF': False, 'UF_CRM_1661332670309': None, 'UF_CRM_63199AC606E74': None, 'UF_CRM_63199AC6AC6F6': None, 'UF_CRM_1662744611696': None, 'UF_CRM_1662744691962': None, 'UF_CRM_1662744742165': None, 'UF_CRM_1663643803414': None, 'UF_CRM_GG_SHEET_ROW': None, 'UF_CRM_GG_SHEET_ID': None, 'UF_CRM_1664623405': None, 'UF_CRM_1666717851423': False, 'UF_CRM_1666926189386': False, 'UF_CRM_1666926839': False, 'UF_CRM_1667812703': None, 'UF_CRM_1669390196': None, 'UF_CRM_1669390223': None, 'UF_CRM_1669397881': False, 'UF_CRM_1669399262': False, 'UF_CRM_1669428168': None, 'UF_CRM_1669860665384': None, 'UF_CRM_63998752031B9': None, 'UF_CRM_639987527E8E8': None, 'UF_CRM_1675180607896': '', 'UF_CRM_1675180644660': '', 'UF_CRM_1675206536': None, 'UF_CRM_1675206788': None, 'UF_CRM_1675241481785': None, 'UF_CRM_1675852606': None, 'UF_CRM_1675904463878': '', 'UF_CRM_1675927630676': None, 'UF_CRM_1681117931965': None, 'UF_CRM_1681118203960': None, 'UF_CRM_1681118217706': None, 'UF_CRM_1681118447887': None, 'UF_CRM_1681118572230': None, 'UF_CRM_1681181839285': None, 'UF_CRM_1681182074': [], 'UF_CRM_1681183083': None, 'UF_CRM_1681183111': None, 'UF_CRM_1681184064': None, 'UF_CRM_1681185362': None, 'UF_CRM_1681808809432': '', 'UF_CRM_1681809251411': None, 'UF_CRM_64409BE8D2B32': None, 'UF_CRM_64409BE90DCD0': None, 'UF_CRM_1682042654564': '', 'UF_CRM_1682042666278': '', 'UF_CRM_1682408803805': None, 'UF_CRM_1682408835357': None, 'UF_CRM_1682408854386': None, 'UF_CRM_1682408871985': None, 'UF_CRM_DEAL_1682409847129': None, 'UF_CRM_DEAL_1682409894512': None, 'UF_CRM_1683510554966': '', 'UF_CRM_1683884055811': None, 'UF_CRM_1683886553460': None, 'UF_CRM_SI_BILLING_ADDRESS': None, 'UF_CRM_SI_SHIPPING_ADDRESS': 'E11 Nguyễn  Văn  Linh. Phú  Tài. Phan Thiết. Bình  Thuận, Phường Phú Tài, Thành Phố Phan Thiết, Bình Thuận', 'UF_CRM_1686105856': False, 'UF_CRM_1686107252': None, 'UF_CRM_SI_BRANCH_NAME': 'HN99-Kho TMĐT tại Ngọc Hồi', 'UF_CRM_SI_FACEBOOK_ID': None, 'UF_CRM_1686558487742': None, 'UF_CRM_1686643184': False, 'UF_CRM_NETSUITE_LOCATION': None, 'UF_CRM_NETSUITE_ASM': None, 'UF_CRM_NETSUITE_ASM_ID': None, 'UF_CRM_NETSUITE_TRACKING_URL': None, 'UF_CRM_NETSUITE_ORDER_TYPE': None, 'UF_CRM_GA_CID': None, 'UF_CRM_SI_LINKED_ITEM': None, 'UF_CRM_1687339983': '', 'UF_CRM_1687573520': None, 'UF_CRM_1687575719814': None, 'UF_CRM_1687575738913': None, 'UF_CRM_1687577000221': '', 'UF_CRM_1687577014143': '', 'UF_CRM_1687577046': None, 'UF_CRM_1687577476': None, 'UF_CRM_SI_ORDER_STATUS': 'Đang xử lý', 'UF_CRM_SI_DELIVERY_STATUS': 'Đang giao hàng', 'UF_CRM_SI_PAYMENT_METHOD': 'cod', 'UF_CRM_SI_PAYMENT_STATUS': None, 'UF_CRM_1687838297': None, 'UF_CRM_SI_EXTERNAL_ID': 'HDSPE_230628J9WS0FR5', 'UF_CRM_SI_SYSTEM': None, 'UF_CRM_SI_SALE_CHANNEL': None, 'UF_CRM_SI_TRANSACTIONS': None, 'UF_CRM_SI_TAGS': None, 'UF_CRM_SI_NOTE_ATTRIBUTES': None, 'UF_CRM_SI_COD_STATUS': None, 'UF_CRM_SI_TRACKING_URL': None, 'UF_CRM_SI_SALESMAN': None, 'UF_CRM_SI_DISCOUNT_CODES': None, 'UF_CRM_SI_DELIVERY_CHARGE': None, 'UF_CRM_SI_TOTAL_DISCOUNTS': None, 'UF_CRM_OMICALL_TICKET_CATEGORY': None, 'UF_CRM_OMICALL_TICKET_CATEGORY_TYPE': None, 'UF_CRM_HARAVAN_BILLING_ADDRESS': None, 'UF_CRM_HARAVAN_SHIPPING_ADDRESS': None, 'UF_CRM_HARAVAN_TRANSACTIONS': None, 'UF_CRM_HARAVAN_SHIPPING_LINES': None, 'UF_CRM_HARAVAN_GATEWAY': None, 'UF_CRM_HARAVAN_TAGS': None, 'UF_CRM_HARAVAN_FINANCIAL_STATUS': None, 'UF_CRM_HARAVAN_CARRIER_STATUS': None, 'UF_CRM_HARAVAN_COD_STATUS': None, 'UF_CRM_1690789528': None, 'UF_CRM_1691633351': '', 'UF_CRM_1691636227414': None, 'UF_CRM_NETSUITE_ITEM_ID': None, 'UF_CRM_NETSUITE_TRACKING_COMPANY': None, 'UF_CRM_NETSUITE_TRACKING_NUMBER': None, 'UF_CRM_NETSUITE_ORIGIN_SOURCE': None, 'UF_CRM_64DD855874102': None, 'UF_CRM_64DD8558967E5': False, 'UF_CRM_64DD8558B08A4': False, 'UF_CRM_64DD8558C9A21': None, 'UF_CRM_64DD8558DE4B5': None, 'UF_CRM_64DD855903254': None, 'UF_CRM_64DD855924C00': None, 'UF_CRM_64DD85593BF30': None, 'UF_CRM_64DD85595349F': None, 'UF_CRM_64DD85596AAF7': None, 'UF_CRM_64DD85598406B': None, 'UF_CRM_64DD855997B6A': None, 'UF_CRM_64DD8559AEF54': None, 'UF_CRM_64DD8559C5526': None, 'UF_CRM_64DD8559DFAF8': None, 'UF_CRM_64DD855A017AB': False, 'UF_CRM_64DD855A17408': None, 'UF_CRM_64DD855A2CF2D': None, 'UF_CRM_64DD855A4729E': '', 'UF_CRM_64DD855A6149F': None, 'UF_CRM_64DD85620B765': None, 'UF_CRM_1692610857883': None, 'UF_CRM_1695864949163': False, 'UF_CRM_1695865630924': None, 'UF_CRM_1695876200980': '', 'UF_CRM_1695960519572': None, 'UF_CRM_1695962191656': None, 'UF_CRM_65484D5C2FAC2': None, 'UF_CRM_1701225385909': None, 'UF_CRM_1701225454274': None, 'UF_CRM_1701225477523': '', 'UF_CRM_1701225501702': '', 'UF_CRM_1702537249832': None, 'UF_CRM_1702537301982': None, 'UF_CRM_1703235964293': '', 'UF_CRM_1703572656156': False, 'UF_CRM_1704251654055': False, 'UF_CRM_1704966626109': None, 'UF_CRM_1708509943566': None, 'UF_CRM_1708509957379': None, 'UF_CRM_1708509975363': None, 'UF_CRM_1708510304254': '', 'UF_CRM_1709606590651': None, 'UF_CRM_1709606602008': None, 'UF_CRM_1709609619010': [], 'UF_CRM_1709793176298': None, 'UF_CRM_1709794098508': '', 'UF_CRM_1709794180593': None, 'UF_CRM_1709794222536': None, 'UF_CRM_A_W_GROUP_ID': None, 'UF_CRM_A_T_GROUP_ID': None, 'UF_CRM_1711725508067': None, 'UF_CRM_1713344426208': '', 'UF_CRM_1713685581659': None, 'UF_CRM_1713685624988': None, 'UF_CRM_1715910311538': None, 'UF_CRM_1715910596192': None, 'UF_CRM_1717125961307': None, 'UF_CRM_1717316965821': None, 'UF_CRM_1719648301139': None, 'UF_CRM_1720078374797': None, 'UF_CRM_1720626779457': '', 'UF_CRM_1720632056653': '', 'UF_CRM_1720632074684': '', 'UF_CRM_1720632123': None, 'UF_CRM_1720656433827': None, 'UF_CRM_1720666355100': False, 'UF_CRM_1720666423733': None, 'UF_CRM_1720666627130': '', 'UF_CRM_668F4B3D3C6B6': None, 'UF_CRM_668F4B3D5D0B7': None, 'UF_CRM_668F4B3D7CC30': None, 'UF_CRM_668F4B3D98791': None, 'UF_CRM_668F4B3DB41BF': None, 'UF_CRM_668F4B3DD5532': None, 'UF_CRM_668F4B3EAE11F': None, 'UF_CRM_668F4B3EEDE73': None, 'UF_CRM_668F4B3F139B8': None, 'UF_CRM_1721800235243': '', 'UF_CRM_1721800266643': '', 'UF_CRM_1721800746986': {'id': 292588, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1721800746986&dynamic=Y&fileId=292588'}, 'UF_CRM_1721806669463': None, 'UF_CRM_1721806730279': None, 'UF_CRM_1721874947645': None, 'UF_CRM_1722327555404': '', 'UF_CRM_1722328083': None, 'UF_CRM_1722328119': None, 'UF_CRM_1722328334933': None, 'UF_CRM_1722328518516': [], 'UF_CRM_1722328777121': '', 'UF_CRM_1722330900842': None, 'UF_CRM_1722399546': None, 'UF_CRM_1722518727': None, 'UF_CRM_1722521515648': None, 'UF_CRM_1722521548960': None, 'UF_CRM_1722521586630': None, 'UF_CRM_1722521713145': None, 'UF_CRM_1722521757393': None, 'UF_CRM_1722560851536': None, 'UF_CRM_1722560871750': None, 'UF_CRM_1722563550': None, 'UF_CRM_1722571302165': None, 'UF_CRM_1722646463263': None, 'UF_CRM_1722660322': False, 'UF_CRM_1724689007': False, 'UF_CRM_1724689010': False, 'UF_CRM_REGION': None, 'UF_CRM_SUB_REGION': None, 'UF_CRM_COUNTRY': None, 'UF_CRM_CITY': None, 'UF_CRM_66FB7B35B2068': False, 'UF_CRM_66FB7B36F09DE': None, 'UF_CRM_66FB7B37C82BF': None, 'UF_CRM_1728871639': None, 'UF_CRM_1730965350': None, 'UF_CRM_1730965638260': None, 'UF_CRM_1731986726194': None, 'UF_CRM_1733907796620': None, 'UF_CRM_1734408996684': False, 'UF_CRM_1735295105441': [{'id': 292592, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292592'}, {'id': 292594, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1735295105441&dynamic=Y&fileId=292594'}], 'UF_CRM_1635406129894': None, 'UF_CRM_1635406141542': '', 'UF_CRM_1635406148202': '', 'UF_CRM_1635406160286': '', 'UF_CRM_1635406167496': '', 'UF_CRM_1635406174608': '', 'UF_CRM_1635406181409': '', 'UF_CRM_1635406069316': None, 'UF_CRM_1635406194512': None, 'UF_CRM_62F4730B42764': None, 'UF_CRM_1683778250611': '', 'UF_CRM_1684296872513': None, 'UF_CRM_1684297005099': None, 'UF_CRM_FULL_ADDRESS': None, 'UF_CRM_COMPANY_TITLE': None, 'UF_CRM_ADDRESS_COUNTRY': None, 'UF_CRM_BIRTHDATE': '', 'UF_CRM_ADDRESS_REGION': None, 'UF_CRM_WEB_FACEBOOK': None, 'UF_CRM_IM_FACEBOOK': None, 'UF_CRM_LINK_USER': None, 'UF_CRM_PHONE_MOBILE': None, 'UF_CRM_EMAIL_MAILING': None, 'UF_CRM_IM_OTHER': None, 'UF_CRM_EMAIL_OTHER': None, 'UF_CRM_PHONE_OTHER': None, 'UF_CRM_WEB_OTHER': None, 'UF_CRM_PHONE_PAGER': None, 'UF_CRM_WEB_HOME': None, 'UF_CRM_POST': None, 'UF_CRM_ADDRESS_PROVINCE': None, 'UF_CRM_PHONE_MAILING': None, 'UF_CRM_HONORIFIC': None, 'UF_CRM_IM_SKYPE': None, 'UF_CRM_STATUS_DESCRIPTION': None, 'UF_CRM_ADDRESS': None, 'UF_CRM_IM_TELEGRAM': None, 'UF_CRM_WEB_TWITTER': None, 'UF_CRM_WEB_VK': None, 'UF_CRM_IM_VK': None, 'UF_CRM_IM_VIBER': None, 'UF_CRM_EMAIL_WORK': None, 'UF_CRM_PHONE_WORK': None, 'UF_CRM_ADDRESS_POSTAL_CODE': None, 'UF_CRM_STATUS_ID': None, 'UF_CRM_LEAD_1682328963365': None, 'UF_CRM_1681096114587': False, 'UF_CRM_1681114643594': None, 'UF_CRM_LEAD_1670037817980': None, 'UF_CRM_1671005830436': {'id': 292590, 'showUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590', 'downloadUrl': '/bitrix/components/bitrix/crm.deal.show/show_file.php?auth=&ownerId=10&fieldName=UF_CRM_1671005830436&dynamic=Y&fileId=292590'}, 'UF_CRM_6346E507409CC': None, 'UF_CRM_1681114626348': None, 'UF_CRM_1628151696188': None, 'UF_CRM_1681095549529': None, 'UF_CRM_1574066960181': None, 'UF_CRM_EXTERNAL_ID': None, 'UF_CRM_64409BE7B07B0': None, 'UF_CRM_ORDER_ID': None, 'UF_CRM_ORIGIN_ID': None}
2024-12-28 10:59:56,803 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 10:59:56,807 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-28 10:59:57,701 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:00:46,246 - [DEBUG] - base_processor.py:DealProcessor.process:437 - _process_batch_items: done -> update data
2024-12-28 11:00:50,012 - [DEBUG] - base_processor.py:DealProcessor.process:513 - Background processed batch for DealProcessor: {
   "total_items": 17895,
   "total_processed": 500,
   "estimated_time": "46h 18m 6s",
   "current_page": {
      "page": 1,
      "duration": "55.05s",
      "items_per_second": "9.08",
      "processed": 500,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:00:50,015 - [DEBUG] - base_processor.py:DealProcessor.process:521 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:00:50,325 - [DEBUG] - base_processor.py:DealProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 17895,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 2.79,
  "processing_time": "0:00:55.052108",
  "average_speed": 9.08,
  "remaining_items": 17395,
  "estimated_time": "43h 53m 11s",
  "status": "completed"
}
2024-12-28 11:00:50,332 - [ERROR] - bitrix_migration.py:BitrixMigration.run:370 - Migration failed: 'DealProcessor' object has no attribute 'update_field_files'
2024-12-28 11:00:50,336 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:384 - Bitrix migration cleanup completed
2024-12-28 11:01:57,352 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:01:57,354 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:384 - Bitrix migration cleanup completed
2024-12-28 11:01:57,379 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:01:57,381 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:02:01,813 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:02:01,974 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:02:03,495 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:02:03,501 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:02:03,504 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:02:03,506 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:02:03,510 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:02:04,910 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:02:04,913 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:02:04,915 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:02:04,917 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:02:04,920 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:02:17,667 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:02:17,670 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:02:17,673 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:02:17,678 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:02:17,681 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:02:17,688 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:02:17,691 - [ERROR] - bitrix_api.py:BitrixAPI.update_field_files:148 - Error: 'BitrixAPI' object has no attribute 'entityTypeId'
2024-12-28 11:02:17,693 - [INFO] - bitrix_migration.py:BitrixMigration.run:349 - Completed deal migration
2024-12-28 11:02:17,696 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Starting comment migration...
2024-12-28 11:02:17,700 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-28 11:02:17,703 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 1
2024-12-28 11:02:17,706 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-28 11:02:17,712 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:02:17,715 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:02:17,718 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:02:18,324 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:18,330 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:19,139 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:02:20,008 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-28 11:02:20,016 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:02:20,022 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:02:20,027 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:02:22,139 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:22,381 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:22,389 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "1h 36m 13s",
   "current_page": {
      "page": 1,
      "duration": "4.06s",
      "items_per_second": "12.33",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:23,394 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 2
2024-12-28 11:02:23,397 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-28 11:02:24,062 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:24,067 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:24,630 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:24,871 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:24,874 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "6h 54m 59s",
   "current_page": {
      "page": 2,
      "duration": "0.81s",
      "items_per_second": "61.75",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:25,878 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 3
2024-12-28 11:02:25,880 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-28 11:02:26,447 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:26,449 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:27,086 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:27,243 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:27,246 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "6h 9m 7s",
   "current_page": {
      "page": 3,
      "duration": "0.80s",
      "items_per_second": "62.78",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:28,250 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 4
2024-12-28 11:02:28,253 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-28 11:02:28,813 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:28,817 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:29,461 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:29,653 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:29,656 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "5h 0m 10s",
   "current_page": {
      "page": 4,
      "duration": "0.84s",
      "items_per_second": "59.53",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:30,660 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 5
2024-12-28 11:02:30,662 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-28 11:02:31,200 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:31,202 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:31,721 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:31,911 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:31,915 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "4h 54m 46s",
   "current_page": {
      "page": 5,
      "duration": "0.71s",
      "items_per_second": "70.24",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:32,920 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 6
2024-12-28 11:02:32,923 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-28 11:02:33,476 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:33,478 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:34,285 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:02:35,955 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:02:39,049 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:39,247 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:39,249 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "30m 32s",
   "current_page": {
      "page": 6,
      "duration": "5.77s",
      "items_per_second": "8.66",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:40,254 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 7
2024-12-28 11:02:40,257 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-28 11:02:41,255 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:41,257 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:42,029 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:02:46,732 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 3/3
2024-12-28 11:02:55,187 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:02:55,397 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:02:55,400 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "10m 5s",
   "current_page": {
      "page": 7,
      "duration": "14.14s",
      "items_per_second": "3.54",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:02:56,404 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 8
2024-12-28 11:02:56,406 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-28 11:02:57,003 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:02:57,006 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:02:57,778 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:02:58,735 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-28 11:03:01,485 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:01,664 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:01,667 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "18m 42s",
   "current_page": {
      "page": 8,
      "duration": "4.66s",
      "items_per_second": "10.73",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:02,673 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 9
2024-12-28 11:03:02,676 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-28 11:03:03,241 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:03:03,243 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:04,022 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:03:04,855 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 2/2
2024-12-28 11:03:07,475 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:07,693 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:07,695 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "9m 46s",
   "current_page": {
      "page": 9,
      "duration": "4.45s",
      "items_per_second": "11.23",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:08,700 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:03:08,703 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:03:09,274 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:03:09,288 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:10,064 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:03:12,415 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:03:17,148 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:17,366 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:17,370 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "8.09s",
      "items_per_second": "6.18",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:17,373 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:03:17,380 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:59.037249",
  "average_speed": 8.47,
  "remaining_items": 0,
  "estimated_time": "4s",
  "status": "in_progress"
}
2024-12-28 11:03:17,386 - [INFO] - bitrix_migration.py:BitrixMigration.run:359 - Completed comment migration
2024-12-28 11:03:17,389 - [INFO] - bitrix_migration.py:BitrixMigration.run:354 - Starting task migration...
2024-12-28 11:03:17,393 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-28 11:03:17,395 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 1
2024-12-28 11:03:17,398 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-28 11:03:17,812 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:17,818 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:17,820 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:17,822 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:18,667 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:18,856 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:18,859 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "6h 4m 9s",
   "current_page": {
      "page": 1,
      "duration": "1.04s",
      "items_per_second": "48.05",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:19,863 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 2
2024-12-28 11:03:19,866 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-28 11:03:20,283 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:20,285 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:20,287 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:20,288 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:20,295 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:20,491 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:20,494 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "26h 39m 32s",
   "current_page": {
      "page": 2,
      "duration": "0.21s",
      "items_per_second": "239.41",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:21,499 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 3
2024-12-28 11:03:21,502 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-28 11:03:22,058 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:22,061 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:22,063 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:22,065 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:22,072 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:22,238 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:22,240 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "27h 9m 31s",
   "current_page": {
      "page": 3,
      "duration": "0.18s",
      "items_per_second": "278.82",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:23,245 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 4
2024-12-28 11:03:23,249 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-28 11:03:23,665 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:23,674 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:23,677 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:23,682 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:23,690 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:23,945 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:23,948 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "14h 54m 25s",
   "current_page": {
      "page": 4,
      "duration": "0.28s",
      "items_per_second": "178.37",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:24,954 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 5
2024-12-28 11:03:24,956 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-28 11:03:25,344 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:25,348 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:25,350 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:25,351 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:25,355 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:25,547 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:25,551 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "17h 10m 56s",
   "current_page": {
      "page": 5,
      "duration": "0.20s",
      "items_per_second": "246.91",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:26,554 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 6
2024-12-28 11:03:26,557 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-28 11:03:26,954 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:26,957 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:26,958 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:26,959 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:26,965 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:27,166 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:27,169 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "13h 8m 12s",
   "current_page": {
      "page": 6,
      "duration": "0.21s",
      "items_per_second": "235.94",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:28,173 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 7
2024-12-28 11:03:28,176 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-28 11:03:28,582 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:28,585 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:28,587 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:28,594 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:29,393 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:29,571 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:29,574 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "2h 7m 33s",
   "current_page": {
      "page": 7,
      "duration": "0.99s",
      "items_per_second": "50.52",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:30,579 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 8
2024-12-28 11:03:30,582 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-28 11:03:31,093 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:31,096 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:31,099 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:31,105 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:32,008 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:32,200 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:32,202 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "1h 16m 6s",
   "current_page": {
      "page": 8,
      "duration": "1.11s",
      "items_per_second": "45.16",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:33,206 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 9
2024-12-28 11:03:33,209 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-28 11:03:33,667 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:33,671 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:33,673 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:33,680 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:36,626 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:36,831 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:36,834 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "13m 35s",
   "current_page": {
      "page": 9,
      "duration": "3.16s",
      "items_per_second": "15.80",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:37,838 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:03:37,840 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:03:38,259 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:03:38,262 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:03:38,263 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:03:38,269 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:03:39,557 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:03:39,756 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:03:39,760 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "1.50s",
      "items_per_second": "33.40",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:03:39,764 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:03:39,770 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:00:21.938497",
  "average_speed": 22.79,
  "remaining_items": 0,
  "estimated_time": "11s",
  "status": "in_progress"
}
2024-12-28 11:03:39,775 - [INFO] - bitrix_migration.py:BitrixMigration.run:359 - Completed task migration
2024-12-28 11:03:39,777 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - DEBUG MODE migration completed in 0:01:22.104456
2024-12-28 11:03:39,781 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:384 - Bitrix migration cleanup completed
2024-12-28 11:11:01,470 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:11:01,473 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:384 - Bitrix migration cleanup completed
2024-12-28 11:11:01,477 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:11:01,480 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:11:07,492 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:11:07,608 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:11:09,043 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:11:09,055 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:11:09,058 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:11:09,061 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:11:09,064 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:11:10,558 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:11:10,561 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:11:10,563 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:11:10,565 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:11:10,567 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:14:28,534 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:14:28,538 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:14:28,540 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:14:28,553 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:14:28,555 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:14:28,559 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:14:28,562 - [ERROR] - bitrix_api.py:BitrixAPI.update_field_files:148 - Error: 'BitrixAPI' object has no attribute 'config'
2024-12-28 11:14:28,564 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:14:28,568 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:14:28,571 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 3, 17, 381645, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}']}}
2024-12-28 11:14:28,576 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:14:28,580 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:14:28,586 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:14:28,590 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:14:28,592 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:14:29,160 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:14:29,171 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:14:30,367 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:14:32,605 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:14:32,619 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:14:32,623 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:14:32,630 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:14:38,158 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:14:38,360 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:14:38,363 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 550,
   "estimated_time": "55m 4s",
   "current_page": {
      "page": 10,
      "duration": "9.20s",
      "items_per_second": "5.44",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:14:38,365 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:14:38,371 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:12:20.031758",
  "average_speed": 0.68,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:14:38,376 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:14:38,378 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:14:38,382 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 3, 39, 770744, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}']}}
2024-12-28 11:14:38,386 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:14:38,389 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:14:38,841 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:14:38,846 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:14:38,847 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:14:38,853 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:14:40,305 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:14:40,478 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:14:40,482 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 550,
   "estimated_time": "34m 6s",
   "current_page": {
      "page": 10,
      "duration": "1.64s",
      "items_per_second": "30.58",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:14:40,485 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:14:40,490 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:11:22.660857",
  "average_speed": 0.73,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:14:40,495 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:14:40,501 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:11.957060
2024-12-28 11:14:40,504 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:16:45,516 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:16:45,518 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:16:45,526 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:16:45,529 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:16:50,336 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:16:50,442 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:16:51,856 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:16:51,863 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:16:51,866 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:16:51,868 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:16:51,871 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:16:53,136 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:16:53,139 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:16:53,141 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:16:53,143 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:16:53,144 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:21:05,046 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:21:05,055 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:21:05,060 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:21:05,076 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:21:05,083 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:21:05,089 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:21:05,094 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:93 - Found 1 files to process
2024-12-28 11:21:05,100 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:97 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:21:05,107 - [ERROR] - bitrix_api.py:BitrixAPI.update_field_files:144 - Error processing file /app/.data/.progress/2-fieldFiles-1.txt: 'str' object has no attribute 'items'
2024-12-28 11:21:05,112 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:21:05,117 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:21:05,122 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 14, 38, 372632, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}']}}
2024-12-28 11:21:05,129 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:21:05,133 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:21:05,142 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:21:05,150 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:21:05,154 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:21:05,909 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:21:05,915 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:21:06,679 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:21:09,069 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:21:09,090 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:21:09,096 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:21:09,104 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:21:13,913 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:21:14,154 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:21:14,159 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 600,
   "estimated_time": "49m 4s",
   "current_page": {
      "page": 10,
      "duration": "8.24s",
      "items_per_second": "6.06",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:21:14,163 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:21:14,170 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:18:55.825447",
  "average_speed": 0.44,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:21:14,176 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:21:14,180 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:21:14,185 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 14, 40, 491866, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}']}}
2024-12-28 11:21:14,191 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:21:14,194 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:21:14,582 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:21:14,587 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:21:14,589 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:21:14,598 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:21:15,785 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:21:15,965 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:21:15,969 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 600,
   "estimated_time": "58m 53s",
   "current_page": {
      "page": 10,
      "duration": "1.38s",
      "items_per_second": "36.17",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:21:15,972 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:21:15,981 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:17:58.146901",
  "average_speed": 0.46,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:21:15,987 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:21:15,990 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:10.931276
2024-12-28 11:21:15,999 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:28:00,522 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:28:00,525 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:28:00,529 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:28:00,531 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:28:07,383 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:28:07,509 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:28:09,017 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:28:09,025 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:28:09,029 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:28:09,032 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:28:09,037 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:28:11,083 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:28:11,087 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:28:11,090 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:28:11,093 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:28:11,096 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:29:02,181 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:29:02,194 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:29:02,200 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:29:02,208 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:29:02,211 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:29:02,219 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:29:02,229 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:93 - Found 1 files to process
2024-12-28 11:29:02,232 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:97 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:29:02,236 - [ERROR] - bitrix_api.py:BitrixAPI.update_field_files:144 - Error processing file /app/.data/.progress/2-fieldFiles-1.txt: _to_camel_case() takes 1 positional argument but 2 were given
2024-12-28 11:29:02,248 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:29:02,257 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:29:02,268 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 21, 14, 171674, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}']}}
2024-12-28 11:29:02,279 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:29:02,287 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:29:02,309 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:29:02,319 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:29:02,330 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:29:03,127 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:29:03,140 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:29:03,896 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:29:06,755 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:29:06,769 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:29:06,774 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:29:06,777 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:29:12,273 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:29:12,484 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:29:12,491 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 650,
   "estimated_time": "45m 24s",
   "current_page": {
      "page": 10,
      "duration": "9.36s",
      "items_per_second": "5.34",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:29:12,494 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:29:12,502 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:26:54.154475",
  "average_speed": 0.31,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:29:12,509 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:29:12,512 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:29:12,516 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 21, 15, 983087, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}']}}
2024-12-28 11:29:12,521 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:29:12,525 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:29:12,987 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:29:12,991 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:29:12,992 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:29:13,004 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:29:14,596 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:29:14,781 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:29:14,784 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 650,
   "estimated_time": "49m 2s",
   "current_page": {
      "page": 10,
      "duration": "1.79s",
      "items_per_second": "27.89",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:29:14,787 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:29:14,792 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:25:56.963016",
  "average_speed": 0.32,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:29:14,798 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:29:14,800 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.603679
2024-12-28 11:29:14,804 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:29:41,546 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:29:41,549 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:29:41,570 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:29:41,573 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:29:46,689 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:29:46,802 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:29:48,315 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:29:48,323 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:29:48,326 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:29:48,329 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:29:48,333 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:29:49,786 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:29:49,789 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:29:49,793 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:29:49,796 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:29:49,799 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:30:11,464 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:30:11,470 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:30:11,474 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:30:11,481 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:30:11,484 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:30:11,488 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:30:11,491 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:93 - Found 1 files to process
2024-12-28 11:30:11,495 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:97 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:30:11,501 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:30:11,506 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:30:11,511 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:30:12,502 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:133 - Processed final batch. Total: 1 items
2024-12-28 11:30:12,506 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:138 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 11:30:12,509 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:30:12,513 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:30:12,517 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 29, 12, 503513, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}']}}
2024-12-28 11:30:12,522 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:30:12,526 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:30:12,535 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:30:12,542 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:30:12,550 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:30:13,129 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:30:13,134 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:30:13,902 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:30:16,291 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:30:21,151 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:30:21,387 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:30:21,390 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 700,
   "estimated_time": "38m 9s",
   "current_page": {
      "page": 10,
      "duration": "8.26s",
      "items_per_second": "6.06",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:30:21,393 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:30:21,399 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:28:03.057790",
  "average_speed": 0.3,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:30:21,405 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:30:21,408 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:30:21,413 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 29, 14, 793874, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}']}}
2024-12-28 11:30:21,417 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:30:21,421 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:30:21,813 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:30:21,818 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:30:21,820 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:30:21,827 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:30:23,538 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:30:23,760 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:30:23,763 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 700,
   "estimated_time": "32m 40s",
   "current_page": {
      "page": 10,
      "duration": "1.95s",
      "items_per_second": "25.70",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:30:23,767 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:30:23,773 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:27:05.941439",
  "average_speed": 0.31,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:30:23,779 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:30:23,782 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.309024
2024-12-28 11:30:23,787 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:46:26,976 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:46:26,979 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:46:26,982 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:46:26,985 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:46:32,355 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:46:32,471 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:46:34,007 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:46:34,015 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:46:34,019 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:46:34,021 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:46:34,025 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:46:36,128 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:46:36,131 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:46:36,134 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:46:36,136 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:46:36,139 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:47:26,144 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:47:26,148 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:47:26,150 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:47:26,157 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:47:26,160 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:47:26,162 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:47:26,165 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 1 files to process
2024-12-28 11:47:26,169 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:47:26,172 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:47:26,177 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:47:26,180 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:47:27,605 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:151 - Processed final batch. Total: 1 items
2024-12-28 11:47:27,608 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:156 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 11:47:27,613 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:47:27,622 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:47:27,627 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 30, 21, 400746, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}']}}
2024-12-28 11:47:27,632 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:47:27,636 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:47:27,643 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:47:27,647 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:47:27,650 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:47:28,191 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:47:28,196 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:47:28,964 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:47:31,116 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:47:36,337 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:47:36,637 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:47:36,641 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 750,
   "estimated_time": "33m 15s",
   "current_page": {
      "page": 10,
      "duration": "8.44s",
      "items_per_second": "5.92",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:47:36,645 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:47:36,652 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:45:18.307937",
  "average_speed": 0.18,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:47:36,659 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:47:36,663 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:47:36,668 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 30, 23, 775114, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}']}}
2024-12-28 11:47:36,673 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:47:36,677 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:47:37,059 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:47:37,066 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:47:37,069 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:47:37,076 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:47:38,397 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:47:38,610 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:47:38,618 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 750,
   "estimated_time": "43m 31s",
   "current_page": {
      "page": 10,
      "duration": "1.55s",
      "items_per_second": "32.26",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:47:38,624 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:47:38,633 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:44:20.777481",
  "average_speed": 0.19,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:47:38,640 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:47:38,642 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.491727
2024-12-28 11:47:38,650 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:49:44,708 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:49:44,716 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:49:44,748 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:49:44,751 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:49:49,614 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:49:49,731 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:49:51,267 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:49:51,274 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:49:51,279 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:49:51,283 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:49:51,287 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:49:52,659 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:49:52,662 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:49:52,665 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:49:52,668 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:49:52,670 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:50:08,563 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:50:08,570 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:50:08,573 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:50:08,583 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:50:08,587 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:50:08,591 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:50:08,594 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 1 files to process
2024-12-28 11:50:08,598 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:50:08,611 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:50:08,619 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:50:08,624 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:50:09,710 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:155 - Processed final batch. Total: 1 items
2024-12-28 11:50:09,713 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:160 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 11:50:09,716 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:50:09,720 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:50:09,725 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 47, 36, 653355, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}']}}
2024-12-28 11:50:09,733 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:50:09,737 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:50:09,744 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:50:09,749 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:50:09,752 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:50:10,280 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:50:10,286 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:50:11,067 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:50:13,059 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:50:18,470 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:50:18,694 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:50:18,700 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 800,
   "estimated_time": "27m 47s",
   "current_page": {
      "page": 10,
      "duration": "8.41s",
      "items_per_second": "5.94",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:50:18,706 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:50:18,713 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:48:00.365301",
  "average_speed": 0.17,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:50:18,720 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:50:18,723 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:50:18,728 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 47, 38, 634236, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}']}}
2024-12-28 11:50:18,734 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:50:18,739 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:50:19,329 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:50:19,333 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:50:19,335 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:50:19,343 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:50:20,769 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:50:21,017 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:50:21,022 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 800,
   "estimated_time": "29m 25s",
   "current_page": {
      "page": 10,
      "duration": "1.69s",
      "items_per_second": "29.62",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:50:21,026 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:50:21,041 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:47:03.198848",
  "average_speed": 0.18,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:50:21,053 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:50:21,059 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.483729
2024-12-28 11:50:21,064 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:50:51,736 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:50:51,739 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:50:51,758 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:50:51,763 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:50:56,866 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:50:56,983 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:50:58,493 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:50:58,500 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:50:58,504 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:50:58,506 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:50:58,510 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:50:59,860 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:50:59,862 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:50:59,865 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:50:59,867 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:50:59,869 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:52:19,238 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:52:19,240 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:52:19,260 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:52:19,263 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:52:23,860 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:52:23,972 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:52:25,411 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:52:25,418 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:52:25,421 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:52:25,423 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:52:25,427 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:52:26,827 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:52:26,830 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:52:26,833 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:52:26,835 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:52:26,837 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:52:50,687 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:52:50,698 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:52:50,704 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:52:50,728 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:52:50,732 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:52:50,736 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:52:50,739 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 2 files to process
2024-12-28 11:52:50,742 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-batch.txt
2024-12-28 11:52:50,748 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:162 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-batch.txt
2024-12-28 11:52:50,752 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:52:50,760 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:52:50,769 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 11:52:50,773 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:52:51,807 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:157 - Processed final batch. Total: 1 items
2024-12-28 11:52:51,811 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:162 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 11:52:51,815 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:52:51,819 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:52:51,824 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 50, 18, 715134, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}']}}
2024-12-28 11:52:51,829 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:52:51,833 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:52:51,844 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:52:51,848 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 11:52:51,850 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:52:52,362 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:52:52,367 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:52:53,155 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:52:55,398 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:53:00,456 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:53:00,657 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:53:00,660 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 850,
   "estimated_time": "21m 55s",
   "current_page": {
      "page": 10,
      "duration": "8.29s",
      "items_per_second": "6.03",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:53:00,661 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:53:00,667 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:50:42.328834",
  "average_speed": 0.16,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:53:00,673 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:53:00,676 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:53:00,681 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 50, 21, 48442, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}']}}
2024-12-28 11:53:00,686 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:53:00,689 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:53:01,061 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:53:01,065 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:53:01,066 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:53:01,072 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:53:02,695 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:53:02,903 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:53:02,908 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 850,
   "estimated_time": "18m 45s",
   "current_page": {
      "page": 10,
      "duration": "1.84s",
      "items_per_second": "27.14",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:53:02,912 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:53:02,919 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:49:45.072280",
  "average_speed": 0.17,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:53:02,926 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:53:02,929 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.227301
2024-12-28 11:53:02,935 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:56:37,214 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 11:56:37,217 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 11:56:37,234 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 11:56:37,237 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 11:56:42,800 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 11:56:42,921 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 11:56:44,416 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 11:56:44,427 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 11:56:44,435 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 11:56:44,440 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 11:56:44,445 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 11:56:45,837 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 11:56:45,840 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 11:56:45,844 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 11:56:45,846 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 11:56:45,848 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 11:57:33,881 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 11:57:33,889 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 11:57:33,891 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 11:57:33,908 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 11:57:33,915 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 11:57:33,919 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 11:57:33,923 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 2 files to process
2024-12-28 11:57:33,927 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 11:57:33,935 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:57:33,941 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-28 11:57:34,883 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:57:36,285 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:160 - Processed final batch. Total: 1 items
2024-12-28 11:57:36,290 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:165 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 11:57:36,293 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-batch.txt
2024-12-28 11:57:36,298 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:165 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-batch.txt
2024-12-28 11:57:36,300 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 11:57:36,302 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 11:57:36,309 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 53, 0, 667912, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}']}}
2024-12-28 11:57:36,314 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 11:57:36,316 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:57:36,324 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 11:57:36,327 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-28 11:57:37,167 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 11:57:37,716 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 11:57:37,721 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 11:57:38,521 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 11:57:40,631 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 11:57:45,361 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:57:45,574 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:57:45,577 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 900,
   "estimated_time": "14m 15s",
   "current_page": {
      "page": 10,
      "duration": "7.86s",
      "items_per_second": "6.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:57:45,580 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:57:45,587 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:55:27.245209",
  "average_speed": 0.15,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:57:45,593 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 11:57:45,595 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 11:57:45,599 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 53, 2, 921397, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}']}}
2024-12-28 11:57:45,605 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 11:57:45,609 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 11:57:46,148 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 11:57:46,154 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 11:57:46,155 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 11:57:46,161 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 11:57:47,318 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 11:57:47,506 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 11:57:47,509 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 900,
   "estimated_time": "50m 50s",
   "current_page": {
      "page": 10,
      "duration": "1.36s",
      "items_per_second": "36.88",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 11:57:47,512 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 11:57:47,518 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:54:29.687841",
  "average_speed": 0.15,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 11:57:47,524 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 11:57:47,526 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:13.634901
2024-12-28 11:57:47,530 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:01:23,975 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 12:01:23,978 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 12:01:23,982 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:478 - Failed to check Bitrix connection: Session is closed
2024-12-28 12:01:23,986 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:478 - Failed to check Bitrix connection: Session is closed
2024-12-28 12:01:23,989 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 12:01:23,995 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 12:01:24,000 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 12:01:24,003 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 12:01:24,009 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 1 files to process
2024-12-28 12:01:24,013 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 12:01:25,141 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:160 - Processed final batch. Total: 1 items
2024-12-28 12:01:25,144 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:165 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 12:01:25,146 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 12:01:25,149 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 12:01:25,153 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 57, 45, 588638, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}']}}
2024-12-28 12:01:25,159 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 12:01:25,162 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 12:01:25,738 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 12:01:25,742 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 12:01:26,528 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 12:01:28,885 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 12:01:33,810 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 12:01:34,234 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 12:01:34,237 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 950,
   "estimated_time": "12m 7s",
   "current_page": {
      "page": 10,
      "duration": "8.50s",
      "items_per_second": "5.89",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 12:01:34,240 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 12:01:34,248 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:59:15.903073",
  "average_speed": 0.14,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 12:01:34,256 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 12:01:34,260 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 12:01:34,264 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 57, 47, 519319, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}']}}
2024-12-28 12:01:34,268 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 12:01:34,271 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 12:01:34,707 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 12:01:34,721 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 12:01:34,722 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 12:01:34,728 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 12:01:35,966 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 12:01:36,216 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 12:01:36,219 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 950,
   "estimated_time": "46m 1s",
   "current_page": {
      "page": 10,
      "duration": "1.50s",
      "items_per_second": "33.37",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 12:01:36,223 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 12:01:36,228 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "0:58:18.397041",
  "average_speed": 0.14,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 12:01:36,236 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 12:01:36,239 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.258570
2024-12-28 12:01:36,242 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:05:14,377 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 12:05:14,381 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 12:05:14,390 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:478 - Failed to check Bitrix connection: Session is closed
2024-12-28 12:05:14,400 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:478 - Failed to check Bitrix connection: Session is closed
2024-12-28 12:05:14,407 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 12:05:14,421 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 12:05:14,425 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 12:05:14,429 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 12:05:14,432 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 2 files to process
2024-12-28 12:05:14,437 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-batch.txt
2024-12-28 12:05:14,442 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:165 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-batch.txt
2024-12-28 12:05:14,445 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 12:05:15,645 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:160 - Processed final batch. Total: 1 items
2024-12-28 12:05:15,649 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:165 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 12:05:15,652 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 12:05:15,660 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 12:05:15,668 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 5, 1, 34, 250770, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}']}}
2024-12-28 12:05:15,676 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 12:05:15,680 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 12:05:16,247 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 12:05:16,254 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 12:05:17,036 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 12:05:20,489 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 12:05:25,161 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 12:05:25,400 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 12:05:25,405 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 1000,
   "estimated_time": "10m 19s",
   "current_page": {
      "page": 10,
      "duration": "9.15s",
      "items_per_second": "5.46",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 12:05:25,409 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 12:05:25,422 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1:03:07.070403",
  "average_speed": 0.13,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 12:05:25,429 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 12:05:25,432 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 12:05:25,437 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 5, 1, 36, 229568, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}']}}
2024-12-28 12:05:25,442 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 12:05:25,447 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 12:05:25,864 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 12:05:25,869 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 12:05:25,871 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 12:05:25,879 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 12:05:27,089 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 12:05:27,323 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 12:05:27,326 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 1000,
   "estimated_time": "10m 2s",
   "current_page": {
      "page": 10,
      "duration": "1.46s",
      "items_per_second": "34.30",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 12:05:27,329 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 12:05:27,336 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1:02:09.503140",
  "average_speed": 0.13,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 12:05:27,342 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 12:05:27,344 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:12.954951
2024-12-28 12:05:27,352 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:12:19,085 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 12:12:19,087 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:12:19,093 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 12:12:19,097 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 12:12:23,670 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 12:12:23,791 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 12:12:25,294 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 12:12:25,302 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 12:12:25,306 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 12:12:25,308 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 12:12:25,312 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 12:12:27,359 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 12:12:27,361 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 12:12:27,364 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 12:12:27,366 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 12:12:27,367 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 12:13:35,052 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 12:13:35,056 - [WARNING] - bitrix_migration.py:BitrixMigration.run:326 - Starting migration in DEBUG MODE
2024-12-28 12:13:35,058 - [INFO] - bitrix_migration.py:BitrixMigration.run:339 - Starting deal migration...
2024-12-28 12:13:35,065 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 12:13:35,068 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 12:13:35,071 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 12:13:35,073 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 1 files to process
2024-12-28 12:13:35,075 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-1.txt
2024-12-28 12:13:35,080 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 12:13:35,083 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 12:13:35,085 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 12:13:36,805 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:160 - Processed final batch. Total: 1 items
2024-12-28 12:13:36,808 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:165 - File renamed to: /app/.data/.progress/2-processed-fieldFiles-1.txt
2024-12-28 12:13:36,810 - [INFO] - bitrix_migration.py:BitrixMigration.run:350 - Completed deal migration
2024-12-28 12:13:36,813 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting comment migration...
2024-12-28 12:13:36,817 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 5, 5, 25, 423602, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}']}}
2024-12-28 12:13:36,821 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-28 12:13:36,823 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 12:13:36,829 - [ERROR] - bitrix_base.py:BitrixAPI.batch:331 - Missing auth credentials - attempting to get new auth
2024-12-28 12:13:36,832 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 12:13:36,835 - [INFO] - bitrix_base.py:BitrixAPI.batch:338 - Successfully obtained new auth credentials
2024-12-28 12:13:37,419 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-28 12:13:37,424 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-28 12:13:38,199 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-28 12:13:42,056 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-28 12:13:47,076 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-28 12:13:47,254 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 12:13:47,257 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 1050,
   "estimated_time": "8m 49s",
   "current_page": {
      "page": 10,
      "duration": "9.83s",
      "items_per_second": "5.08",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 12:13:47,259 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 12:13:47,264 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1:11:28.925320",
  "average_speed": 0.12,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 12:13:47,269 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed comment migration
2024-12-28 12:13:47,271 - [INFO] - bitrix_migration.py:BitrixMigration.run:355 - Starting task migration...
2024-12-28 12:13:47,275 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 5, 5, 27, 337724, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}']}}
2024-12-28 12:13:47,279 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-28 12:13:47,281 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-28 12:13:47,662 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-28 12:13:47,665 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-28 12:13:47,667 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-28 12:13:47,672 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-28 12:13:49,427 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-28 12:13:49,681 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-28 12:13:49,685 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 1050,
   "estimated_time": "8m 25s",
   "current_page": {
      "page": 10,
      "duration": "2.02s",
      "items_per_second": "24.76",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-28 12:13:49,687 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-28 12:13:49,693 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1:10:31.863947",
  "average_speed": 0.12,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-28 12:13:49,701 - [INFO] - bitrix_migration.py:BitrixMigration.run:360 - Completed task migration
2024-12-28 12:13:49,703 - [WARNING] - bitrix_migration.py:BitrixMigration.run:366 - DEBUG MODE migration completed in 0:00:14.645730
2024-12-28 12:13:49,707 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:24:40,085 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 12:24:40,087 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:24:40,090 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 12:24:40,092 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 12:24:45,121 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 12:24:45,235 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 12:24:46,723 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 12:24:46,729 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 12:24:46,733 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 12:24:46,736 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 12:24:46,739 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 12:24:48,851 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 12:24:48,854 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 12:24:48,857 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 12:24:48,859 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 12:24:48,861 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 12:24:57,031 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 12:24:57,036 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 12:24:57,039 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 12:24:57,430 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 12:24:57,433 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 12:24:57,436 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 12:38:45,555 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 12:38:45,559 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:385 - Bitrix migration cleanup completed
2024-12-28 12:38:45,562 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 12:38:45,564 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 12:38:50,777 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 12:38:50,891 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 12:38:52,374 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 12:38:52,380 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 12:38:52,383 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 12:38:52,385 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 12:38:52,388 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 12:38:54,452 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 12:38:54,454 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 12:38:54,456 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 12:38:54,459 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 12:38:54,462 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 12:39:01,590 - [INFO] - bitrix_migration.py:BitrixMigration.create_mapping_file:327 - Removed existing file: /app/.data/.downloads/mapping-fields.xlsx
2024-12-28 12:39:01,593 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 12:39:01,601 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 12:39:01,607 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 12:39:01,976 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 12:39:01,997 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 12:39:02,006 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 12:55:29,644 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 12:55:29,648 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:419 - Bitrix migration cleanup completed
2024-12-28 12:55:29,652 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 12:55:29,655 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 12:55:35,141 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 12:55:35,264 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 12:55:36,829 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 12:55:36,836 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 12:55:36,841 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 12:55:36,843 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 12:55:36,848 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 12:55:38,913 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 12:55:38,916 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 12:55:38,919 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 12:55:38,922 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 12:55:38,924 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 12:56:11,405 - [INFO] - bitrix_migration.py:BitrixMigration.create_mapping_file:326 - Removed existing file: /app/.data/.downloads/mapping-fields.xlsx
2024-12-28 12:56:11,408 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 12:56:11,413 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-28 12:56:12,418 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 12:56:12,839 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 12:56:12,843 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-28 12:56:13,739 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 12:58:21,107 - [ERROR] - bitrix_migration.py:BitrixMigration.create_mapping_file:350 - Error processing mapping source:products target:products: 'list' object has no attribute 'keys'
2024-12-28 12:58:22,149 - [ERROR] - excel.py:Excel.export_to_spreadsheet:336 - Error processing sheet spa129_deal: 'data'
2024-12-28 13:00:55,830 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 13:00:55,834 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:422 - Bitrix migration cleanup completed
2024-12-28 13:00:55,838 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 13:00:55,840 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 13:01:00,592 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 13:01:00,696 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 13:01:02,268 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 13:01:02,301 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 13:01:02,306 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 13:01:02,309 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 13:01:02,313 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:59 - Initializing Migration Tool in DEBUG MODE
2024-12-28 13:01:03,688 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:167 - Successfully initialized deal processor
2024-12-28 13:01:03,691 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized comment processor
2024-12-28 13:01:03,693 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:178 - Successfully initialized task processor
2024-12-28 13:01:03,695 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 13:01:03,697 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 13:02:32,598 - [INFO] - bitrix_migration.py:BitrixMigration.create_mapping_file:326 - Removed existing file: /app/.data/.downloads/mapping-fields.xlsx
2024-12-28 13:02:32,602 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 13:02:32,613 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 13:02:32,616 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 13:02:33,052 - [DEBUG] - bitrix_base.py:BitrixAPI.call:165 - Missing auth credentials - attempting to get new auth
2024-12-28 13:02:33,055 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-28 13:02:33,058 - [INFO] - bitrix_base.py:BitrixAPI.call:172 - Successfully obtained new auth credentials
2024-12-28 13:42:38,038 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-28 13:42:38,042 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:422 - Bitrix migration cleanup completed
2024-12-28 13:42:38,046 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-28 13:42:38,050 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-28 13:44:12,729 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-28 13:44:12,883 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-28 13:44:14,361 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-28 13:44:14,368 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-28 13:44:14,372 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-28 13:44:14,374 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-28 13:44:14,378 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-28 13:44:16,385 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-28 13:44:16,389 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-28 13:44:16,393 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-28 13:44:16,398 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-28 13:44:16,404 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-28 13:44:16,409 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-28 13:44:27,137 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-28 13:44:27,140 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-28 13:44:27,144 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-28 13:44:27,152 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-28 13:44:27,156 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-28 13:44:27,158 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-28 13:44:27,161 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:111 - Found 1 files to process
2024-12-28 13:44:27,164 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:115 - 
Processing file: /app/.data/.progress/2-fieldFiles-batch.txt
2024-12-28 13:44:27,179 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-28 13:44:27,182 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-28 13:44:27,187 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {}}
2024-12-28 13:44:27,190 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-28 13:44:27,194 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-28 13:44:27,201 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-28 13:44:27,207 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-28 13:44:27,210 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-28 13:44:27,923 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-28 13:44:27,929 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-28 13:44:27,932 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-28 13:44:27,934 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,936 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,938 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,940 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,951 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,954 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,962 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,965 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,968 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,973 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,975 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,977 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,980 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,982 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,985 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,987 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,990 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,992 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,994 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,997 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:27,999 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,001 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,004 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,007 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,010 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,012 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,014 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,017 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,019 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,021 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,024 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,026 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,028 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,031 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,033 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,036 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,038 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,041 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,043 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,045 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,048 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,050 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,052 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,055 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,057 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,059 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,061 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,064 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,066 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,068 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:28,071 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 1,
      "duration": "0.14s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-28 13:44:29,076 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 2
2024-12-28 13:44:29,078 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-28 13:44:29,567 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-28 13:44:29,570 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-28 13:44:29,572 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-28 13:44:29,574 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,576 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,578 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,580 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,582 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,585 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,587 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,589 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,591 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,593 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,595 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,598 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,600 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,603 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,605 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,607 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,609 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,612 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,614 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,616 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,619 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,622 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,624 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,626 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,628 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,630 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,632 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,634 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,637 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,639 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,641 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,643 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,646 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,648 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,651 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,653 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,656 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,668 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,670 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,672 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,675 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,677 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,679 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,683 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,686 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,689 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,691 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,693 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,696 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,698 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:29,702 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 2,
      "duration": "0.13s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-28 13:44:30,707 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 3
2024-12-28 13:44:30,709 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-28 13:44:31,199 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-28 13:44:31,204 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-28 13:44:31,207 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-28 13:44:31,209 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,211 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,214 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,217 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,220 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,223 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,225 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,227 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,229 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,231 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,234 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,237 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,240 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,242 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,244 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,247 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,250 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,252 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,255 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,257 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,260 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,262 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,264 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,267 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,271 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,273 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,275 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,277 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,279 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,283 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,285 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,288 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,290 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,292 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,294 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,296 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,298 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,300 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,302 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,305 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,308 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,310 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,312 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,315 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,317 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,319 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,322 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,324 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,329 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,331 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:31,334 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 3,
      "duration": "0.13s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-28 13:44:32,340 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 4
2024-12-28 13:44:32,342 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-28 13:44:33,063 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-28 13:44:33,068 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-28 13:44:33,070 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-28 13:44:33,072 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,074 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,077 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,079 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,081 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,083 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,085 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,088 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,090 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,092 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,094 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,097 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,100 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,105 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,108 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,110 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,115 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,117 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,122 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,124 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,126 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,128 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,130 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,133 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,139 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,142 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,147 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,150 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,154 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,158 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,162 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,165 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,167 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,169 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,171 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,173 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,175 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,177 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,179 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,181 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,184 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,186 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,188 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,191 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,193 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,195 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,197 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,200 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,202 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,204 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:33,207 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 4,
      "duration": "0.14s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-28 13:44:34,212 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 5
2024-12-28 13:44:34,214 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-28 13:44:34,710 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-28 13:44:34,714 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-28 13:44:34,717 - [INFO] - circuit_breaker.py:CircuitBreaker._log_event:219 - {"timestamp": "2024-12-28T13:44:34.715303", "circuit": "BitrixMigration_CB", "state": "OPEN", "event": "state_change", "metrics": {"total_failures": 5, "consecutive_successes": 0, "total_requests": 0, "success_rate": 0.0, "last_success_time": "2024-12-28T13:44:34.711527", "average_response_time": 0.0, "retry_attempts": 0, "error_distribution": {}}, "new_state": "OPEN", "reason": "failure_threshold_reached"}
2024-12-28 13:44:34,719 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-28 13:44:34,722 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,724 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,726 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,728 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,731 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,733 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,735 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,738 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,740 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,743 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,745 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,747 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,749 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,752 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,754 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,756 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,759 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,761 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,763 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,765 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,767 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,770 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,772 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,775 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,777 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,779 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,781 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,784 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,786 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,788 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,790 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,793 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,795 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,797 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,799 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,801 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,803 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,805 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,807 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,809 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,812 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,814 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,816 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,818 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,820 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,822 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,824 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,827 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,829 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,831 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-28 13:44:34,833 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 5,
      "duration": "0.12s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-28 13:44:35,838 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 6
2024-12-28 13:44:35,840 - [ERROR] - base_processor.py:DealProductsProcessor.background:338 - Background processing error in DealProductsProcessor: 'CircuitBreaker' object has no attribute '_should_reset'
2024-12-28 13:44:35,845 - [ERROR] - bitrix_migration.py:BitrixMigration.run:410 - Migration failed: 'CircuitBreaker' object has no attribute '_should_reset'
2024-12-28 13:44:35,848 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 08:41:23,006 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 08:41:23,009 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 08:41:23,012 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:492 - Failed to check Bitrix connection: Session is closed
2024-12-30 08:41:23,014 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 08:41:23,159 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 08:41:23,163 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 08:41:23,165 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 08:41:23,168 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 08:41:23,171 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 08:41:23,174 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 08:41:23,178 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background_process should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 6, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 6, 44, 35, 841187, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}']}}
2024-12-30 08:41:23,186 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 6
2024-12-30 08:41:23,189 - [ERROR] - base_processor.py:DealProductsProcessor.background:338 - Background processing error in DealProductsProcessor: 'CircuitBreaker' object has no attribute '_should_reset'
2024-12-30 08:41:23,197 - [ERROR] - bitrix_migration.py:BitrixMigration.run:410 - Migration failed: 'CircuitBreaker' object has no attribute '_should_reset'
2024-12-30 08:41:23,200 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 08:48:14,084 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 08:48:14,087 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 08:48:14,091 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 08:48:14,094 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 08:48:21,489 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 08:48:21,606 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 08:48:23,136 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 08:48:23,145 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 08:48:23,149 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 08:48:23,152 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 08:48:23,156 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 08:48:24,578 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 08:48:24,581 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 08:48:24,584 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 08:48:24,587 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 08:48:24,590 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 08:48:24,593 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 08:48:45,864 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 08:48:45,870 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 08:48:45,874 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 08:48:45,881 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 08:48:45,884 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 08:48:45,886 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 08:48:45,890 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 08:48:45,892 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 08:48:45,894 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 08:48:45,898 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 6, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 1, 41, 23, 191136, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}']}}
2024-12-30 08:48:45,901 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 6
2024-12-30 08:48:45,904 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-30 08:48:45,909 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 08:48:45,916 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-30 08:48:46,938 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 08:48:47,552 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 08:48:47,556 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 08:48:47,558 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-30 08:48:47,561 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-30 08:48:47,563 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 6,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 08:48:48,574 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 7
2024-12-30 08:48:48,576 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-30 08:48:48,999 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 08:48:49,004 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 08:48:49,007 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-30 08:48:49,010 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-30 08:48:49,014 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 7,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 08:48:50,020 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 8
2024-12-30 08:48:50,023 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-30 08:48:50,452 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 08:48:50,457 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 08:48:50,460 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-30 08:48:50,462 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-30 08:48:50,466 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 8,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 08:48:51,472 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 9
2024-12-30 08:48:51,476 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-30 08:48:51,884 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 08:48:51,888 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 08:48:51,891 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-30 08:48:51,894 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-30 08:48:51,898 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 9,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 08:48:52,910 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 10
2024-12-30 08:48:52,913 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-30 08:48:53,359 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 08:48:53,364 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 08:48:53,367 - [INFO] - circuit_breaker.py:CircuitBreaker._log_event:219 - {"timestamp": "2024-12-30T08:48:53.364857", "circuit": "BitrixMigration_CB", "state": "OPEN", "event": "state_change", "metrics": {"total_failures": 5, "consecutive_successes": 0, "total_requests": 0, "success_rate": 0.0, "last_success_time": "2024-12-30T08:48:53.360369", "average_response_time": 0.0, "retry_attempts": 0, "error_distribution": {}}, "new_state": "OPEN", "reason": "failure_threshold_reached"}
2024-12-30 08:48:53,370 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: 'products'
2024-12-30 08:48:53,374 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get'
2024-12-30 08:48:53,377 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 10,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 08:48:54,384 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 11
2024-12-30 08:48:54,389 - [ERROR] - base_processor.py:DealProductsProcessor.background:338 - Background processing error in DealProductsProcessor: Circuit BitrixMigration_CB is OPEN. Next retry in 59.0s
2024-12-30 08:48:54,396 - [ERROR] - bitrix_migration.py:BitrixMigration.run:410 - Migration failed: Circuit BitrixMigration_CB is OPEN. Next retry in 59.0s
2024-12-30 08:48:54,401 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 08:59:44,362 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 08:59:44,368 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 08:59:44,372 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 08:59:44,375 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 08:59:49,125 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 08:59:49,239 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 08:59:50,760 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 08:59:50,766 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 08:59:50,770 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 08:59:50,773 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 08:59:50,777 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 08:59:53,790 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 08:59:53,793 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 08:59:53,797 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 08:59:53,800 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 08:59:53,803 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 08:59:53,805 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:00:42,059 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:00:42,066 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:00:42,072 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:00:42,084 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:00:42,087 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:00:42,092 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:00:42,096 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:00:42,099 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:00:42,102 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:00:42,107 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 11, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 1, 48, 54, 390612, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}']}}
2024-12-30 09:00:42,113 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 11
2024-12-30 09:00:42,116 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 11 - offset: 500
2024-12-30 09:00:42,122 - [WARNING] - base_processor.py:DealProductsProcessor._get_and_validate_items:556 - No valid items found for DealProductsProcessor
2024-12-30 09:00:42,130 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 0,
  "failed_count": 0,
  "success_rate": 0.0,
  "processing_time": "1 day, 19:04:26.465963",
  "average_speed": 0.0,
  "remaining_items": 500,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:00:42,136 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 09:00:42,139 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 09:00:42,144 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 5, 13, 47, 265636, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}']}}
2024-12-30 09:00:42,151 - [DEBUG] - base_processor.py:CommentProcessor.background:193 - Processing for page: 10
2024-12-30 09:00:42,155 - [ERROR] - comment_processor.py:CommentProcessor.get_all:46 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-30 09:00:42,162 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:00:42,169 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 09:00:42,173 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:00:42,991 - [INFO] - base_processor.py:CommentProcessor._get_and_validate_items:559 - Found 50 items to process for CommentProcessor
2024-12-30 09:00:42,995 - [DEBUG] - comment_processor.py:CommentProcessor.process_items:107 - Process records using Bitrix batch API with batch import
2024-12-30 09:00:43,844 - [DEBUG] - downloader.py:Downloader.download_batch:88 - Starting batch download
2024-12-30 09:00:47,104 - [DEBUG] - downloader.py:Downloader.download_batch:126 - Batch download completed. Success: 5/5
2024-12-30 09:00:47,118 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:00:47,122 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-30 09:00:48,123 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:00:54,812 - [DEBUG] - base_processor.py:CommentProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:00:55,047 - [DEBUG] - base_processor.py:CommentProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:00:55,054 - [DEBUG] - base_processor.py:CommentProcessor.background:319 - Background processed batch for CommentProcessor: {
   "total_items": 500,
   "total_processed": 1100,
   "estimated_time": "13m 32s",
   "current_page": {
      "page": 10,
      "duration": "12.06s",
      "items_per_second": "4.15",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:00:55,057 - [DEBUG] - base_processor.py:CommentProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 09:00:55,064 - [DEBUG] - base_processor.py:CommentProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 21:58:36.717341",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:00:55,070 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 09:00:55,072 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 09:00:55,077 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 5, 13, 49, 696599, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}']}}
2024-12-30 09:00:55,082 - [DEBUG] - base_processor.py:TaskProcessor.background:193 - Processing for page: 10
2024-12-30 09:00:55,087 - [ERROR] - task_processor.py:TaskProcessor.get_all:211 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-30 09:00:55,711 - [INFO] - base_processor.py:TaskProcessor._get_and_validate_items:559 - Found 50 items to process for TaskProcessor
2024-12-30 09:00:55,716 - [DEBUG] - task_processor.py:TaskProcessor.process_items:274 - Process records using Bitrix batch API with batch import
2024-12-30 09:00:55,717 - [DEBUG] - task_processor.py:TaskProcessor._add_tasks:129 - Add tasks
2024-12-30 09:00:55,723 - [DEBUG] - task_processor.py:TaskProcessor._get_task_comments:74 - Fetch all comments in task
2024-12-30 09:00:57,399 - [DEBUG] - base_processor.py:TaskProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:00:57,582 - [DEBUG] - base_processor.py:TaskProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:00:57,585 - [DEBUG] - base_processor.py:TaskProcessor.background:319 - Background processed batch for TaskProcessor: {
   "total_items": 500,
   "total_processed": 1100,
   "estimated_time": "27m 28s",
   "current_page": {
      "page": 10,
      "duration": "1.87s",
      "items_per_second": "26.75",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:00:57,587 - [DEBUG] - base_processor.py:TaskProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 09:00:57,591 - [DEBUG] - base_processor.py:TaskProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 21:57:39.764499",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:00:57,596 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 09:00:57,598 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:15.528366
2024-12-30 09:00:57,601 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:03:54,185 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:03:54,187 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:03:54,203 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:03:54,207 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:03:59,302 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:03:59,408 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:04:00,870 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:04:00,877 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:04:00,880 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:04:00,882 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:04:00,886 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:04:03,786 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:04:03,790 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:04:03,792 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:04:03,794 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:04:03,797 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:04:03,799 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:11:55,086 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:11:55,090 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:11:55,096 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:11:55,099 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:12:19,178 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:12:19,361 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:12:20,969 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:12:20,977 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:12:20,988 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:12:20,991 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:12:20,995 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:12:24,585 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:12:24,590 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:12:24,593 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:12:24,596 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:12:24,599 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:12:24,601 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:15:45,122 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:15:45,127 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:15:45,152 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:15:45,156 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:16:11,235 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:16:11,496 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:16:13,355 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:16:13,372 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:16:13,377 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:16:13,380 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:16:13,385 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:16:16,824 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:16:16,838 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:16:16,841 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:16:16,859 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:16:16,862 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:16:16,878 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:17:15,015 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:17:15,017 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:17:15,042 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:17:15,045 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:17:51,414 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:17:51,635 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:17:53,314 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:17:53,321 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:17:53,330 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:17:53,333 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:17:53,344 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:17:56,697 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:17:56,699 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:17:56,701 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:17:56,710 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:17:56,712 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:17:56,715 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:18:53,792 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:18:53,799 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:18:53,804 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:18:53,836 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:18:53,844 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:18:53,858 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:18:53,861 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:18:53,865 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:18:53,868 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:18:53,873 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 42, 131644, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}']}}
2024-12-30 09:18:53,879 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 09:18:53,883 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 09:18:53,898 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:18:53,905 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 09:18:53,909 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:18:54,614 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:18:54,621 - [WARNING] - deal_products_processor.py:DealProductsProcessor._filter_items_after_id:25 - Invalid last_processed_id: {record['source_id']_record['target_id']}
2024-12-30 09:18:54,624 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:18:54,628 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:18:54,632 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:18:54,637 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 1,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:18:55,648 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 2
2024-12-30 09:18:55,651 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-30 09:18:56,898 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:18:56,904 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:18:56,907 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:18:56,912 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:18:56,917 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 2,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:18:57,923 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 3
2024-12-30 09:18:57,926 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-30 09:18:58,611 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:18:58,615 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:18:58,618 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:18:58,621 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:18:58,624 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 3,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:18:59,630 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 4
2024-12-30 09:18:59,633 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-30 09:19:00,122 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:19:00,128 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:19:00,131 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:19:00,134 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:19:00,139 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 4,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:19:01,149 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 5
2024-12-30 09:19:01,153 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-30 09:19:02,302 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:19:02,330 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:19:02,336 - [INFO] - circuit_breaker.py:CircuitBreaker._log_event:219 - {"timestamp": "2024-12-30T09:19:02.332092", "circuit": "BitrixMigration_CB", "state": "OPEN", "event": "state_change", "metrics": {"total_failures": 5, "consecutive_successes": 0, "total_requests": 0, "success_rate": 0.0, "last_success_time": "2024-12-30T09:19:02.303477", "average_response_time": 0.0, "retry_attempts": 0, "error_distribution": {}}, "new_state": "OPEN", "reason": "failure_threshold_reached"}
2024-12-30 09:19:02,340 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:19:02,345 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:19:02,364 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 5,
      "duration": "0.03s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:19:03,372 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 6
2024-12-30 09:19:03,375 - [ERROR] - base_processor.py:DealProductsProcessor.background:338 - Background processing error in DealProductsProcessor: Circuit BitrixMigration_CB is OPEN. Next retry in 59.0s
2024-12-30 09:19:03,384 - [ERROR] - bitrix_migration.py:BitrixMigration.run:410 - Migration failed: Circuit BitrixMigration_CB is OPEN. Next retry in 59.0s
2024-12-30 09:19:03,387 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:19:18,879 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:19:18,882 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:19:18,906 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:19:18,909 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:19:24,318 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:19:24,435 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:19:25,946 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:19:25,953 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:19:25,957 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:19:25,960 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:19:25,968 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:19:28,907 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:19:28,910 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:19:28,913 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:19:28,917 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:19:28,919 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:19:28,922 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:27:54,654 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:27:54,656 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:27:54,659 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:27:54,662 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:28:00,273 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:28:00,390 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:28:01,837 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:28:01,845 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:28:01,850 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:28:01,854 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:28:01,857 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:28:05,240 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:28:05,244 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:28:05,247 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:28:05,251 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:28:05,254 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:28:05,256 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:28:45,097 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:28:45,104 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:28:45,109 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:28:45,119 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:28:45,122 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:28:45,126 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:28:45,129 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:28:45,132 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:28:45,135 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:28:45,140 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 6, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 19, 3, 376381, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}']}}
2024-12-30 09:28:45,145 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 6
2024-12-30 09:28:45,149 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-30 09:28:45,156 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:28:45,161 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 09:28:45,165 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:28:45,645 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:28:45,650 - [WARNING] - deal_products_processor.py:DealProductsProcessor._filter_items_after_id:25 - Invalid last_processed_id: {record['source_id']_record['target_id']}
2024-12-30 09:28:45,653 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:28:45,657 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:28:45,660 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:28:45,663 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 6,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:28:46,670 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 7
2024-12-30 09:28:46,673 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-30 09:28:47,072 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:28:47,077 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:28:47,082 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:28:47,085 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:28:47,089 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 7,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:28:48,097 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 8
2024-12-30 09:28:48,101 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-30 09:28:48,534 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:28:48,539 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:28:48,543 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:28:48,546 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:28:48,550 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 8,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:28:49,555 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 9
2024-12-30 09:28:49,559 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-30 09:28:49,966 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:28:49,972 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:28:49,976 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:28:49,979 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:28:49,983 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 9,
      "duration": "0.01s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:28:50,990 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 10
2024-12-30 09:28:50,996 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-30 09:28:51,440 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 1 items to process for DealProductsProcessor
2024-12-30 09:28:51,444 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:28:51,449 - [INFO] - circuit_breaker.py:CircuitBreaker._log_event:219 - {"timestamp": "2024-12-30T09:28:51.446173", "circuit": "BitrixMigration_CB", "state": "OPEN", "event": "state_change", "metrics": {"total_failures": 5, "consecutive_successes": 0, "total_requests": 0, "success_rate": 0.0, "last_success_time": "2024-12-30T09:28:51.441021", "average_response_time": 0.0, "retry_attempts": 0, "error_distribution": {}}, "new_state": "OPEN", "reason": "failure_threshold_reached"}
2024-12-30 09:28:51,453 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: too many values to unpack (expected 2)
2024-12-30 09:28:51,457 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - {record['source_id']_record['target_id']}
2024-12-30 09:28:51,461 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 10,
      "duration": "0.02s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 1,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:28:52,466 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 11
2024-12-30 09:28:52,470 - [ERROR] - base_processor.py:DealProductsProcessor.background:338 - Background processing error in DealProductsProcessor: Circuit BitrixMigration_CB is OPEN. Next retry in 59.0s
2024-12-30 09:28:52,475 - [ERROR] - bitrix_migration.py:BitrixMigration.run:410 - Migration failed: Circuit BitrixMigration_CB is OPEN. Next retry in 59.0s
2024-12-30 09:28:52,478 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:30:04,710 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:30:04,714 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:30:04,735 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:30:04,738 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:30:09,719 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:30:09,834 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:30:11,356 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:30:11,363 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:30:11,367 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:30:11,370 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:30:11,374 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:30:14,206 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:30:14,209 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:30:14,213 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:30:14,216 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:30:14,219 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:30:14,221 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:30:33,829 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:30:33,832 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:30:33,855 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:30:33,858 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:30:59,014 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:30:59,153 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:31:00,651 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:31:00,660 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:31:00,664 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:31:00,667 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:31:00,671 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:31:04,694 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:31:04,697 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:31:04,700 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:31:04,704 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:31:04,706 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:31:04,709 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:31:19,642 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:31:19,650 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:31:19,654 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:31:19,666 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:31:19,669 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:31:19,674 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:31:19,678 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:31:19,681 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:31:19,684 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:31:19,688 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 11, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 28, 52, 470946, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}']}}
2024-12-30 09:31:19,692 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 11
2024-12-30 09:31:19,695 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 11 - offset: 500
2024-12-30 09:31:19,702 - [WARNING] - base_processor.py:DealProductsProcessor._get_and_validate_items:556 - No valid items found for DealProductsProcessor
2024-12-30 09:31:19,716 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 0,
  "failed_count": 0,
  "success_rate": 0.0,
  "processing_time": "1 day, 19:44:24.546297",
  "average_speed": 0.0,
  "remaining_items": 500,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:31:19,723 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 09:31:19,726 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 09:31:19,731 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 09:31:19,734 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 09:31:19,737 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 09:31:19,740 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 09:31:19,746 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 09:31:19,748 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 09:31:19,752 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 09:31:19,755 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:00.102012
2024-12-30 09:31:19,758 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:32:49,892 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:32:49,897 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:32:49,900 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:32:49,905 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:32:49,908 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:32:49,910 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:32:49,912 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:32:49,914 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:32:49,916 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:32:49,920 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 11, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 31, 19, 717409, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}']}}
2024-12-30 09:32:49,924 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 11
2024-12-30 09:32:49,928 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 11 - offset: 500
2024-12-30 09:32:49,931 - [WARNING] - base_processor.py:DealProductsProcessor._get_and_validate_items:556 - No valid items found for DealProductsProcessor
2024-12-30 09:32:49,935 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 0,
  "failed_count": 0,
  "success_rate": 0.0,
  "processing_time": "1 day, 19:46:51.792760",
  "average_speed": 0.0,
  "remaining_items": 500,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:32:49,941 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 09:32:49,943 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 09:32:49,947 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 09:32:49,950 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 09:32:49,952 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 09:32:49,954 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 09:32:49,959 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 09:32:49,961 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 09:32:49,964 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 09:32:49,966 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:00.066292
2024-12-30 09:32:49,968 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:34:02,624 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:34:02,627 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:34:02,629 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:34:02,640 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:34:02,642 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:34:02,646 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:34:02,649 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:34:02,653 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:34:02,655 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:34:02,660 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 32, 49, 936456, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}']}}
2024-12-30 09:34:02,669 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 09:34:02,673 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 09:34:02,680 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:34:02,685 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 09:34:02,688 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:34:03,336 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:03,344 - [WARNING] - deal_products_processor.py:DealProductsProcessor._filter_items_after_id:25 - Invalid last_processed_id: {record['source_id']_record['target_id']}
2024-12-30 09:34:03,347 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:03,355 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:34:03,359 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-30 09:34:03,363 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:34:06,206 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:06,478 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:06,482 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 50,
   "estimated_time": "2h 3m 21s",
   "current_page": {
      "page": 1,
      "duration": "3.14s",
      "items_per_second": "15.95",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:07,488 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 2
2024-12-30 09:34:07,491 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-30 09:34:08,081 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:08,084 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:09,785 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:10,036 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:10,044 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 100,
   "estimated_time": "2h 53m 47s",
   "current_page": {
      "page": 2,
      "duration": "1.96s",
      "items_per_second": "25.57",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:11,055 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 3
2024-12-30 09:34:11,058 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 3 - offset: 100
2024-12-30 09:34:11,669 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:11,672 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:13,054 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:13,267 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:13,270 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 150,
   "estimated_time": "3h 5m 26s",
   "current_page": {
      "page": 3,
      "duration": "1.60s",
      "items_per_second": "31.29",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:14,275 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 4
2024-12-30 09:34:14,277 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 4 - offset: 150
2024-12-30 09:34:14,861 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:14,864 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:17,715 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:17,912 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:17,916 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 200,
   "estimated_time": "1h 24m 26s",
   "current_page": {
      "page": 4,
      "duration": "3.05s",
      "items_per_second": "16.39",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:18,921 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 5
2024-12-30 09:34:18,924 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 5 - offset: 200
2024-12-30 09:34:19,547 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:19,553 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:21,670 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:21,888 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:21,892 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 250,
   "estimated_time": "1h 31m 4s",
   "current_page": {
      "page": 5,
      "duration": "2.34s",
      "items_per_second": "21.36",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:22,898 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 6
2024-12-30 09:34:22,902 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 6 - offset: 250
2024-12-30 09:34:23,468 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:23,471 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:26,271 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:26,512 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:26,517 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 300,
   "estimated_time": "56m 24s",
   "current_page": {
      "page": 6,
      "duration": "3.04s",
      "items_per_second": "16.42",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:27,523 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 7
2024-12-30 09:34:27,526 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 7 - offset: 300
2024-12-30 09:34:28,070 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:28,073 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:31,064 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:31,261 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:31,265 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 350,
   "estimated_time": "40m 24s",
   "current_page": {
      "page": 7,
      "duration": "3.19s",
      "items_per_second": "15.66",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:32,269 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 8
2024-12-30 09:34:32,272 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 8 - offset: 350
2024-12-30 09:34:32,894 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:32,896 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:35,773 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:36,005 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:36,009 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 400,
   "estimated_time": "27m 36s",
   "current_page": {
      "page": 8,
      "duration": "3.11s",
      "items_per_second": "16.06",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:37,014 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 9
2024-12-30 09:34:37,018 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 9 - offset: 400
2024-12-30 09:34:37,603 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:37,606 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:39,394 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:39,628 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:39,631 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 450,
   "estimated_time": "20m 59s",
   "current_page": {
      "page": 9,
      "duration": "2.03s",
      "items_per_second": "24.69",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:40,636 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 10
2024-12-30 09:34:40,638 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 10 - offset: 450
2024-12-30 09:34:41,223 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:34:41,225 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:34:43,350 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:34:43,570 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:34:43,574 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 500,
   "estimated_time": "0s",
   "current_page": {
      "page": 10,
      "duration": "2.35s",
      "items_per_second": "21.30",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:34:43,577 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 09:34:43,583 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 19:50:15.641658",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:34:43,588 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 09:34:43,590 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 09:34:43,595 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 09:34:43,598 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 09:34:43,600 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 09:34:43,603 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 09:34:43,607 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 09:34:43,609 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 09:34:43,611 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 09:34:43,613 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:40.984276
2024-12-30 09:34:43,616 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:45:59,612 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:45:59,616 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:45:59,619 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:492 - Failed to check Bitrix connection: Session is closed
2024-12-30 09:45:59,623 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:492 - Failed to check Bitrix connection: Session is closed
2024-12-30 09:45:59,626 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:45:59,738 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:45:59,741 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:45:59,744 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:45:59,747 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:45:59,749 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:45:59,752 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:45:59,757 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 34, 43, 584613, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}']}}
2024-12-30 09:45:59,762 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 09:45:59,765 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 09:46:00,378 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:46:00,385 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:46:03,390 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:46:03,679 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:46:03,683 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 550,
   "estimated_time": "46m 58s",
   "current_page": {
      "page": 1,
      "duration": "3.30s",
      "items_per_second": "15.16",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:46:03,686 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 09:46:03,702 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:01:35.750139",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:46:03,716 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 09:46:03,719 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 09:46:03,730 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 09:46:03,733 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 09:46:03,736 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 09:46:03,744 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 09:46:03,753 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 09:46:03,763 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 09:46:03,772 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 09:46:03,775 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:04.156082
2024-12-30 09:46:03,779 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:46:42,241 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 09:46:42,244 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 09:46:42,252 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 09:46:42,255 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 09:46:47,788 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 09:46:47,893 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 09:46:49,420 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 09:46:49,429 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 09:46:49,433 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 09:46:49,436 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 09:46:49,440 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 09:46:52,158 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 09:46:52,161 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 09:46:52,165 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 09:46:52,168 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 09:46:52,170 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 09:46:52,175 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 09:46:58,937 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 09:46:58,943 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 09:46:58,948 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 09:46:58,959 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 09:46:58,963 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 09:46:58,966 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 09:46:58,969 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 09:46:58,973 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 09:46:58,976 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 09:46:58,981 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 46, 3, 703495, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}']}}
2024-12-30 09:46:58,986 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 09:46:58,990 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 09:46:58,999 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:46:59,008 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768cf341be724.65319874
2024-12-30 09:47:00,031 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:47:00,605 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 09:47:00,610 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 09:47:00,616 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 09:47:00,621 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-30 09:47:00,624 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 09:47:03,073 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 09:47:03,302 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 09:47:03,313 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 600,
   "estimated_time": "28m 15s",
   "current_page": {
      "page": 1,
      "duration": "2.70s",
      "items_per_second": "18.55",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 09:47:03,325 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 09:47:03,342 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:02:35.373330",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 09:47:03,354 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 09:47:03,366 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 09:47:03,375 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 09:47:03,378 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 09:47:03,389 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 09:47:03,394 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 09:47:03,409 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 09:47:03,419 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 09:47:03,422 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 09:47:03,425 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:04.478421
2024-12-30 09:47:03,436 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:00:29,390 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 10:00:29,393 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:00:29,397 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 10:00:29,400 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 10:00:34,877 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 10:00:34,994 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 10:00:36,532 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 10:00:36,542 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 10:00:36,546 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 10:00:36,549 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 10:00:36,559 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 10:00:39,253 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 10:00:39,255 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 10:00:39,259 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 10:00:39,262 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 10:00:39,264 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 10:00:39,267 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 10:00:57,353 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 10:00:57,358 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 10:00:57,364 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 10:00:57,372 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 10:00:57,374 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 10:00:57,378 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 10:00:57,380 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 10:00:57,382 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 10:00:57,385 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 10:00:57,388 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 47, 3, 342907, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}', '{"total_duration": 4.36543, "avg_speed": 137.44350499263533, "error_rate": 0.44166666666666665, "total_pages": 1, "total_items": 600, "failed_items": 265, "start_time": "2024-12-30T09:46:58.977121", "end_time": "2024-12-30T09:47:03.342551"}']}}
2024-12-30 10:00:57,396 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 10:00:57,399 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 10:00:57,406 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:00:57,414 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 10:00:57,418 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:00:58,719 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:00:58,725 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:00:58,734 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:00:58,737 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:115 - Attempting token refresh for local.6768d0d0b1c402.69255221
2024-12-30 10:00:59,741 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:01:03,973 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 10:01:04,298 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 10:01:04,301 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 650,
   "estimated_time": "36m 21s",
   "current_page": {
      "page": 1,
      "duration": "5.58s",
      "items_per_second": "8.97",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 10:01:04,303 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 10:01:04,308 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:16:36.368427",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 10:01:04,314 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 10:01:04,317 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 10:01:04,320 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 10:01:04,323 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 10:01:04,327 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 10:01:04,329 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 10:01:04,333 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 10:01:04,335 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 10:01:04,337 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 10:01:04,340 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:06.978876
2024-12-30 10:01:04,342 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:06:18,084 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 10:06:18,087 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:06:18,092 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 10:06:18,095 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 10:06:23,403 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 10:06:23,517 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 10:06:25,048 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 10:06:25,055 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 10:06:25,059 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 10:06:25,062 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 10:06:25,066 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 10:06:28,104 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 10:06:28,107 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 10:06:28,110 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 10:06:28,114 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 10:06:28,116 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 10:06:28,119 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 10:10:41,746 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 10:10:41,753 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 10:10:41,758 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 10:10:41,768 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 10:10:41,771 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 10:10:41,776 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 10:10:41,783 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 10:10:41,787 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 10:10:41,792 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 10:10:41,799 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 3, 1, 4, 309340, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}', '{"total_duration": 4.36543, "avg_speed": 137.44350499263533, "error_rate": 0.44166666666666665, "total_pages": 1, "total_items": 600, "failed_items": 265, "start_time": "2024-12-30T09:46:58.977121", "end_time": "2024-12-30T09:47:03.342551"}', '{"total_duration": 6.923577, "avg_speed": 93.88210747132588, "error_rate": 0.4076923076923077, "total_pages": 1, "total_items": 650, "failed_items": 265, "start_time": "2024-12-30T10:00:57.385491", "end_time": "2024-12-30T10:01:04.309068"}']}}
2024-12-30 10:10:41,805 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 10:10:41,808 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 10:10:41,816 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:10:41,830 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 10:10:41,834 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:10:42,398 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:10:42,403 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:10:42,411 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:10:42,415 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-30 10:10:42,418 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:10:44,962 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 10:10:45,156 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 10:10:45,160 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 700,
   "estimated_time": "57m 53s",
   "current_page": {
      "page": 1,
      "duration": "2.76s",
      "items_per_second": "18.14",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 10:10:45,163 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 10:10:45,170 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:26:17.227654",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 10:10:45,177 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 10:10:45,180 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 10:10:45,184 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 10:10:45,187 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 10:10:45,190 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 10:10:45,193 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 10:10:45,198 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 10:10:45,201 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 10:10:45,204 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 10:10:45,207 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:03.451102
2024-12-30 10:10:45,210 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:12:59,567 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 10:12:59,570 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:12:59,584 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 10:12:59,592 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 10:13:04,647 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 10:13:04,755 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 10:13:06,257 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 10:13:06,265 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 10:13:06,268 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 10:13:06,271 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 10:13:06,275 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 10:13:08,706 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 10:13:08,709 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 10:13:08,711 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 10:13:08,713 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 10:13:08,715 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 10:13:08,717 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 10:14:19,999 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 10:14:20,013 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 10:14:20,026 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 10:14:20,038 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 10:14:20,045 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 10:14:20,049 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 10:14:20,053 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 10:14:20,057 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 10:14:20,061 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 10:14:20,067 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 3, 10, 45, 171734, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}', '{"total_duration": 4.36543, "avg_speed": 137.44350499263533, "error_rate": 0.44166666666666665, "total_pages": 1, "total_items": 600, "failed_items": 265, "start_time": "2024-12-30T09:46:58.977121", "end_time": "2024-12-30T09:47:03.342551"}', '{"total_duration": 6.923577, "avg_speed": 93.88210747132588, "error_rate": 0.4076923076923077, "total_pages": 1, "total_items": 650, "failed_items": 265, "start_time": "2024-12-30T10:00:57.385491", "end_time": "2024-12-30T10:01:04.309068"}', '{"total_duration": 3.378337, "avg_speed": 207.20253781668316, "error_rate": 0.37857142857142856, "total_pages": 1, "total_items": 700, "failed_items": 265, "start_time": "2024-12-30T10:10:41.793088", "end_time": "2024-12-30T10:10:45.171425"}']}}
2024-12-30 10:14:20,075 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 10:14:20,078 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 10:14:20,086 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:14:20,092 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 10:14:20,095 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:14:20,629 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:14:20,634 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:14:20,659 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:14:20,666 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768d0d0b1c402.69255221
2024-12-30 10:14:20,668 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:14:23,370 - [DEBUG] - base_processor.py:DealProductsProcessor.background:247 - _process_batch_items: start update data
2024-12-30 10:14:23,613 - [DEBUG] - base_processor.py:DealProductsProcessor.background:274 - _process_batch_items: complete updated data
2024-12-30 10:14:23,616 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 750,
   "estimated_time": "48m 3s",
   "current_page": {
      "page": 1,
      "duration": "2.98s",
      "items_per_second": "16.77",
      "processed": 50,
      "failed": 0,
      "error_rate": "0.00%"
   }
}
2024-12-30 10:14:23,619 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 10:14:23,626 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:29:55.684648",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 10:14:23,632 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 10:14:23,635 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 10:14:23,638 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 10:14:23,641 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 10:14:23,643 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 10:14:23,645 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 10:14:23,649 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 10:14:23,653 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 10:14:23,656 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 10:14:23,658 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:03.643060
2024-12-30 10:14:23,661 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:21:09,296 - [INFO] - main.py:shutdown_event:109 - Starting cleanup process...
2024-12-30 10:21:09,299 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:21:09,303 - [INFO] - database.py:Database.close:128 - Database connection pool closed
2024-12-30 10:21:09,308 - [INFO] - main.py:shutdown_event:117 - Cleanup completed successfully
2024-12-30 10:21:14,612 - [INFO] - main.py:startup_event:81 - Initializing migration tool...
2024-12-30 10:21:14,727 - [INFO] - database.py:Database.create_database:36 - Database migration_mOA2NMN already exists
2024-12-30 10:21:16,285 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: mappings.sql
2024-12-30 10:21:16,291 - [INFO] - database.py:Database.create_tables:64 - Executed migration file: progress_trackers.sql
2024-12-30 10:21:16,294 - [INFO] - database.py:Database.create_tables:66 - All database migrations completed successfully
2024-12-30 10:21:16,296 - [INFO] - database.py:Database.initialize:118 - Database initialization completed successfully
2024-12-30 10:21:16,299 - [WARNING] - bitrix_migration.py:BitrixMigration.__init__:61 - Initializing Migration Tool in DEBUG MODE
2024-12-30 10:21:19,058 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:169 - Successfully initialized deal processor
2024-12-30 10:21:19,061 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized deal_product processor
2024-12-30 10:21:19,064 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized comment processor
2024-12-30 10:21:19,067 - [DEBUG] - bitrix_migration.py:BitrixMigration._init_processors:180 - Successfully initialized task processor
2024-12-30 10:21:19,069 - [INFO] - main.py:startup_event:98 - Running in DEBUG mode
2024-12-30 10:21:19,071 - [INFO] - main.py:startup_event:100 - Application startup completed successfully
2024-12-30 10:22:50,992 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 10:22:50,997 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 10:22:51,001 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 10:22:51,012 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 10:22:51,018 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 10:22:51,024 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 10:22:51,028 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 10:22:51,030 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 10:22:51,032 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 10:22:51,036 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 3, 14, 23, 627720, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}', '{"total_duration": 4.36543, "avg_speed": 137.44350499263533, "error_rate": 0.44166666666666665, "total_pages": 1, "total_items": 600, "failed_items": 265, "start_time": "2024-12-30T09:46:58.977121", "end_time": "2024-12-30T09:47:03.342551"}', '{"total_duration": 6.923577, "avg_speed": 93.88210747132588, "error_rate": 0.4076923076923077, "total_pages": 1, "total_items": 650, "failed_items": 265, "start_time": "2024-12-30T10:00:57.385491", "end_time": "2024-12-30T10:01:04.309068"}', '{"total_duration": 3.378337, "avg_speed": 207.20253781668316, "error_rate": 0.37857142857142856, "total_pages": 1, "total_items": 700, "failed_items": 265, "start_time": "2024-12-30T10:10:41.793088", "end_time": "2024-12-30T10:10:45.171425"}', '{"total_duration": 3.565286, "avg_speed": 210.3618054764751, "error_rate": 0.35333333333333333, "total_pages": 1, "total_items": 750, "failed_items": 265, "start_time": "2024-12-30T10:14:20.062080", "end_time": "2024-12-30T10:14:23.627366"}']}}
2024-12-30 10:22:51,046 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 10:22:51,049 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 10:22:51,061 - [ERROR] - bitrix_base.py:BitrixAPI.batch:345 - Missing auth credentials - attempting to get new auth
2024-12-30 10:22:51,066 - [DEBUG] - oauth.py:OAuth2Client.get_access_token:110 - Using existing valid token for local.6768cf341be724.65319874
2024-12-30 10:22:51,070 - [INFO] - bitrix_base.py:BitrixAPI.batch:352 - Successfully obtained new auth credentials
2024-12-30 10:22:51,628 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:22:51,635 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:22:51,637 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: invalid literal for int() with base 10: '6.0'
2024-12-30 10:22:51,641 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 10_28590
2024-12-30 10:22:51,644 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 18_28592
2024-12-30 10:22:51,646 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 20_28594
2024-12-30 10:22:51,648 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 22_28596
2024-12-30 10:22:51,652 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 24_28598
2024-12-30 10:22:51,655 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 26_28600
2024-12-30 10:22:51,659 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 28_28602
2024-12-30 10:22:51,662 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 30_28604
2024-12-30 10:22:51,665 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 32_28606
2024-12-30 10:22:51,668 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 34_28608
2024-12-30 10:22:51,670 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 36_28610
2024-12-30 10:22:51,672 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 40_28612
2024-12-30 10:22:51,674 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 44_28614
2024-12-30 10:22:51,676 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 46_28616
2024-12-30 10:22:51,678 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 48_28618
2024-12-30 10:22:51,680 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 52_28620
2024-12-30 10:22:51,682 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 54_28622
2024-12-30 10:22:51,684 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 58_28624
2024-12-30 10:22:51,686 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 66_28626
2024-12-30 10:22:51,688 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 68_28628
2024-12-30 10:22:51,690 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 70_28630
2024-12-30 10:22:51,693 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 72_28632
2024-12-30 10:22:51,695 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 74_28634
2024-12-30 10:22:51,697 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 76_28636
2024-12-30 10:22:51,699 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 80_28638
2024-12-30 10:22:51,701 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 82_28640
2024-12-30 10:22:51,703 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 84_28642
2024-12-30 10:22:51,705 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 86_28644
2024-12-30 10:22:51,707 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 88_28646
2024-12-30 10:22:51,709 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 90_28648
2024-12-30 10:22:51,710 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 94_28650
2024-12-30 10:22:51,712 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 96_28652
2024-12-30 10:22:51,714 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 98_28654
2024-12-30 10:22:51,716 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 100_28656
2024-12-30 10:22:51,719 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 102_28658
2024-12-30 10:22:51,721 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 104_28660
2024-12-30 10:22:51,723 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 106_28662
2024-12-30 10:22:51,725 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 112_28664
2024-12-30 10:22:51,727 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 114_28666
2024-12-30 10:22:51,729 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 118_28668
2024-12-30 10:22:51,731 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 120_28670
2024-12-30 10:22:51,733 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 122_28672
2024-12-30 10:22:51,735 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 126_28674
2024-12-30 10:22:51,737 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 128_28676
2024-12-30 10:22:51,739 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 130_28678
2024-12-30 10:22:51,741 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 132_28680
2024-12-30 10:22:51,743 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 134_28682
2024-12-30 10:22:51,745 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 136_28684
2024-12-30 10:22:51,747 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 138_28686
2024-12-30 10:22:51,749 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 140_28688
2024-12-30 10:22:51,752 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 750,
   "estimated_time": "57m 55s",
   "current_page": {
      "page": 1,
      "duration": "0.12s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-30 10:22:51,755 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 10:22:51,766 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:29:55.703071",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 10:22:51,772 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 10:22:51,774 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 10:22:51,778 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 10:22:51,780 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 10:22:51,782 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 10:22:51,784 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 10:22:51,789 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 10:22:51,792 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 10:22:51,795 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 10:22:51,797 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:00.797822
2024-12-30 10:22:51,800 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:24:16,525 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 10:24:16,528 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 10:24:16,530 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:492 - Failed to check Bitrix connection: Session is closed
2024-12-30 10:24:16,532 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 10:24:16,536 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 10:24:16,539 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 10:24:16,541 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 10:24:16,544 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 10:24:16,546 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 10:24:16,549 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 10:24:16,553 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 3, 22, 51, 766851, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}', '{"total_duration": 4.36543, "avg_speed": 137.44350499263533, "error_rate": 0.44166666666666665, "total_pages": 1, "total_items": 600, "failed_items": 265, "start_time": "2024-12-30T09:46:58.977121", "end_time": "2024-12-30T09:47:03.342551"}', '{"total_duration": 6.923577, "avg_speed": 93.88210747132588, "error_rate": 0.4076923076923077, "total_pages": 1, "total_items": 650, "failed_items": 265, "start_time": "2024-12-30T10:00:57.385491", "end_time": "2024-12-30T10:01:04.309068"}', '{"total_duration": 3.378337, "avg_speed": 207.20253781668316, "error_rate": 0.37857142857142856, "total_pages": 1, "total_items": 700, "failed_items": 265, "start_time": "2024-12-30T10:10:41.793088", "end_time": "2024-12-30T10:10:45.171425"}', '{"total_duration": 3.565286, "avg_speed": 210.3618054764751, "error_rate": 0.35333333333333333, "total_pages": 1, "total_items": 750, "failed_items": 265, "start_time": "2024-12-30T10:14:20.062080", "end_time": "2024-12-30T10:14:23.627366"}', '{"total_duration": 0.733739, "avg_speed": 1022.16183138691, "error_rate": 0.42, "total_pages": 1, "total_items": 750, "failed_items": 315, "start_time": "2024-12-30T10:22:51.032822", "end_time": "2024-12-30T10:22:51.766561"}']}}
2024-12-30 10:24:16,556 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 10:24:16,559 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 10:24:17,107 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:24:17,113 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:24:17,118 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: invalid literal for int() with base 10: '6.0'
2024-12-30 10:24:17,121 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 10_28590
2024-12-30 10:24:17,123 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 18_28592
2024-12-30 10:24:17,126 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 20_28594
2024-12-30 10:24:17,128 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 22_28596
2024-12-30 10:24:17,131 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 24_28598
2024-12-30 10:24:17,133 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 26_28600
2024-12-30 10:24:17,135 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 28_28602
2024-12-30 10:24:17,138 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 30_28604
2024-12-30 10:24:17,140 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 32_28606
2024-12-30 10:24:17,143 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 34_28608
2024-12-30 10:24:17,145 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 36_28610
2024-12-30 10:24:17,148 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 40_28612
2024-12-30 10:24:17,150 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 44_28614
2024-12-30 10:24:17,152 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 46_28616
2024-12-30 10:24:17,155 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 48_28618
2024-12-30 10:24:17,157 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 52_28620
2024-12-30 10:24:17,160 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 54_28622
2024-12-30 10:24:17,162 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 58_28624
2024-12-30 10:24:17,164 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 66_28626
2024-12-30 10:24:17,167 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 68_28628
2024-12-30 10:24:17,169 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 70_28630
2024-12-30 10:24:17,171 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 72_28632
2024-12-30 10:24:17,174 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 74_28634
2024-12-30 10:24:17,176 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 76_28636
2024-12-30 10:24:17,179 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 80_28638
2024-12-30 10:24:17,182 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 82_28640
2024-12-30 10:24:17,184 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 84_28642
2024-12-30 10:24:17,186 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 86_28644
2024-12-30 10:24:17,189 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 88_28646
2024-12-30 10:24:17,191 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 90_28648
2024-12-30 10:24:17,194 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 94_28650
2024-12-30 10:24:17,196 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 96_28652
2024-12-30 10:24:17,199 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 98_28654
2024-12-30 10:24:17,201 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 100_28656
2024-12-30 10:24:17,205 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 102_28658
2024-12-30 10:24:17,207 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 104_28660
2024-12-30 10:24:17,209 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 106_28662
2024-12-30 10:24:17,212 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 112_28664
2024-12-30 10:24:17,214 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 114_28666
2024-12-30 10:24:17,217 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 118_28668
2024-12-30 10:24:17,220 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 120_28670
2024-12-30 10:24:17,222 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 122_28672
2024-12-30 10:24:17,225 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 126_28674
2024-12-30 10:24:17,227 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 128_28676
2024-12-30 10:24:17,229 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 130_28678
2024-12-30 10:24:17,233 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 132_28680
2024-12-30 10:24:17,235 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 134_28682
2024-12-30 10:24:17,238 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 136_28684
2024-12-30 10:24:17,241 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 138_28686
2024-12-30 10:24:17,243 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 140_28688
2024-12-30 10:24:17,247 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 750,
   "estimated_time": "57m 55s",
   "current_page": {
      "page": 1,
      "duration": "0.14s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-30 10:24:17,250 - [DEBUG] - base_processor.py:DealProductsProcessor.background:327 - Debug mode: Reached sample size of 500. Stopping processing...
2024-12-30 10:24:17,259 - [DEBUG] - base_processor.py:DealProductsProcessor._display_processing_statistics:655 - Detailed processing statistics: {
  "total_items": 500,
  "processed_count": 500,
  "failed_count": 0,
  "success_rate": 100.0,
  "processing_time": "1 day, 20:38:23.842202",
  "average_speed": 0.0,
  "remaining_items": 0,
  "estimated_time": "0s",
  "status": "in_progress"
}
2024-12-30 10:24:17,265 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed deal_product migration
2024-12-30 10:24:17,267 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting comment migration...
2024-12-30 10:24:17,273 - [DEBUG] - base_processor.py:CommentProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'CommentProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 2, 18, 325166, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 55, 65035, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 59.684839, "avg_speed": 8.37733683088263, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:02:17.696437", "end_time": "2024-12-28T11:03:17.381276"}', '{"total_duration": 9.803764, "avg_speed": 56.10090165369138, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:28.568395", "end_time": "2024-12-28T11:14:38.372159"}', '{"total_duration": 9.05341, "avg_speed": 66.27337102815403, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:05.117922", "end_time": "2024-12-28T11:21:14.171332"}', '{"total_duration": 10.239453, "avg_speed": 63.47995347017073, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:02.263572", "end_time": "2024-12-28T11:29:12.503025"}', '{"total_duration": 8.886357, "avg_speed": 78.77243734412201, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:12.513914", "end_time": "2024-12-28T11:30:21.400271"}', '{"total_duration": 9.029169, "avg_speed": 83.06412251227107, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:27.623609", "end_time": "2024-12-28T11:47:36.652778"}', '{"total_duration": 8.993282, "avg_speed": 88.9552890702193, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:09.721311", "end_time": "2024-12-28T11:50:18.714593"}', '{"total_duration": 8.848033, "avg_speed": 96.06654948054558, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:52:51.819428", "end_time": "2024-12-28T11:53:00.667461"}', '{"total_duration": 9.284764, "avg_speed": 96.93299689685166, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:36.303540", "end_time": "2024-12-28T11:57:45.588304"}', '{"total_duration": 9.099954, "avg_speed": 104.39613211231617, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:25.149892", "end_time": "2024-12-28T12:01:34.249846"}', '{"total_duration": 9.761159, "avg_speed": 102.44685082990658, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:15.662011", "end_time": "2024-12-28T12:05:25.423170"}', '{"total_duration": 10.451503, "avg_speed": 100.46401938553717, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:36.813826", "end_time": "2024-12-28T12:13:47.265329"}', '{"total_duration": 12.924051, "avg_speed": 85.11263225439144, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:42.140629", "end_time": "2024-12-30T09:00:55.064680"}']}}
2024-12-30 10:24:17,276 - [INFO] - base_processor.py:CommentProcessor.background:171 - Background processor CommentProcessor already completed. Skipping processing.
2024-12-30 10:24:17,280 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed comment migration
2024-12-30 10:24:17,283 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting task migration...
2024-12-30 10:24:17,286 - [DEBUG] - base_processor.py:TaskProcessor.background:168 - background() -> should_process_next: {'run': False, 'data': {'processor_type': 'TaskProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 10, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 4, 3, 17, 814358, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 2, 0, 57, 592371, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 22.380508, "avg_speed": 22.340869117001276, "error_rate": 0.0, "total_pages": 10, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T11:03:17.389891", "end_time": "2024-12-28T11:03:39.770399"}', '{"total_duration": 2.112259, "avg_speed": 260.38473501592375, "error_rate": 0.0, "total_pages": 10, "total_items": 550, "failed_items": 0, "start_time": "2024-12-28T11:14:38.379141", "end_time": "2024-12-28T11:14:40.491400"}', '{"total_duration": 1.800758, "avg_speed": 333.19302204960354, "error_rate": 0.0, "total_pages": 10, "total_items": 600, "failed_items": 0, "start_time": "2024-12-28T11:21:14.181709", "end_time": "2024-12-28T11:21:15.982467"}', '{"total_duration": 2.280435, "avg_speed": 285.033337937718, "error_rate": 0.0, "total_pages": 10, "total_items": 650, "failed_items": 0, "start_time": "2024-12-28T11:29:12.513101", "end_time": "2024-12-28T11:29:14.793536"}', '{"total_duration": 2.365268, "avg_speed": 295.9495499030131, "error_rate": 0.0, "total_pages": 10, "total_items": 700, "failed_items": 0, "start_time": "2024-12-28T11:30:21.409437", "end_time": "2024-12-28T11:30:23.774705"}', '{"total_duration": 1.969471, "avg_speed": 380.81291879900743, "error_rate": 0.0, "total_pages": 10, "total_items": 750, "failed_items": 0, "start_time": "2024-12-28T11:47:36.664372", "end_time": "2024-12-28T11:47:38.633843"}', '{"total_duration": 2.323443, "avg_speed": 344.31660255921923, "error_rate": 0.0, "total_pages": 10, "total_items": 800, "failed_items": 0, "start_time": "2024-12-28T11:50:18.724545", "end_time": "2024-12-28T11:50:21.047988"}', '{"total_duration": 2.244453, "avg_speed": 378.7114276841618, "error_rate": 0.0, "total_pages": 10, "total_items": 850, "failed_items": 0, "start_time": "2024-12-28T11:53:00.676549", "end_time": "2024-12-28T11:53:02.921002"}', '{"total_duration": 1.922825, "avg_speed": 468.06131603240027, "error_rate": 0.0, "total_pages": 10, "total_items": 900, "failed_items": 0, "start_time": "2024-12-28T11:57:45.596167", "end_time": "2024-12-28T11:57:47.518992"}', '{"total_duration": 1.96812, "avg_speed": 482.6941446659756, "error_rate": 0.0, "total_pages": 10, "total_items": 950, "failed_items": 0, "start_time": "2024-12-28T12:01:34.261105", "end_time": "2024-12-28T12:01:36.229225"}', '{"total_duration": 1.903921, "avg_speed": 525.2318767427851, "error_rate": 0.0, "total_pages": 10, "total_items": 1000, "failed_items": 0, "start_time": "2024-12-28T12:05:25.433432", "end_time": "2024-12-28T12:05:27.337353"}', '{"total_duration": 2.423974, "avg_speed": 433.17296307633666, "error_rate": 0.0, "total_pages": 10, "total_items": 1050, "failed_items": 0, "start_time": "2024-12-28T12:13:47.272255", "end_time": "2024-12-28T12:13:49.696229"}', '{"total_duration": 2.518622, "avg_speed": 436.74676072868414, "error_rate": 0.0, "total_pages": 10, "total_items": 1100, "failed_items": 0, "start_time": "2024-12-30T09:00:55.073424", "end_time": "2024-12-30T09:00:57.592046"}']}}
2024-12-30 10:24:17,289 - [INFO] - base_processor.py:TaskProcessor.background:171 - Background processor TaskProcessor already completed. Skipping processing.
2024-12-30 10:24:17,290 - [INFO] - bitrix_migration.py:BitrixMigration.run:399 - Completed task migration
2024-12-30 10:24:17,293 - [WARNING] - bitrix_migration.py:BitrixMigration.run:405 - DEBUG MODE migration completed in 0:00:00.762654
2024-12-30 10:24:17,296 - [INFO] - bitrix_migration.py:BitrixMigration.cleanup:424 - Bitrix migration cleanup completed
2024-12-30 10:27:00,485 - [INFO] - bitrix.py:start_migration:101 - Migration started successfully
2024-12-30 10:27:00,489 - [WARNING] - bitrix_migration.py:BitrixMigration.run:365 - Starting migration in DEBUG MODE
2024-12-30 10:27:00,493 - [ERROR] - bitrix_base.py:BitrixAPI.check_connection:492 - Failed to check Bitrix connection: Session is closed
2024-12-30 10:27:00,496 - [INFO] - bitrix_migration.py:BitrixMigration.run:378 - Starting deal migration...
2024-12-30 10:27:00,501 - [DEBUG] - base_processor.py:DealProcessor.process:369 - should_process_next: {'run': False, 'data': {'processor_type': 'DealProcessor', 'total_items': 17895, 'batch_size': 50, 'current_page': 1, 'status': 'completed', 'start_time': datetime.datetime(2024, 12, 28, 3, 59, 54, 955583, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 28, 4, 0, 50, 327209, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 71.204657, "avg_speed": 7.022012619202702, "error_rate": 0.0, "total_pages": 1, "total_items": 500, "failed_items": 0, "start_time": "2024-12-28T10:59:39.121978", "end_time": "2024-12-28T11:00:50.326635"}']}}
2024-12-30 10:27:00,506 - [INFO] - base_processor.py:DealProcessor.process:372 - Processor DealProcessor already completed. Skipping processing.
2024-12-30 10:27:00,508 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:79 - Start process update field files
2024-12-30 10:27:00,512 - [INFO] - bitrix_api.py:BitrixAPI.update_field_files:108 - No unprocessed files found for processor: 2
2024-12-30 10:27:00,516 - [INFO] - bitrix_migration.py:BitrixMigration.run:389 - Completed deal migration
2024-12-30 10:27:00,519 - [INFO] - bitrix_migration.py:BitrixMigration.run:394 - Starting deal_product migration...
2024-12-30 10:27:00,524 - [DEBUG] - base_processor.py:DealProductsProcessor.background:168 - background() -> should_process_next: {'run': True, 'data': {'processor_type': 'DealProductsProcessor', 'total_items': 500, 'batch_size': 50, 'current_page': 1, 'status': 'in_progress', 'start_time': datetime.datetime(2024, 12, 28, 6, 44, 27, 924649, tzinfo=datetime.timezone.utc), 'last_updated': datetime.datetime(2024, 12, 30, 3, 24, 17, 260290, tzinfo=datetime.timezone.utc), 'metadata': ['{}', '{"total_duration": 8.657894, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-28T13:44:27.182872", "end_time": "2024-12-28T13:44:35.840766"}', '{"total_duration": 0.015523, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 250, "start_time": "2024-12-30T08:41:23.175117", "end_time": "2024-12-30T08:41:23.190640"}', '{"total_duration": 8.495218, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T08:48:45.895045", "end_time": "2024-12-30T08:48:54.390263"}', '{"total_duration": 0.027635, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 255, "start_time": "2024-12-30T09:00:42.103687", "end_time": "2024-12-30T09:00:42.131322"}', '{"total_duration": 9.507002, "avg_speed": 0.0, "error_rate": 0, "total_pages": 6, "total_items": 0, "failed_items": 260, "start_time": "2024-12-30T09:18:53.869046", "end_time": "2024-12-30T09:19:03.376048"}', '{"total_duration": 7.334336, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:28:45.136284", "end_time": "2024-12-30T09:28:52.470620"}', '{"total_duration": 0.031751, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:31:19.685235", "end_time": "2024-12-30T09:31:19.716986"}', '{"total_duration": 0.018824, "avg_speed": 0.0, "error_rate": 0, "total_pages": 11, "total_items": 0, "failed_items": 265, "start_time": "2024-12-30T09:32:49.917176", "end_time": "2024-12-30T09:32:49.936000"}', '{"total_duration": 40.928119, "avg_speed": 12.216539929430912, "error_rate": 0.53, "total_pages": 10, "total_items": 500, "failed_items": 265, "start_time": "2024-12-30T09:34:02.656123", "end_time": "2024-12-30T09:34:43.584242"}', '{"total_duration": 3.949432, "avg_speed": 139.2605316410056, "error_rate": 0.4818181818181818, "total_pages": 1, "total_items": 550, "failed_items": 265, "start_time": "2024-12-30T09:45:59.753394", "end_time": "2024-12-30T09:46:03.702826"}', '{"total_duration": 4.36543, "avg_speed": 137.44350499263533, "error_rate": 0.44166666666666665, "total_pages": 1, "total_items": 600, "failed_items": 265, "start_time": "2024-12-30T09:46:58.977121", "end_time": "2024-12-30T09:47:03.342551"}', '{"total_duration": 6.923577, "avg_speed": 93.88210747132588, "error_rate": 0.4076923076923077, "total_pages": 1, "total_items": 650, "failed_items": 265, "start_time": "2024-12-30T10:00:57.385491", "end_time": "2024-12-30T10:01:04.309068"}', '{"total_duration": 3.378337, "avg_speed": 207.20253781668316, "error_rate": 0.37857142857142856, "total_pages": 1, "total_items": 700, "failed_items": 265, "start_time": "2024-12-30T10:10:41.793088", "end_time": "2024-12-30T10:10:45.171425"}', '{"total_duration": 3.565286, "avg_speed": 210.3618054764751, "error_rate": 0.35333333333333333, "total_pages": 1, "total_items": 750, "failed_items": 265, "start_time": "2024-12-30T10:14:20.062080", "end_time": "2024-12-30T10:14:23.627366"}', '{"total_duration": 0.733739, "avg_speed": 1022.16183138691, "error_rate": 0.42, "total_pages": 1, "total_items": 750, "failed_items": 315, "start_time": "2024-12-30T10:22:51.032822", "end_time": "2024-12-30T10:22:51.766561"}', '{"total_duration": 0.709972, "avg_speed": 1056.3796882130562, "error_rate": 0.4866666666666667, "total_pages": 1, "total_items": 750, "failed_items": 365, "start_time": "2024-12-30T10:24:16.549788", "end_time": "2024-12-30T10:24:17.259760"}']}}
2024-12-30 10:27:00,528 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 1
2024-12-30 10:27:00,531 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 1 - offset: 0
2024-12-30 10:27:01,123 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:27:01,128 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:27:01,131 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: invalid literal for int() with base 10: '6.0'
2024-12-30 10:27:01,134 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 10_28590
2024-12-30 10:27:01,138 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 18_28592
2024-12-30 10:27:01,141 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 20_28594
2024-12-30 10:27:01,145 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 22_28596
2024-12-30 10:27:01,148 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 24_28598
2024-12-30 10:27:01,152 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 26_28600
2024-12-30 10:27:01,156 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 28_28602
2024-12-30 10:27:01,159 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 30_28604
2024-12-30 10:27:01,162 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 32_28606
2024-12-30 10:27:01,165 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 34_28608
2024-12-30 10:27:01,170 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 36_28610
2024-12-30 10:27:01,173 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 40_28612
2024-12-30 10:27:01,176 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 44_28614
2024-12-30 10:27:01,179 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 46_28616
2024-12-30 10:27:01,182 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 48_28618
2024-12-30 10:27:01,186 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 52_28620
2024-12-30 10:27:01,189 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 54_28622
2024-12-30 10:27:01,192 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 58_28624
2024-12-30 10:27:01,195 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 66_28626
2024-12-30 10:27:01,198 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 68_28628
2024-12-30 10:27:01,201 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 70_28630
2024-12-30 10:27:01,204 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 72_28632
2024-12-30 10:27:01,207 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 74_28634
2024-12-30 10:27:01,210 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 76_28636
2024-12-30 10:27:01,213 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 80_28638
2024-12-30 10:27:01,217 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 82_28640
2024-12-30 10:27:01,220 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 84_28642
2024-12-30 10:27:01,223 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 86_28644
2024-12-30 10:27:01,226 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 88_28646
2024-12-30 10:27:01,228 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 90_28648
2024-12-30 10:27:01,231 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 94_28650
2024-12-30 10:27:01,234 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 96_28652
2024-12-30 10:27:01,237 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 98_28654
2024-12-30 10:27:01,240 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 100_28656
2024-12-30 10:27:01,243 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 102_28658
2024-12-30 10:27:01,246 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 104_28660
2024-12-30 10:27:01,249 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 106_28662
2024-12-30 10:27:01,252 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 112_28664
2024-12-30 10:27:01,255 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 114_28666
2024-12-30 10:27:01,258 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 118_28668
2024-12-30 10:27:01,262 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 120_28670
2024-12-30 10:27:01,265 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 122_28672
2024-12-30 10:27:01,268 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 126_28674
2024-12-30 10:27:01,271 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 128_28676
2024-12-30 10:27:01,274 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 130_28678
2024-12-30 10:27:01,277 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 132_28680
2024-12-30 10:27:01,280 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 134_28682
2024-12-30 10:27:01,283 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 136_28684
2024-12-30 10:27:01,286 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 138_28686
2024-12-30 10:27:01,289 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 140_28688
2024-12-30 10:27:01,292 - [DEBUG] - base_processor.py:DealProductsProcessor.background:319 - Background processed batch for DealProductsProcessor: {
   "total_items": 500,
   "total_processed": 0,
   "estimated_time": "4m 10s",
   "current_page": {
      "page": 1,
      "duration": "0.16s",
      "items_per_second": "0.00",
      "processed": 0,
      "failed": 50,
      "error_rate": "0.00%"
   }
}
2024-12-30 10:27:02,301 - [DEBUG] - base_processor.py:DealProductsProcessor.background:193 - Processing for page: 2
2024-12-30 10:27:02,307 - [ERROR] - deal_products_processor.py:DealProductsProcessor.get_all:35 - Fetch 50 mapping items from page: 2 - offset: 50
2024-12-30 10:27:02,838 - [INFO] - base_processor.py:DealProductsProcessor._get_and_validate_items:559 - Found 50 items to process for DealProductsProcessor
2024-12-30 10:27:02,841 - [DEBUG] - deal_products_processor.py:DealProductsProcessor.process_items:91 - Process records using Bitrix batch API with batch import
2024-12-30 10:27:02,852 - [ERROR] - base_processor.py:DealProductsProcessor.background:287 - Batch processing error: invalid literal for int() with base 10: '10.0'
2024-12-30 10:27:02,855 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 142_28690
2024-12-30 10:27:02,857 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 144_28692
2024-12-30 10:27:02,864 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 146_28694
2024-12-30 10:27:02,866 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 148_28696
2024-12-30 10:27:02,872 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 150_28698
2024-12-30 10:27:02,879 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 152_28700
2024-12-30 10:27:02,882 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 154_28702
2024-12-30 10:27:02,885 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 160_28704
2024-12-30 10:27:02,891 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 162_28706
2024-12-30 10:27:02,900 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 164_28708
2024-12-30 10:27:02,902 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 166_28710
2024-12-30 10:27:02,907 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 168_28712
2024-12-30 10:27:02,913 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 170_28714
2024-12-30 10:27:02,915 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 172_28716
2024-12-30 10:27:02,919 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 174_28718
2024-12-30 10:27:02,932 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 178_28720
2024-12-30 10:27:02,934 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 180_28722
2024-12-30 10:27:02,936 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 182_28724
2024-12-30 10:27:02,939 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 184_28726
2024-12-30 10:27:02,943 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 186_28728
2024-12-30 10:27:02,949 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 188_28730
2024-12-30 10:27:02,957 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 190_28732
2024-12-30 10:27:02,964 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 192_28734
2024-12-30 10:27:02,971 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 194_28736
2024-12-30 10:27:02,975 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 196_28738
2024-12-30 10:27:02,978 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 198_28740
2024-12-30 10:27:02,984 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 202_28742
2024-12-30 10:27:02,992 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 204_28744
2024-12-30 10:27:02,997 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 206_28746
2024-12-30 10:27:03,006 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 208_28748
2024-12-30 10:27:03,009 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 210_28750
2024-12-30 10:27:03,021 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 212_28752
2024-12-30 10:27:03,027 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 214_28754
2024-12-30 10:27:03,034 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 216_28756
2024-12-30 10:27:03,042 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 218_28758
2024-12-30 10:27:03,049 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 222_28760
2024-12-30 10:27:03,060 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 224_28762
2024-12-30 10:27:03,063 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 226_28764
2024-12-30 10:27:03,070 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 228_28766
2024-12-30 10:27:03,073 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 230_28768
2024-12-30 10:27:03,087 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 232_28770
2024-12-30 10:27:03,090 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 234_28772
2024-12-30 10:27:03,094 - [ERROR] - base_processor.py:DealProductsProcessor.handle_failed_item:705 - Error handling failed item: 'str' object has no attribute 'get' - 236_28774
